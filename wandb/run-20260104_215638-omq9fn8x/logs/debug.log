2026-01-04 21:56:38,458 INFO    MainThread:542815 [wandb_setup.py:_flush():80] Current SDK version is 0.23.1
2026-01-04 21:56:38,458 INFO    MainThread:542815 [wandb_setup.py:_flush():80] Configure stats pid to 542815
2026-01-04 21:56:38,459 INFO    MainThread:542815 [wandb_setup.py:_flush():80] Loading settings from /home/wanghaoxuan/.config/wandb/settings
2026-01-04 21:56:38,459 INFO    MainThread:542815 [wandb_setup.py:_flush():80] Loading settings from /home/wanghaoxuan/DPO-NaviLLM/wandb/settings
2026-01-04 21:56:38,459 INFO    MainThread:542815 [wandb_setup.py:_flush():80] Loading settings from environment variables
2026-01-04 21:56:38,459 INFO    MainThread:542815 [wandb_init.py:setup_run_log_directory():714] Logging user logs to /home/wanghaoxuan/DPO-NaviLLM/wandb/run-20260104_215638-omq9fn8x/logs/debug.log
2026-01-04 21:56:38,459 INFO    MainThread:542815 [wandb_init.py:setup_run_log_directory():715] Logging internal logs to /home/wanghaoxuan/DPO-NaviLLM/wandb/run-20260104_215638-omq9fn8x/logs/debug-internal.log
2026-01-04 21:56:38,459 INFO    MainThread:542815 [wandb_init.py:init():841] calling init triggers
2026-01-04 21:56:38,459 INFO    MainThread:542815 [wandb_init.py:init():846] wandb.init called with sweep_config: {}
config: {'_wandb': {}}
2026-01-04 21:56:38,459 INFO    MainThread:542815 [wandb_init.py:init():889] starting backend
2026-01-04 21:56:38,699 INFO    MainThread:542815 [wandb_init.py:init():892] sending inform_init request
2026-01-04 21:56:38,734 INFO    MainThread:542815 [wandb_init.py:init():900] backend started and connected
2026-01-04 21:56:38,736 INFO    MainThread:542815 [wandb_init.py:init():970] updated telemetry
2026-01-04 21:56:38,756 INFO    MainThread:542815 [wandb_init.py:init():994] communicating run to backend with 90.0 second timeout
2026-01-04 21:56:39,332 INFO    MainThread:542815 [wandb_init.py:init():1041] starting run threads in backend
2026-01-04 21:56:39,392 INFO    MainThread:542815 [wandb_run.py:_console_start():2521] atexit reg
2026-01-04 21:56:39,392 INFO    MainThread:542815 [wandb_run.py:_redirect():2369] redirect: wrap_raw
2026-01-04 21:56:39,392 INFO    MainThread:542815 [wandb_run.py:_redirect():2438] Wrapping output streams.
2026-01-04 21:56:39,392 INFO    MainThread:542815 [wandb_run.py:_redirect():2461] Redirects installed.
2026-01-04 21:56:39,398 INFO    MainThread:542815 [wandb_init.py:init():1081] run started, returning control to user process
2026-01-04 21:56:39,399 INFO    MainThread:542815 [wandb_run.py:_config_callback():1396] config_cb None None {'data_dir': '/data/wanghaoxuan/data', 'cfg_file': 'configs/multi.yaml', 'pretrained_model_name_or_path': '/data/wanghaoxuan/data/models/Vicuna-7B', 'off_batch_task': False, 'debug': False, 'few_shot': None, 'tour3d_nav_head': False, 'seed': 0, 'num_epochs': 30, 'resume_from_checkpoint': '/data/wanghaoxuan/model_with_pretrain.pt', 'from_scratch': False, 'batch_size': 4, 'val_batch_size': 2, 'lr': 1e-05, 'feat_dropout': 0.4, 'num_warmup_steps': 0, 'num_steps_per_epoch': -1, 'gradient_accumulation_step': 2, 'precision': 'amp_bf16', 'workers': 0, 'gpu': 0, 'world_size': 1, 'local_rank': 0, 'dist_url': 'env://', 'dist_backend': 'nccl', 'horovod': False, 'no_set_device_rank': False, 'output_dir': 'build/eval', 'max_saved_checkpoints': 0, 'save_ckpt_per_epochs': 10, 'save_latest_states': False, 'save_pred_results': True, 'save_detail_results': False, 'mode': 'test', 'stage': 'multi', 'ignoreid': -100, 'enable_og': False, 'enable_summarize': False, 'enable_fgr2r': False, 'disable_nav': False, 'gen_loss_coef': 1.0, 'obj_loss_coef': 1.0, 'teacher_forcing_coef': 1.0, 'fuse_obj': False, 'use_lora': False, 'lora_rank': 8, 'lora_alpha': 16, 'lora_dropout': 0.05, 'lora_target': None, 'freeze_llama': False, 'tune_token_emb': False, 'no_loc_fts': False, 'multi_endpoints': 1, 'path_type': 'trusted_path', 'test_datasets': ['CVDN'], 'validation_split': 'test', 'do_sample': False, 'temperature': 1.0, 'max_datapoints': None, 'rank': 0, 'distributed': False, 'device': 'cuda:0', 'image_feat_size': 1024, 'obj_feat_size': 768, 'angle_feat_size': 4, 'enc_full_graph': True, 'expert_policy': 'spl', 'num_pano_layers': 2}
2026-01-04 21:56:39,401 INFO    MainThread:542815 [wandb_run.py:_config_callback():1396] config_cb None None {'Feature_object_feature_type': '', 'Feature_angle_feat_size': 4, 'Feature_max_objects': 70, 'Feature_image_feat_size': 1024, 'Feature_feature_database_mp3d': 'eva_features/mp3d_EVA02-CLIP-L-14-336.hdf5', 'Feature_feature_database_scan_qa': 'eva_features/scanqa_EVA02-CLIP-L-14-336.hdf5', 'Feature_feature_database_room_tour': 'eva_features/web_obj_prog_p1_EVA02-CLIP-L-14-336.hdf5.bak', 'Feature_feature_database_room3d_tour': 'eva_features/web_3d_obj_prog_crop_p1_EVA02-CLIP-L-14-336.hdf5', 'Feature_feature_database_coco': 'eva_features/coco_EVA02-CLIP-L-14-336.hdf5', 'Feature_obj_feat_size': 768, 'Feature_object_database_reverie': 'obj_features/reverie_obj_feat', 'Feature_object_database_soon': 'obj_features/soon_obj_feat', 'Dataset_R2R_DIR': 'R2R', 'Dataset_R2R_SPLIT_train': 'FGR2R_train.json', 'Dataset_R2R_SPLIT_val_seen': 'R2R_val_seen_enc.json', 'Dataset_R2R_SPLIT_val_unseen': 'R2R_val_unseen_enc.json', 'Dataset_R2R_SPLIT_test': 'R2R_test_enc.json', 'Dataset_REVERIE_DIR': 'REVERIE', 'Dataset_REVERIE_bbox_file': 'BBoxes.json', 'Dataset_REVERIE_SPLIT_train': 'REVERIE_train_enc.json', 'Dataset_REVERIE_SPLIT_val_seen': 'REVERIE_val_seen_enc.json', 'Dataset_REVERIE_SPLIT_val_unseen': 'REVERIE_val_unseen_enc.json', 'Dataset_REVERIE_SPLIT_test': 'REVERIE_test_enc.json', 'Dataset_CVDN_DIR': 'CVDN', 'Dataset_CVDN_SPLIT_train': 'train.json', 'Dataset_CVDN_SPLIT_val_seen': 'val_seen.json', 'Dataset_CVDN_SPLIT_val_unseen': 'val_unseen.json', 'Dataset_CVDN_SPLIT_test': 'test_cleaned.json', 'Dataset_SOON_DIR': 'SOON', 'Dataset_SOON_SPLIT_train': 'train_enc_pseudo_obj_ade30k_label.jsonl', 'Dataset_SOON_SPLIT_val_seen': 'val_unseen_instrs_enc_pseudo_obj_ade30k_label.jsonl', 'Dataset_SOON_SPLIT_val_unseen': 'val_unseen_house_enc_pseudo_obj_ade30k_label.jsonl', 'Dataset_SOON_SPLIT_test': 'test_v2_enc.jsonl', 'Dataset_ScanQA_DIR': 'ScanQA', 'Dataset_ScanQA_SPLIT_train': 'ScanQA_v1.0_train_reformat.json', 'Dataset_ScanQA_SPLIT_val_unseen': 'ScanQA_v1.0_val_reformat.json', 'Dataset_ScanQA_SPLIT_test_wo_obj': 'ScanQA_v1.0_test_wo_obj_reformat.json', 'Dataset_ScanQA_SPLIT_test_w_obj': 'ScanQA_v1.0_test_w_obj_reformat.json', 'Dataset_RoomTour_DIR': 'RoomTour', 'Dataset_RoomTour_SPLIT_train': 'p1_train_reformat.json', 'Dataset_Tour3D_DIR': 'RoomTour', 'Dataset_Tour3D_SPLIT_train': 'p1_train_colmap_trajectory_tour3d.json', 'Dataset_EQA_DIR': 'EQA_MP3D', 'Dataset_EQA_SPLIT_val_unseen': 'eqa_val_enc.json', 'Dataset_EQA_ANSWER_VOCAB': 'eqa_answer_vocab.json', 'Dataset_R2R_AUG_DIR': 'R2R', 'Dataset_R2R_AUG_SPLIT_train': 'R2R_prevalent_aug_train_enc.jsonl', 'Dataset_REVERIE_AUG_DIR': 'REVERIE', 'Dataset_REVERIE_AUG_bbox_file': 'BBoxes.json', 'Dataset_REVERIE_AUG_SPLIT_train': 'REVERIE_speaker_aug_enc.jsonl', 'Dataset_LLaVA_DIR': 'LLaVA', 'Dataset_LLaVA_SPLIT_train': 'detail_23k.json', 'Pretrain_SOURCE': ['Tour3D', 'RoomTour', 'ScanQA', 'LLaVA'], 'Pretrain_Ratio': [10, 20, 5, 2], 'Pretrain_LOSS_COEF_R2R_AUG': 1, 'Pretrain_LOSS_COEF_REVERIE_AUG': 1, 'Multi_SOURCE': ['Tour3D', 'R2R', 'REVERIE', 'CVDN', 'SOON', 'ScanQA', 'LLaVA'], 'Multi_Ratio': [10, 20, 5, 1, 5, 5, 5], 'Model_num_l_layers': 9, 'Model_num_pano_layers': 2, 'Model_num_x_layers': 4, 'Model_graph_sprels': True, 'Model_fusion': 'dynamic', 'Model_enc_full_graph': True, 'Model_expert_policy': 'spl', 'Optim_val_max_action_len_R2R': 15, 'Optim_val_max_action_len_REVERIE': 15, 'Optim_val_max_action_len_CVDN': 30, 'Optim_val_max_action_len_SOON': 20, 'Optim_val_max_action_len_EQA': 15, 'Optim_train_max_action_len_R2R': 15, 'Optim_train_max_action_len_Tour3D': 15, 'Optim_train_max_action_len_REVERIE': 15, 'Optim_train_max_action_len_CVDN': 15, 'Optim_train_max_action_len_SOON': 15, 'Optim_train_max_action_len_EQA': 15, 'Optim_train_max_action_len_R2R_AUG': 15, 'Optim_train_max_action_len_REVERIE_AUG': 15}
2026-01-04 21:56:39,408 INFO    wandb-AsyncioManager-main:542815 [service_client.py:_forward_responses():80] Reached EOF.
2026-01-04 21:56:39,409 INFO    wandb-AsyncioManager-main:542815 [mailbox.py:close():137] Closing mailbox, abandoning 1 handles.
