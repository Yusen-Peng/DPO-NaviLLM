2026-01-06 10:40:38,132   INFO  **********************Start logging**********************
2026-01-06 10:40:38,132   INFO  CUDA_VISIBLE_DEVICES=0
2026-01-06 10:40:38,132   INFO  data_dir         /data/wanghaoxuan/data
2026-01-06 10:40:38,132   INFO  cfg_file         configs/multi.yaml
2026-01-06 10:40:38,132   INFO  pretrained_model_name_or_path /data/wanghaoxuan/data/models/Vicuna-7B
2026-01-06 10:40:38,132   INFO  off_batch_task   False
2026-01-06 10:40:38,132   INFO  debug            False
2026-01-06 10:40:38,132   INFO  few_shot         None
2026-01-06 10:40:38,132   INFO  tour3d_nav_head  False
2026-01-06 10:40:38,132   INFO  seed             0
2026-01-06 10:40:38,132   INFO  num_epochs       30
2026-01-06 10:40:38,132   INFO  resume_from_checkpoint /data/wanghaoxuan/roomtour3d.pt
2026-01-06 10:40:38,132   INFO  from_scratch     False
2026-01-06 10:40:38,132   INFO  batch_size       4
2026-01-06 10:40:38,132   INFO  val_batch_size   2
2026-01-06 10:40:38,132   INFO  lr               1e-05
2026-01-06 10:40:38,133   INFO  feat_dropout     0.4
2026-01-06 10:40:38,133   INFO  num_warmup_steps 0
2026-01-06 10:40:38,133   INFO  num_steps_per_epoch -1
2026-01-06 10:40:38,133   INFO  gradient_accumulation_step 2
2026-01-06 10:40:38,133   INFO  precision        amp_bf16
2026-01-06 10:40:38,133   INFO  workers          0
2026-01-06 10:40:38,133   INFO  gpu              0
2026-01-06 10:40:38,133   INFO  world_size       1
2026-01-06 10:40:38,133   INFO  local_rank       0
2026-01-06 10:40:38,133   INFO  dist_url         env://
2026-01-06 10:40:38,133   INFO  dist_backend     nccl
2026-01-06 10:40:38,133   INFO  horovod          False
2026-01-06 10:40:38,133   INFO  no_set_device_rank False
2026-01-06 10:40:38,133   INFO  output_dir       build/eval
2026-01-06 10:40:38,133   INFO  max_saved_checkpoints 0
2026-01-06 10:40:38,133   INFO  save_ckpt_per_epochs 10
2026-01-06 10:40:38,133   INFO  save_latest_states False
2026-01-06 10:40:38,133   INFO  save_pred_results False
2026-01-06 10:40:38,133   INFO  save_detail_results False
2026-01-06 10:40:38,134   INFO  mode             test
2026-01-06 10:40:38,134   INFO  stage            multi
2026-01-06 10:40:38,134   INFO  ignoreid         -100
2026-01-06 10:40:38,134   INFO  enable_og        False
2026-01-06 10:40:38,134   INFO  enable_summarize False
2026-01-06 10:40:38,134   INFO  enable_fgr2r     False
2026-01-06 10:40:38,134   INFO  disable_nav      False
2026-01-06 10:40:38,134   INFO  gen_loss_coef    1.0
2026-01-06 10:40:38,134   INFO  obj_loss_coef    1.0
2026-01-06 10:40:38,134   INFO  teacher_forcing_coef 1.0
2026-01-06 10:40:38,134   INFO  fuse_obj         False
2026-01-06 10:40:38,134   INFO  use_lora         False
2026-01-06 10:40:38,134   INFO  lora_rank        8
2026-01-06 10:40:38,134   INFO  lora_alpha       16
2026-01-06 10:40:38,134   INFO  lora_dropout     0.05
2026-01-06 10:40:38,134   INFO  lora_target      None
2026-01-06 10:40:38,134   INFO  freeze_llama     False
2026-01-06 10:40:38,134   INFO  tune_token_emb   False
2026-01-06 10:40:38,134   INFO  no_loc_fts       False
2026-01-06 10:40:38,135   INFO  multi_endpoints  1
2026-01-06 10:40:38,135   INFO  path_type        trusted_path
2026-01-06 10:40:38,135   INFO  test_datasets    ['CVDN']
2026-01-06 10:40:38,135   INFO  validation_split val_unseen
2026-01-06 10:40:38,135   INFO  do_sample        False
2026-01-06 10:40:38,135   INFO  temperature      1.0
2026-01-06 10:40:38,135   INFO  max_datapoints   None
2026-01-06 10:40:38,135   INFO  rank             0
2026-01-06 10:40:38,135   INFO  distributed      False
2026-01-06 10:40:38,135   INFO  device           cuda:0
2026-01-06 10:40:38,135   INFO  image_feat_size  1024
2026-01-06 10:40:38,135   INFO  obj_feat_size    768
2026-01-06 10:40:38,135   INFO  angle_feat_size  4
2026-01-06 10:40:38,135   INFO  enc_full_graph   True
2026-01-06 10:40:38,135   INFO  expert_policy    spl
2026-01-06 10:40:38,135   INFO  num_pano_layers  2
2026-01-06 10:40:38,135   INFO  ----------- Feature -----------
2026-01-06 10:40:38,135   INFO  cfg.Feature.object_feature_type: 
2026-01-06 10:40:38,135   INFO  cfg.Feature.angle_feat_size: 4
2026-01-06 10:40:38,135   INFO  cfg.Feature.max_objects: 70
2026-01-06 10:40:38,136   INFO  cfg.Feature.image_feat_size: 1024
2026-01-06 10:40:38,136   INFO  ----------- feature_database -----------
2026-01-06 10:40:38,136   INFO  cfg.Feature.feature_database.mp3d: eva_features/mp3d_EVA02-CLIP-L-14-336.hdf5
2026-01-06 10:40:38,136   INFO  cfg.Feature.feature_database.scan_qa: eva_features/scanqa_EVA02-CLIP-L-14-336.hdf5
2026-01-06 10:40:38,136   INFO  cfg.Feature.feature_database.room_tour: eva_features/web_obj_prog_p1_EVA02-CLIP-L-14-336.hdf5.bak
2026-01-06 10:40:38,136   INFO  cfg.Feature.feature_database.room3d_tour: eva_features/web_3d_obj_prog_crop_p1_EVA02-CLIP-L-14-336.hdf5
2026-01-06 10:40:38,136   INFO  cfg.Feature.feature_database.coco: eva_features/coco_EVA02-CLIP-L-14-336.hdf5
2026-01-06 10:40:38,136   INFO  cfg.Feature.obj_feat_size: 768
2026-01-06 10:40:38,136   INFO  ----------- object_database -----------
2026-01-06 10:40:38,136   INFO  cfg.Feature.object_database.reverie: obj_features/reverie_obj_feat
2026-01-06 10:40:38,136   INFO  cfg.Feature.object_database.soon: obj_features/soon_obj_feat
2026-01-06 10:40:38,136   INFO  ----------- Dataset -----------
2026-01-06 10:40:38,136   INFO  ----------- R2R -----------
2026-01-06 10:40:38,136   INFO  cfg.Dataset.R2R.DIR: R2R
2026-01-06 10:40:38,136   INFO  ----------- SPLIT -----------
2026-01-06 10:40:38,136   INFO  cfg.Dataset.R2R.SPLIT.train: FGR2R_train.json
2026-01-06 10:40:38,136   INFO  cfg.Dataset.R2R.SPLIT.val_seen: R2R_val_seen_enc.json
2026-01-06 10:40:38,136   INFO  cfg.Dataset.R2R.SPLIT.val_unseen: R2R_val_unseen_enc.json
2026-01-06 10:40:38,136   INFO  cfg.Dataset.R2R.SPLIT.test: R2R_test_enc.json
2026-01-06 10:40:38,137   INFO  ----------- REVERIE -----------
2026-01-06 10:40:38,137   INFO  cfg.Dataset.REVERIE.DIR: REVERIE
2026-01-06 10:40:38,137   INFO  cfg.Dataset.REVERIE.bbox_file: BBoxes.json
2026-01-06 10:40:38,137   INFO  ----------- SPLIT -----------
2026-01-06 10:40:38,137   INFO  cfg.Dataset.REVERIE.SPLIT.train: REVERIE_train_enc.json
2026-01-06 10:40:38,137   INFO  cfg.Dataset.REVERIE.SPLIT.val_seen: REVERIE_val_seen_enc.json
2026-01-06 10:40:38,137   INFO  cfg.Dataset.REVERIE.SPLIT.val_unseen: REVERIE_val_unseen_enc.json
2026-01-06 10:40:38,137   INFO  cfg.Dataset.REVERIE.SPLIT.test: REVERIE_test_enc.json
2026-01-06 10:40:38,137   INFO  ----------- CVDN -----------
2026-01-06 10:40:38,137   INFO  cfg.Dataset.CVDN.DIR: CVDN
2026-01-06 10:40:38,137   INFO  ----------- SPLIT -----------
2026-01-06 10:40:38,137   INFO  cfg.Dataset.CVDN.SPLIT.train: train.json
2026-01-06 10:40:38,137   INFO  cfg.Dataset.CVDN.SPLIT.val_seen: val_seen.json
2026-01-06 10:40:38,137   INFO  cfg.Dataset.CVDN.SPLIT.val_unseen: val_unseen.json
2026-01-06 10:40:38,137   INFO  cfg.Dataset.CVDN.SPLIT.test: test_cleaned.json
2026-01-06 10:40:38,137   INFO  ----------- SOON -----------
2026-01-06 10:40:38,137   INFO  cfg.Dataset.SOON.DIR: SOON
2026-01-06 10:40:38,137   INFO  ----------- SPLIT -----------
2026-01-06 10:40:38,137   INFO  cfg.Dataset.SOON.SPLIT.train: train_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 10:40:38,138   INFO  cfg.Dataset.SOON.SPLIT.val_seen: val_unseen_instrs_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 10:40:38,138   INFO  cfg.Dataset.SOON.SPLIT.val_unseen: val_unseen_house_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 10:40:38,138   INFO  cfg.Dataset.SOON.SPLIT.test: test_v2_enc.jsonl
2026-01-06 10:40:38,138   INFO  ----------- ScanQA -----------
2026-01-06 10:40:38,138   INFO  cfg.Dataset.ScanQA.DIR: ScanQA
2026-01-06 10:40:38,138   INFO  ----------- SPLIT -----------
2026-01-06 10:40:38,138   INFO  cfg.Dataset.ScanQA.SPLIT.train: ScanQA_v1.0_train_reformat.json
2026-01-06 10:40:38,138   INFO  cfg.Dataset.ScanQA.SPLIT.val_unseen: ScanQA_v1.0_val_reformat.json
2026-01-06 10:40:38,138   INFO  cfg.Dataset.ScanQA.SPLIT.test_wo_obj: ScanQA_v1.0_test_wo_obj_reformat.json
2026-01-06 10:40:38,138   INFO  cfg.Dataset.ScanQA.SPLIT.test_w_obj: ScanQA_v1.0_test_w_obj_reformat.json
2026-01-06 10:40:38,138   INFO  ----------- RoomTour -----------
2026-01-06 10:40:38,138   INFO  cfg.Dataset.RoomTour.DIR: RoomTour
2026-01-06 10:40:38,138   INFO  ----------- SPLIT -----------
2026-01-06 10:40:38,138   INFO  cfg.Dataset.RoomTour.SPLIT.train: p1_train_reformat.json
2026-01-06 10:40:38,138   INFO  ----------- Tour3D -----------
2026-01-06 10:40:38,138   INFO  cfg.Dataset.Tour3D.DIR: RoomTour
2026-01-06 10:40:38,138   INFO  ----------- SPLIT -----------
2026-01-06 10:40:38,138   INFO  cfg.Dataset.Tour3D.SPLIT.train: p1_train_colmap_trajectory_tour3d.json
2026-01-06 10:40:38,138   INFO  ----------- EQA -----------
2026-01-06 10:40:38,139   INFO  cfg.Dataset.EQA.DIR: EQA_MP3D
2026-01-06 10:40:38,139   INFO  ----------- SPLIT -----------
2026-01-06 10:40:38,139   INFO  cfg.Dataset.EQA.SPLIT.val_unseen: eqa_val_enc.json
2026-01-06 10:40:38,139   INFO  cfg.Dataset.EQA.ANSWER_VOCAB: eqa_answer_vocab.json
2026-01-06 10:40:38,139   INFO  ----------- R2R_AUG -----------
2026-01-06 10:40:38,139   INFO  cfg.Dataset.R2R_AUG.DIR: R2R
2026-01-06 10:40:38,139   INFO  ----------- SPLIT -----------
2026-01-06 10:40:38,139   INFO  cfg.Dataset.R2R_AUG.SPLIT.train: R2R_prevalent_aug_train_enc.jsonl
2026-01-06 10:40:38,139   INFO  ----------- REVERIE_AUG -----------
2026-01-06 10:40:38,139   INFO  cfg.Dataset.REVERIE_AUG.DIR: REVERIE
2026-01-06 10:40:38,139   INFO  cfg.Dataset.REVERIE_AUG.bbox_file: BBoxes.json
2026-01-06 10:40:38,139   INFO  ----------- SPLIT -----------
2026-01-06 10:40:38,139   INFO  cfg.Dataset.REVERIE_AUG.SPLIT.train: REVERIE_speaker_aug_enc.jsonl
2026-01-06 10:40:38,139   INFO  ----------- LLaVA -----------
2026-01-06 10:40:38,139   INFO  cfg.Dataset.LLaVA.DIR: LLaVA
2026-01-06 10:40:38,139   INFO  ----------- SPLIT -----------
2026-01-06 10:40:38,139   INFO  cfg.Dataset.LLaVA.SPLIT.train: detail_23k.json
2026-01-06 10:40:38,139   INFO  ----------- Pretrain -----------
2026-01-06 10:40:38,139   INFO  cfg.Pretrain.SOURCE: ['Tour3D', 'RoomTour', 'ScanQA', 'LLaVA']
2026-01-06 10:40:38,140   INFO  cfg.Pretrain.Ratio: [10, 20, 5, 2]
2026-01-06 10:40:38,140   INFO  ----------- LOSS_COEF -----------
2026-01-06 10:40:38,140   INFO  cfg.Pretrain.LOSS_COEF.R2R_AUG: 1
2026-01-06 10:40:38,140   INFO  cfg.Pretrain.LOSS_COEF.REVERIE_AUG: 1
2026-01-06 10:40:38,140   INFO  ----------- Multi -----------
2026-01-06 10:40:38,140   INFO  cfg.Multi.SOURCE: ['Tour3D', 'R2R', 'REVERIE', 'CVDN', 'SOON', 'ScanQA', 'LLaVA']
2026-01-06 10:40:38,140   INFO  cfg.Multi.Ratio: [10, 20, 5, 1, 5, 5, 5]
2026-01-06 10:40:38,140   INFO  ----------- LOSS_COEF -----------
2026-01-06 10:40:38,140   INFO  ----------- Model -----------
2026-01-06 10:40:38,140   INFO  cfg.Model.num_l_layers: 9
2026-01-06 10:40:38,140   INFO  cfg.Model.num_pano_layers: 2
2026-01-06 10:40:38,140   INFO  cfg.Model.num_x_layers: 4
2026-01-06 10:40:38,140   INFO  cfg.Model.graph_sprels: True
2026-01-06 10:40:38,140   INFO  cfg.Model.fusion: dynamic
2026-01-06 10:40:38,140   INFO  cfg.Model.enc_full_graph: True
2026-01-06 10:40:38,140   INFO  cfg.Model.expert_policy: spl
2026-01-06 10:40:38,140   INFO  ----------- Optim -----------
2026-01-06 10:40:38,140   INFO  ----------- val_max_action_len -----------
2026-01-06 10:40:38,140   INFO  cfg.Optim.val_max_action_len.R2R: 15
2026-01-06 10:40:38,141   INFO  cfg.Optim.val_max_action_len.REVERIE: 15
2026-01-06 10:40:38,141   INFO  cfg.Optim.val_max_action_len.CVDN: 30
2026-01-06 10:40:38,141   INFO  cfg.Optim.val_max_action_len.SOON: 20
2026-01-06 10:40:38,141   INFO  cfg.Optim.val_max_action_len.EQA: 15
2026-01-06 10:40:38,141   INFO  ----------- train_max_action_len -----------
2026-01-06 10:40:38,141   INFO  cfg.Optim.train_max_action_len.R2R: 15
2026-01-06 10:40:38,141   INFO  cfg.Optim.train_max_action_len.Tour3D: 15
2026-01-06 10:40:38,141   INFO  cfg.Optim.train_max_action_len.REVERIE: 15
2026-01-06 10:40:38,141   INFO  cfg.Optim.train_max_action_len.CVDN: 15
2026-01-06 10:40:38,141   INFO  cfg.Optim.train_max_action_len.SOON: 15
2026-01-06 10:40:38,141   INFO  cfg.Optim.train_max_action_len.EQA: 15
2026-01-06 10:40:38,141   INFO  cfg.Optim.train_max_action_len.R2R_AUG: 15
2026-01-06 10:40:38,141   INFO  cfg.Optim.train_max_action_len.REVERIE_AUG: 15
2026-01-06 10:40:40,494   INFO  [INFO] CVDNDataset loaded with 907 instructions, using splits: val_unseen
2026-01-06 10:40:40,495   INFO  
- Dataset: load 907 CVDN samples
- Dataset: load val_unseen split: 907 samples in total
- Dataset: load val_unseen split: 10 scans in total
2026-01-06 10:40:40,498   INFO  CVDN: 907 samples loaded
2026-01-06 10:40:40,559   INFO  Initialize the model from config.
2026-01-06 10:42:10,004   INFO  model type: torch.bfloat16
2026-01-06 10:42:10,012   INFO  Trainable params: lang_model.model.embed_tokens.weight,lang_model.model.layers.0.self_attn.q_proj.weight,lang_model.model.layers.0.self_attn.k_proj.weight,lang_model.model.layers.0.self_attn.v_proj.weight,lang_model.model.layers.0.self_attn.o_proj.weight,lang_model.model.layers.0.mlp.gate_proj.weight,lang_model.model.layers.0.mlp.down_proj.weight,lang_model.model.layers.0.mlp.up_proj.weight,lang_model.model.layers.0.input_layernorm.weight,lang_model.model.layers.0.post_attention_layernorm.weight,lang_model.model.layers.1.self_attn.q_proj.weight,lang_model.model.layers.1.self_attn.k_proj.weight,lang_model.model.layers.1.self_attn.v_proj.weight,lang_model.model.layers.1.self_attn.o_proj.weight,lang_model.model.layers.1.mlp.gate_proj.weight,lang_model.model.layers.1.mlp.down_proj.weight,lang_model.model.layers.1.mlp.up_proj.weight,lang_model.model.layers.1.input_layernorm.weight,lang_model.model.layers.1.post_attention_layernorm.weight,lang_model.model.layers.2.self_attn.q_proj.weight,lang_model.model.layers.2.self_attn.k_proj.weight,lang_model.model.layers.2.self_attn.v_proj.weight,lang_model.model.layers.2.self_attn.o_proj.weight,lang_model.model.layers.2.mlp.gate_proj.weight,lang_model.model.layers.2.mlp.down_proj.weight,lang_model.model.layers.2.mlp.up_proj.weight,lang_model.model.layers.2.input_layernorm.weight,lang_model.model.layers.2.post_attention_layernorm.weight,lang_model.model.layers.3.self_attn.q_proj.weight,lang_model.model.layers.3.self_attn.k_proj.weight,lang_model.model.layers.3.self_attn.v_proj.weight,lang_model.model.layers.3.self_attn.o_proj.weight,lang_model.model.layers.3.mlp.gate_proj.weight,lang_model.model.layers.3.mlp.down_proj.weight,lang_model.model.layers.3.mlp.up_proj.weight,lang_model.model.layers.3.input_layernorm.weight,lang_model.model.layers.3.post_attention_layernorm.weight,lang_model.model.layers.4.self_attn.q_proj.weight,lang_model.model.layers.4.self_attn.k_proj.weight,lang_model.model.layers.4.self_attn.v_proj.weight,lang_model.model.layers.4.self_attn.o_proj.weight,lang_model.model.layers.4.mlp.gate_proj.weight,lang_model.model.layers.4.mlp.down_proj.weight,lang_model.model.layers.4.mlp.up_proj.weight,lang_model.model.layers.4.input_layernorm.weight,lang_model.model.layers.4.post_attention_layernorm.weight,lang_model.model.layers.5.self_attn.q_proj.weight,lang_model.model.layers.5.self_attn.k_proj.weight,lang_model.model.layers.5.self_attn.v_proj.weight,lang_model.model.layers.5.self_attn.o_proj.weight,lang_model.model.layers.5.mlp.gate_proj.weight,lang_model.model.layers.5.mlp.down_proj.weight,lang_model.model.layers.5.mlp.up_proj.weight,lang_model.model.layers.5.input_layernorm.weight,lang_model.model.layers.5.post_attention_layernorm.weight,lang_model.model.layers.6.self_attn.q_proj.weight,lang_model.model.layers.6.self_attn.k_proj.weight,lang_model.model.layers.6.self_attn.v_proj.weight,lang_model.model.layers.6.self_attn.o_proj.weight,lang_model.model.layers.6.mlp.gate_proj.weight,lang_model.model.layers.6.mlp.down_proj.weight,lang_model.model.layers.6.mlp.up_proj.weight,lang_model.model.layers.6.input_layernorm.weight,lang_model.model.layers.6.post_attention_layernorm.weight,lang_model.model.layers.7.self_attn.q_proj.weight,lang_model.model.layers.7.self_attn.k_proj.weight,lang_model.model.layers.7.self_attn.v_proj.weight,lang_model.model.layers.7.self_attn.o_proj.weight,lang_model.model.layers.7.mlp.gate_proj.weight,lang_model.model.layers.7.mlp.down_proj.weight,lang_model.model.layers.7.mlp.up_proj.weight,lang_model.model.layers.7.input_layernorm.weight,lang_model.model.layers.7.post_attention_layernorm.weight,lang_model.model.layers.8.self_attn.q_proj.weight,lang_model.model.layers.8.self_attn.k_proj.weight,lang_model.model.layers.8.self_attn.v_proj.weight,lang_model.model.layers.8.self_attn.o_proj.weight,lang_model.model.layers.8.mlp.gate_proj.weight,lang_model.model.layers.8.mlp.down_proj.weight,lang_model.model.layers.8.mlp.up_proj.weight,lang_model.model.layers.8.input_layernorm.weight,lang_model.model.layers.8.post_attention_layernorm.weight,lang_model.model.layers.9.self_attn.q_proj.weight,lang_model.model.layers.9.self_attn.k_proj.weight,lang_model.model.layers.9.self_attn.v_proj.weight,lang_model.model.layers.9.self_attn.o_proj.weight,lang_model.model.layers.9.mlp.gate_proj.weight,lang_model.model.layers.9.mlp.down_proj.weight,lang_model.model.layers.9.mlp.up_proj.weight,lang_model.model.layers.9.input_layernorm.weight,lang_model.model.layers.9.post_attention_layernorm.weight,lang_model.model.layers.10.self_attn.q_proj.weight,lang_model.model.layers.10.self_attn.k_proj.weight,lang_model.model.layers.10.self_attn.v_proj.weight,lang_model.model.layers.10.self_attn.o_proj.weight,lang_model.model.layers.10.mlp.gate_proj.weight,lang_model.model.layers.10.mlp.down_proj.weight,lang_model.model.layers.10.mlp.up_proj.weight,lang_model.model.layers.10.input_layernorm.weight,lang_model.model.layers.10.post_attention_layernorm.weight,lang_model.model.layers.11.self_attn.q_proj.weight,lang_model.model.layers.11.self_attn.k_proj.weight,lang_model.model.layers.11.self_attn.v_proj.weight,lang_model.model.layers.11.self_attn.o_proj.weight,lang_model.model.layers.11.mlp.gate_proj.weight,lang_model.model.layers.11.mlp.down_proj.weight,lang_model.model.layers.11.mlp.up_proj.weight,lang_model.model.layers.11.input_layernorm.weight,lang_model.model.layers.11.post_attention_layernorm.weight,lang_model.model.layers.12.self_attn.q_proj.weight,lang_model.model.layers.12.self_attn.k_proj.weight,lang_model.model.layers.12.self_attn.v_proj.weight,lang_model.model.layers.12.self_attn.o_proj.weight,lang_model.model.layers.12.mlp.gate_proj.weight,lang_model.model.layers.12.mlp.down_proj.weight,lang_model.model.layers.12.mlp.up_proj.weight,lang_model.model.layers.12.input_layernorm.weight,lang_model.model.layers.12.post_attention_layernorm.weight,lang_model.model.layers.13.self_attn.q_proj.weight,lang_model.model.layers.13.self_attn.k_proj.weight,lang_model.model.layers.13.self_attn.v_proj.weight,lang_model.model.layers.13.self_attn.o_proj.weight,lang_model.model.layers.13.mlp.gate_proj.weight,lang_model.model.layers.13.mlp.down_proj.weight,lang_model.model.layers.13.mlp.up_proj.weight,lang_model.model.layers.13.input_layernorm.weight,lang_model.model.layers.13.post_attention_layernorm.weight,lang_model.model.layers.14.self_attn.q_proj.weight,lang_model.model.layers.14.self_attn.k_proj.weight,lang_model.model.layers.14.self_attn.v_proj.weight,lang_model.model.layers.14.self_attn.o_proj.weight,lang_model.model.layers.14.mlp.gate_proj.weight,lang_model.model.layers.14.mlp.down_proj.weight,lang_model.model.layers.14.mlp.up_proj.weight,lang_model.model.layers.14.input_layernorm.weight,lang_model.model.layers.14.post_attention_layernorm.weight,lang_model.model.layers.15.self_attn.q_proj.weight,lang_model.model.layers.15.self_attn.k_proj.weight,lang_model.model.layers.15.self_attn.v_proj.weight,lang_model.model.layers.15.self_attn.o_proj.weight,lang_model.model.layers.15.mlp.gate_proj.weight,lang_model.model.layers.15.mlp.down_proj.weight,lang_model.model.layers.15.mlp.up_proj.weight,lang_model.model.layers.15.input_layernorm.weight,lang_model.model.layers.15.post_attention_layernorm.weight,lang_model.model.layers.16.self_attn.q_proj.weight,lang_model.model.layers.16.self_attn.k_proj.weight,lang_model.model.layers.16.self_attn.v_proj.weight,lang_model.model.layers.16.self_attn.o_proj.weight,lang_model.model.layers.16.mlp.gate_proj.weight,lang_model.model.layers.16.mlp.down_proj.weight,lang_model.model.layers.16.mlp.up_proj.weight,lang_model.model.layers.16.input_layernorm.weight,lang_model.model.layers.16.post_attention_layernorm.weight,lang_model.model.layers.17.self_attn.q_proj.weight,lang_model.model.layers.17.self_attn.k_proj.weight,lang_model.model.layers.17.self_attn.v_proj.weight,lang_model.model.layers.17.self_attn.o_proj.weight,lang_model.model.layers.17.mlp.gate_proj.weight,lang_model.model.layers.17.mlp.down_proj.weight,lang_model.model.layers.17.mlp.up_proj.weight,lang_model.model.layers.17.input_layernorm.weight,lang_model.model.layers.17.post_attention_layernorm.weight,lang_model.model.layers.18.self_attn.q_proj.weight,lang_model.model.layers.18.self_attn.k_proj.weight,lang_model.model.layers.18.self_attn.v_proj.weight,lang_model.model.layers.18.self_attn.o_proj.weight,lang_model.model.layers.18.mlp.gate_proj.weight,lang_model.model.layers.18.mlp.down_proj.weight,lang_model.model.layers.18.mlp.up_proj.weight,lang_model.model.layers.18.input_layernorm.weight,lang_model.model.layers.18.post_attention_layernorm.weight,lang_model.model.layers.19.self_attn.q_proj.weight,lang_model.model.layers.19.self_attn.k_proj.weight,lang_model.model.layers.19.self_attn.v_proj.weight,lang_model.model.layers.19.self_attn.o_proj.weight,lang_model.model.layers.19.mlp.gate_proj.weight,lang_model.model.layers.19.mlp.down_proj.weight,lang_model.model.layers.19.mlp.up_proj.weight,lang_model.model.layers.19.input_layernorm.weight,lang_model.model.layers.19.post_attention_layernorm.weight,lang_model.model.layers.20.self_attn.q_proj.weight,lang_model.model.layers.20.self_attn.k_proj.weight,lang_model.model.layers.20.self_attn.v_proj.weight,lang_model.model.layers.20.self_attn.o_proj.weight,lang_model.model.layers.20.mlp.gate_proj.weight,lang_model.model.layers.20.mlp.down_proj.weight,lang_model.model.layers.20.mlp.up_proj.weight,lang_model.model.layers.20.input_layernorm.weight,lang_model.model.layers.20.post_attention_layernorm.weight,lang_model.model.layers.21.self_attn.q_proj.weight,lang_model.model.layers.21.self_attn.k_proj.weight,lang_model.model.layers.21.self_attn.v_proj.weight,lang_model.model.layers.21.self_attn.o_proj.weight,lang_model.model.layers.21.mlp.gate_proj.weight,lang_model.model.layers.21.mlp.down_proj.weight,lang_model.model.layers.21.mlp.up_proj.weight,lang_model.model.layers.21.input_layernorm.weight,lang_model.model.layers.21.post_attention_layernorm.weight,lang_model.model.layers.22.self_attn.q_proj.weight,lang_model.model.layers.22.self_attn.k_proj.weight,lang_model.model.layers.22.self_attn.v_proj.weight,lang_model.model.layers.22.self_attn.o_proj.weight,lang_model.model.layers.22.mlp.gate_proj.weight,lang_model.model.layers.22.mlp.down_proj.weight,lang_model.model.layers.22.mlp.up_proj.weight,lang_model.model.layers.22.input_layernorm.weight,lang_model.model.layers.22.post_attention_layernorm.weight,lang_model.model.layers.23.self_attn.q_proj.weight,lang_model.model.layers.23.self_attn.k_proj.weight,lang_model.model.layers.23.self_attn.v_proj.weight,lang_model.model.layers.23.self_attn.o_proj.weight,lang_model.model.layers.23.mlp.gate_proj.weight,lang_model.model.layers.23.mlp.down_proj.weight,lang_model.model.layers.23.mlp.up_proj.weight,lang_model.model.layers.23.input_layernorm.weight,lang_model.model.layers.23.post_attention_layernorm.weight,lang_model.model.layers.24.self_attn.q_proj.weight,lang_model.model.layers.24.self_attn.k_proj.weight,lang_model.model.layers.24.self_attn.v_proj.weight,lang_model.model.layers.24.self_attn.o_proj.weight,lang_model.model.layers.24.mlp.gate_proj.weight,lang_model.model.layers.24.mlp.down_proj.weight,lang_model.model.layers.24.mlp.up_proj.weight,lang_model.model.layers.24.input_layernorm.weight,lang_model.model.layers.24.post_attention_layernorm.weight,lang_model.model.layers.25.self_attn.q_proj.weight,lang_model.model.layers.25.self_attn.k_proj.weight,lang_model.model.layers.25.self_attn.v_proj.weight,lang_model.model.layers.25.self_attn.o_proj.weight,lang_model.model.layers.25.mlp.gate_proj.weight,lang_model.model.layers.25.mlp.down_proj.weight,lang_model.model.layers.25.mlp.up_proj.weight,lang_model.model.layers.25.input_layernorm.weight,lang_model.model.layers.25.post_attention_layernorm.weight,lang_model.model.layers.26.self_attn.q_proj.weight,lang_model.model.layers.26.self_attn.k_proj.weight,lang_model.model.layers.26.self_attn.v_proj.weight,lang_model.model.layers.26.self_attn.o_proj.weight,lang_model.model.layers.26.mlp.gate_proj.weight,lang_model.model.layers.26.mlp.down_proj.weight,lang_model.model.layers.26.mlp.up_proj.weight,lang_model.model.layers.26.input_layernorm.weight,lang_model.model.layers.26.post_attention_layernorm.weight,lang_model.model.layers.27.self_attn.q_proj.weight,lang_model.model.layers.27.self_attn.k_proj.weight,lang_model.model.layers.27.self_attn.v_proj.weight,lang_model.model.layers.27.self_attn.o_proj.weight,lang_model.model.layers.27.mlp.gate_proj.weight,lang_model.model.layers.27.mlp.down_proj.weight,lang_model.model.layers.27.mlp.up_proj.weight,lang_model.model.layers.27.input_layernorm.weight,lang_model.model.layers.27.post_attention_layernorm.weight,lang_model.model.layers.28.self_attn.q_proj.weight,lang_model.model.layers.28.self_attn.k_proj.weight,lang_model.model.layers.28.self_attn.v_proj.weight,lang_model.model.layers.28.self_attn.o_proj.weight,lang_model.model.layers.28.mlp.gate_proj.weight,lang_model.model.layers.28.mlp.down_proj.weight,lang_model.model.layers.28.mlp.up_proj.weight,lang_model.model.layers.28.input_layernorm.weight,lang_model.model.layers.28.post_attention_layernorm.weight,lang_model.model.layers.29.self_attn.q_proj.weight,lang_model.model.layers.29.self_attn.k_proj.weight,lang_model.model.layers.29.self_attn.v_proj.weight,lang_model.model.layers.29.self_attn.o_proj.weight,lang_model.model.layers.29.mlp.gate_proj.weight,lang_model.model.layers.29.mlp.down_proj.weight,lang_model.model.layers.29.mlp.up_proj.weight,lang_model.model.layers.29.input_layernorm.weight,lang_model.model.layers.29.post_attention_layernorm.weight,lang_model.model.layers.30.self_attn.q_proj.weight,lang_model.model.layers.30.self_attn.k_proj.weight,lang_model.model.layers.30.self_attn.v_proj.weight,lang_model.model.layers.30.self_attn.o_proj.weight,lang_model.model.layers.30.mlp.gate_proj.weight,lang_model.model.layers.30.mlp.down_proj.weight,lang_model.model.layers.30.mlp.up_proj.weight,lang_model.model.layers.30.input_layernorm.weight,lang_model.model.layers.30.post_attention_layernorm.weight,lang_model.model.layers.31.self_attn.q_proj.weight,lang_model.model.layers.31.self_attn.k_proj.weight,lang_model.model.layers.31.self_attn.v_proj.weight,lang_model.model.layers.31.self_attn.o_proj.weight,lang_model.model.layers.31.mlp.gate_proj.weight,lang_model.model.layers.31.mlp.down_proj.weight,lang_model.model.layers.31.mlp.up_proj.weight,lang_model.model.layers.31.input_layernorm.weight,lang_model.model.layers.31.post_attention_layernorm.weight,lang_model.model.norm.weight,lang_model.lm_head.weight,img_embeddings.img_linear.weight,img_embeddings.img_linear.bias,img_embeddings.img_layer_norm.weight,img_embeddings.img_layer_norm.bias,img_embeddings.loc_linear.weight,img_embeddings.loc_linear.bias,img_embeddings.loc_layer_norm.weight,img_embeddings.loc_layer_norm.bias,img_embeddings.nav_type_embedding.weight,img_embeddings.layer_norm.weight,img_embeddings.layer_norm.bias,img_embeddings.pano_encoder.layers.0.self_attn.in_proj_weight,img_embeddings.pano_encoder.layers.0.self_attn.in_proj_bias,img_embeddings.pano_encoder.layers.0.self_attn.out_proj.weight,img_embeddings.pano_encoder.layers.0.self_attn.out_proj.bias,img_embeddings.pano_encoder.layers.0.linear1.weight,img_embeddings.pano_encoder.layers.0.linear1.bias,img_embeddings.pano_encoder.layers.0.linear2.weight,img_embeddings.pano_encoder.layers.0.linear2.bias,img_embeddings.pano_encoder.layers.0.norm1.weight,img_embeddings.pano_encoder.layers.0.norm1.bias,img_embeddings.pano_encoder.layers.0.norm2.weight,img_embeddings.pano_encoder.layers.0.norm2.bias,img_embeddings.pano_encoder.layers.1.self_attn.in_proj_weight,img_embeddings.pano_encoder.layers.1.self_attn.in_proj_bias,img_embeddings.pano_encoder.layers.1.self_attn.out_proj.weight,img_embeddings.pano_encoder.layers.1.self_attn.out_proj.bias,img_embeddings.pano_encoder.layers.1.linear1.weight,img_embeddings.pano_encoder.layers.1.linear1.bias,img_embeddings.pano_encoder.layers.1.linear2.weight,img_embeddings.pano_encoder.layers.1.linear2.bias,img_embeddings.pano_encoder.layers.1.norm1.weight,img_embeddings.pano_encoder.layers.1.norm1.bias,img_embeddings.pano_encoder.layers.1.norm2.weight,img_embeddings.pano_encoder.layers.1.norm2.bias,img_embeddings.pano_encoder.norm.weight,img_embeddings.pano_encoder.norm.bias,img_embeddings.mapper.weight,img_embeddings.mapper.bias,token_type_embeddings.weight,gmap_pos_embeddings.0.weight,gmap_pos_embeddings.0.bias,gmap_pos_embeddings.1.weight,gmap_pos_embeddings.1.bias,gmap_step_embeddings.weight,vp_pos_embeddings.0.weight,vp_pos_embeddings.0.bias,vp_pos_embeddings.1.weight,vp_pos_embeddings.1.bias,obj_pos_embeddings.0.weight,obj_pos_embeddings.0.bias,obj_pos_embeddings.1.weight,obj_pos_embeddings.1.bias,og_head.0.weight,og_head.0.bias,out_head.0.weight,out_head.0.bias
2026-01-06 10:42:10,013   INFO  *************** init model *************** 
2026-01-06 10:42:18,334   INFO  Loading checkpoint from /data/wanghaoxuan/roomtour3d.pt
2026-01-06 10:42:24,274   INFO  Ignore weight img_embeddings.obj_projector.0.weight: torch.Size([4096, 768])
2026-01-06 10:42:24,275   INFO  Ignore weight img_embeddings.obj_projector.0.bias: torch.Size([4096])
2026-01-06 10:42:24,275   INFO  Ignore weight img_embeddings.obj_projector.1.weight: torch.Size([4096])
2026-01-06 10:42:24,275   INFO  Ignore weight img_embeddings.obj_projector.1.bias: torch.Size([4096])
2026-01-06 10:42:25,640   INFO  <All keys matched successfully>
2026-01-06 10:42:26,065   INFO  model initialized with 6770.32 M trainable parameters
2026-01-06 10:42:26,065   INFO  Training with a single process
2026-01-06 10:42:26,066   INFO  **************************** Test ****************************
2026-01-06 10:42:26,067   INFO  ***** validate val_unseen split on CVDN task *****
2026-01-06 11:06:29,279   INFO  eval 907 predictions
2026-01-06 11:06:29,326   INFO  
[Eval] val_unseen epoch 0

 [Eval] dataset=[CVDN] 
, lengths: 34.97, nav_error: 13.20, oracle_sr: 50.61
[Eval] ||| sr: 21.83, spl: 17.41, oracle path_success_rate: 81.59, dist_to_end_reduction: 6.24
2026-01-06 11:13:32,406   INFO  **********************Start logging**********************
2026-01-06 11:13:32,406   INFO  CUDA_VISIBLE_DEVICES=0
2026-01-06 11:13:32,406   INFO  data_dir         /data/wanghaoxuan/data
2026-01-06 11:13:32,406   INFO  cfg_file         configs/multi.yaml
2026-01-06 11:13:32,406   INFO  pretrained_model_name_or_path /data/wanghaoxuan/data/models/Vicuna-7B
2026-01-06 11:13:32,406   INFO  off_batch_task   False
2026-01-06 11:13:32,406   INFO  debug            False
2026-01-06 11:13:32,406   INFO  few_shot         None
2026-01-06 11:13:32,406   INFO  tour3d_nav_head  False
2026-01-06 11:13:32,406   INFO  seed             0
2026-01-06 11:13:32,406   INFO  num_epochs       30
2026-01-06 11:13:32,407   INFO  resume_from_checkpoint /data/wanghaoxuan/roomtour3d.pt
2026-01-06 11:13:32,407   INFO  from_scratch     False
2026-01-06 11:13:32,407   INFO  batch_size       4
2026-01-06 11:13:32,407   INFO  val_batch_size   2
2026-01-06 11:13:32,407   INFO  lr               1e-05
2026-01-06 11:13:32,407   INFO  feat_dropout     0.4
2026-01-06 11:13:32,407   INFO  num_warmup_steps 0
2026-01-06 11:13:32,407   INFO  num_steps_per_epoch -1
2026-01-06 11:13:32,407   INFO  gradient_accumulation_step 2
2026-01-06 11:13:32,407   INFO  precision        amp_bf16
2026-01-06 11:13:32,407   INFO  workers          0
2026-01-06 11:13:32,407   INFO  gpu              0
2026-01-06 11:13:32,407   INFO  world_size       1
2026-01-06 11:13:32,407   INFO  local_rank       0
2026-01-06 11:13:32,407   INFO  dist_url         env://
2026-01-06 11:13:32,407   INFO  dist_backend     nccl
2026-01-06 11:13:32,407   INFO  horovod          False
2026-01-06 11:13:32,407   INFO  no_set_device_rank False
2026-01-06 11:13:32,407   INFO  output_dir       build/eval
2026-01-06 11:13:32,407   INFO  max_saved_checkpoints 0
2026-01-06 11:13:32,408   INFO  save_ckpt_per_epochs 10
2026-01-06 11:13:32,408   INFO  save_latest_states False
2026-01-06 11:13:32,408   INFO  save_pred_results True
2026-01-06 11:13:32,408   INFO  save_detail_results False
2026-01-06 11:13:32,408   INFO  mode             test
2026-01-06 11:13:32,408   INFO  stage            multi
2026-01-06 11:13:32,408   INFO  ignoreid         -100
2026-01-06 11:13:32,408   INFO  enable_og        False
2026-01-06 11:13:32,408   INFO  enable_summarize False
2026-01-06 11:13:32,408   INFO  enable_fgr2r     False
2026-01-06 11:13:32,408   INFO  disable_nav      False
2026-01-06 11:13:32,408   INFO  gen_loss_coef    1.0
2026-01-06 11:13:32,408   INFO  obj_loss_coef    1.0
2026-01-06 11:13:32,408   INFO  teacher_forcing_coef 1.0
2026-01-06 11:13:32,408   INFO  fuse_obj         False
2026-01-06 11:13:32,408   INFO  use_lora         False
2026-01-06 11:13:32,408   INFO  lora_rank        8
2026-01-06 11:13:32,408   INFO  lora_alpha       16
2026-01-06 11:13:32,408   INFO  lora_dropout     0.05
2026-01-06 11:13:32,408   INFO  lora_target      None
2026-01-06 11:13:32,409   INFO  freeze_llama     False
2026-01-06 11:13:32,409   INFO  tune_token_emb   False
2026-01-06 11:13:32,409   INFO  no_loc_fts       False
2026-01-06 11:13:32,409   INFO  multi_endpoints  1
2026-01-06 11:13:32,409   INFO  path_type        trusted_path
2026-01-06 11:13:32,409   INFO  test_datasets    ['CVDN']
2026-01-06 11:13:32,409   INFO  validation_split test
2026-01-06 11:13:32,409   INFO  do_sample        False
2026-01-06 11:13:32,409   INFO  temperature      1.0
2026-01-06 11:13:32,409   INFO  max_datapoints   None
2026-01-06 11:13:32,409   INFO  rank             0
2026-01-06 11:13:32,409   INFO  distributed      False
2026-01-06 11:13:32,409   INFO  device           cuda:0
2026-01-06 11:13:32,409   INFO  image_feat_size  1024
2026-01-06 11:13:32,409   INFO  obj_feat_size    768
2026-01-06 11:13:32,409   INFO  angle_feat_size  4
2026-01-06 11:13:32,409   INFO  enc_full_graph   True
2026-01-06 11:13:32,409   INFO  expert_policy    spl
2026-01-06 11:13:32,410   INFO  num_pano_layers  2
2026-01-06 11:13:32,410   INFO  ----------- Feature -----------
2026-01-06 11:13:32,410   INFO  cfg.Feature.object_feature_type: 
2026-01-06 11:13:32,410   INFO  cfg.Feature.angle_feat_size: 4
2026-01-06 11:13:32,410   INFO  cfg.Feature.max_objects: 70
2026-01-06 11:13:32,410   INFO  cfg.Feature.image_feat_size: 1024
2026-01-06 11:13:32,410   INFO  ----------- feature_database -----------
2026-01-06 11:13:32,410   INFO  cfg.Feature.feature_database.mp3d: eva_features/mp3d_EVA02-CLIP-L-14-336.hdf5
2026-01-06 11:13:32,410   INFO  cfg.Feature.feature_database.scan_qa: eva_features/scanqa_EVA02-CLIP-L-14-336.hdf5
2026-01-06 11:13:32,410   INFO  cfg.Feature.feature_database.room_tour: eva_features/web_obj_prog_p1_EVA02-CLIP-L-14-336.hdf5.bak
2026-01-06 11:13:32,410   INFO  cfg.Feature.feature_database.room3d_tour: eva_features/web_3d_obj_prog_crop_p1_EVA02-CLIP-L-14-336.hdf5
2026-01-06 11:13:32,410   INFO  cfg.Feature.feature_database.coco: eva_features/coco_EVA02-CLIP-L-14-336.hdf5
2026-01-06 11:13:32,410   INFO  cfg.Feature.obj_feat_size: 768
2026-01-06 11:13:32,410   INFO  ----------- object_database -----------
2026-01-06 11:13:32,410   INFO  cfg.Feature.object_database.reverie: obj_features/reverie_obj_feat
2026-01-06 11:13:32,410   INFO  cfg.Feature.object_database.soon: obj_features/soon_obj_feat
2026-01-06 11:13:32,410   INFO  ----------- Dataset -----------
2026-01-06 11:13:32,410   INFO  ----------- R2R -----------
2026-01-06 11:13:32,410   INFO  cfg.Dataset.R2R.DIR: R2R
2026-01-06 11:13:32,411   INFO  ----------- SPLIT -----------
2026-01-06 11:13:32,411   INFO  cfg.Dataset.R2R.SPLIT.train: FGR2R_train.json
2026-01-06 11:13:32,411   INFO  cfg.Dataset.R2R.SPLIT.val_seen: R2R_val_seen_enc.json
2026-01-06 11:13:32,411   INFO  cfg.Dataset.R2R.SPLIT.val_unseen: R2R_val_unseen_enc.json
2026-01-06 11:13:32,411   INFO  cfg.Dataset.R2R.SPLIT.test: R2R_test_enc.json
2026-01-06 11:13:32,411   INFO  ----------- REVERIE -----------
2026-01-06 11:13:32,411   INFO  cfg.Dataset.REVERIE.DIR: REVERIE
2026-01-06 11:13:32,411   INFO  cfg.Dataset.REVERIE.bbox_file: BBoxes.json
2026-01-06 11:13:32,411   INFO  ----------- SPLIT -----------
2026-01-06 11:13:32,411   INFO  cfg.Dataset.REVERIE.SPLIT.train: REVERIE_train_enc.json
2026-01-06 11:13:32,411   INFO  cfg.Dataset.REVERIE.SPLIT.val_seen: REVERIE_val_seen_enc.json
2026-01-06 11:13:32,411   INFO  cfg.Dataset.REVERIE.SPLIT.val_unseen: REVERIE_val_unseen_enc.json
2026-01-06 11:13:32,411   INFO  cfg.Dataset.REVERIE.SPLIT.test: REVERIE_test_enc.json
2026-01-06 11:13:32,411   INFO  ----------- CVDN -----------
2026-01-06 11:13:32,411   INFO  cfg.Dataset.CVDN.DIR: CVDN
2026-01-06 11:13:32,411   INFO  ----------- SPLIT -----------
2026-01-06 11:13:32,411   INFO  cfg.Dataset.CVDN.SPLIT.train: train.json
2026-01-06 11:13:32,411   INFO  cfg.Dataset.CVDN.SPLIT.val_seen: val_seen.json
2026-01-06 11:13:32,411   INFO  cfg.Dataset.CVDN.SPLIT.val_unseen: val_unseen.json
2026-01-06 11:13:32,412   INFO  cfg.Dataset.CVDN.SPLIT.test: test_cleaned.json
2026-01-06 11:13:32,412   INFO  ----------- SOON -----------
2026-01-06 11:13:32,412   INFO  cfg.Dataset.SOON.DIR: SOON
2026-01-06 11:13:32,412   INFO  ----------- SPLIT -----------
2026-01-06 11:13:32,412   INFO  cfg.Dataset.SOON.SPLIT.train: train_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 11:13:32,412   INFO  cfg.Dataset.SOON.SPLIT.val_seen: val_unseen_instrs_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 11:13:32,412   INFO  cfg.Dataset.SOON.SPLIT.val_unseen: val_unseen_house_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 11:13:32,412   INFO  cfg.Dataset.SOON.SPLIT.test: test_v2_enc.jsonl
2026-01-06 11:13:32,412   INFO  ----------- ScanQA -----------
2026-01-06 11:13:32,412   INFO  cfg.Dataset.ScanQA.DIR: ScanQA
2026-01-06 11:13:32,412   INFO  ----------- SPLIT -----------
2026-01-06 11:13:32,412   INFO  cfg.Dataset.ScanQA.SPLIT.train: ScanQA_v1.0_train_reformat.json
2026-01-06 11:13:32,412   INFO  cfg.Dataset.ScanQA.SPLIT.val_unseen: ScanQA_v1.0_val_reformat.json
2026-01-06 11:13:32,412   INFO  cfg.Dataset.ScanQA.SPLIT.test_wo_obj: ScanQA_v1.0_test_wo_obj_reformat.json
2026-01-06 11:13:32,412   INFO  cfg.Dataset.ScanQA.SPLIT.test_w_obj: ScanQA_v1.0_test_w_obj_reformat.json
2026-01-06 11:13:32,412   INFO  ----------- RoomTour -----------
2026-01-06 11:13:32,412   INFO  cfg.Dataset.RoomTour.DIR: RoomTour
2026-01-06 11:13:32,412   INFO  ----------- SPLIT -----------
2026-01-06 11:13:32,412   INFO  cfg.Dataset.RoomTour.SPLIT.train: p1_train_reformat.json
2026-01-06 11:13:32,413   INFO  ----------- Tour3D -----------
2026-01-06 11:13:32,413   INFO  cfg.Dataset.Tour3D.DIR: RoomTour
2026-01-06 11:13:32,413   INFO  ----------- SPLIT -----------
2026-01-06 11:13:32,413   INFO  cfg.Dataset.Tour3D.SPLIT.train: p1_train_colmap_trajectory_tour3d.json
2026-01-06 11:13:32,413   INFO  ----------- EQA -----------
2026-01-06 11:13:32,413   INFO  cfg.Dataset.EQA.DIR: EQA_MP3D
2026-01-06 11:13:32,413   INFO  ----------- SPLIT -----------
2026-01-06 11:13:32,413   INFO  cfg.Dataset.EQA.SPLIT.val_unseen: eqa_val_enc.json
2026-01-06 11:13:32,413   INFO  cfg.Dataset.EQA.ANSWER_VOCAB: eqa_answer_vocab.json
2026-01-06 11:13:32,413   INFO  ----------- R2R_AUG -----------
2026-01-06 11:13:32,413   INFO  cfg.Dataset.R2R_AUG.DIR: R2R
2026-01-06 11:13:32,413   INFO  ----------- SPLIT -----------
2026-01-06 11:13:32,413   INFO  cfg.Dataset.R2R_AUG.SPLIT.train: R2R_prevalent_aug_train_enc.jsonl
2026-01-06 11:13:32,413   INFO  ----------- REVERIE_AUG -----------
2026-01-06 11:13:32,413   INFO  cfg.Dataset.REVERIE_AUG.DIR: REVERIE
2026-01-06 11:13:32,413   INFO  cfg.Dataset.REVERIE_AUG.bbox_file: BBoxes.json
2026-01-06 11:13:32,413   INFO  ----------- SPLIT -----------
2026-01-06 11:13:32,413   INFO  cfg.Dataset.REVERIE_AUG.SPLIT.train: REVERIE_speaker_aug_enc.jsonl
2026-01-06 11:13:32,413   INFO  ----------- LLaVA -----------
2026-01-06 11:13:32,414   INFO  cfg.Dataset.LLaVA.DIR: LLaVA
2026-01-06 11:13:32,414   INFO  ----------- SPLIT -----------
2026-01-06 11:13:32,414   INFO  cfg.Dataset.LLaVA.SPLIT.train: detail_23k.json
2026-01-06 11:13:32,414   INFO  ----------- Pretrain -----------
2026-01-06 11:13:32,414   INFO  cfg.Pretrain.SOURCE: ['Tour3D', 'RoomTour', 'ScanQA', 'LLaVA']
2026-01-06 11:13:32,414   INFO  cfg.Pretrain.Ratio: [10, 20, 5, 2]
2026-01-06 11:13:32,414   INFO  ----------- LOSS_COEF -----------
2026-01-06 11:13:32,414   INFO  cfg.Pretrain.LOSS_COEF.R2R_AUG: 1
2026-01-06 11:13:32,414   INFO  cfg.Pretrain.LOSS_COEF.REVERIE_AUG: 1
2026-01-06 11:13:32,414   INFO  ----------- Multi -----------
2026-01-06 11:13:32,414   INFO  cfg.Multi.SOURCE: ['Tour3D', 'R2R', 'REVERIE', 'CVDN', 'SOON', 'ScanQA', 'LLaVA']
2026-01-06 11:13:32,414   INFO  cfg.Multi.Ratio: [10, 20, 5, 1, 5, 5, 5]
2026-01-06 11:13:32,414   INFO  ----------- LOSS_COEF -----------
2026-01-06 11:13:32,414   INFO  ----------- Model -----------
2026-01-06 11:13:32,414   INFO  cfg.Model.num_l_layers: 9
2026-01-06 11:13:32,414   INFO  cfg.Model.num_pano_layers: 2
2026-01-06 11:13:32,414   INFO  cfg.Model.num_x_layers: 4
2026-01-06 11:13:32,414   INFO  cfg.Model.graph_sprels: True
2026-01-06 11:13:32,415   INFO  cfg.Model.fusion: dynamic
2026-01-06 11:13:32,415   INFO  cfg.Model.enc_full_graph: True
2026-01-06 11:13:32,415   INFO  cfg.Model.expert_policy: spl
2026-01-06 11:13:32,415   INFO  ----------- Optim -----------
2026-01-06 11:13:32,415   INFO  ----------- val_max_action_len -----------
2026-01-06 11:13:32,415   INFO  cfg.Optim.val_max_action_len.R2R: 15
2026-01-06 11:13:32,415   INFO  cfg.Optim.val_max_action_len.REVERIE: 15
2026-01-06 11:13:32,415   INFO  cfg.Optim.val_max_action_len.CVDN: 30
2026-01-06 11:13:32,415   INFO  cfg.Optim.val_max_action_len.SOON: 20
2026-01-06 11:13:32,415   INFO  cfg.Optim.val_max_action_len.EQA: 15
2026-01-06 11:13:32,415   INFO  ----------- train_max_action_len -----------
2026-01-06 11:13:32,415   INFO  cfg.Optim.train_max_action_len.R2R: 15
2026-01-06 11:13:32,415   INFO  cfg.Optim.train_max_action_len.Tour3D: 15
2026-01-06 11:13:32,415   INFO  cfg.Optim.train_max_action_len.REVERIE: 15
2026-01-06 11:13:32,415   INFO  cfg.Optim.train_max_action_len.CVDN: 15
2026-01-06 11:13:32,415   INFO  cfg.Optim.train_max_action_len.SOON: 15
2026-01-06 11:13:32,415   INFO  cfg.Optim.train_max_action_len.EQA: 15
2026-01-06 11:13:32,415   INFO  cfg.Optim.train_max_action_len.R2R_AUG: 15
2026-01-06 11:13:32,415   INFO  cfg.Optim.train_max_action_len.REVERIE_AUG: 15
2026-01-06 11:13:35,217   INFO  [INFO] CVDNDataset loaded with 1384 instructions, using splits: test
2026-01-06 11:13:35,217   INFO  
- Dataset: load 1384 CVDN samples
- Dataset: load test split: 1384 samples in total
- Dataset: load test split: 16 scans in total
2026-01-06 11:13:35,218   INFO  CVDN: 1384 samples loaded
2026-01-06 11:13:35,321   INFO  Initialize the model from config.
2026-01-06 11:15:05,501   INFO  model type: torch.bfloat16
2026-01-06 11:15:05,509   INFO  Trainable params: lang_model.model.embed_tokens.weight,lang_model.model.layers.0.self_attn.q_proj.weight,lang_model.model.layers.0.self_attn.k_proj.weight,lang_model.model.layers.0.self_attn.v_proj.weight,lang_model.model.layers.0.self_attn.o_proj.weight,lang_model.model.layers.0.mlp.gate_proj.weight,lang_model.model.layers.0.mlp.down_proj.weight,lang_model.model.layers.0.mlp.up_proj.weight,lang_model.model.layers.0.input_layernorm.weight,lang_model.model.layers.0.post_attention_layernorm.weight,lang_model.model.layers.1.self_attn.q_proj.weight,lang_model.model.layers.1.self_attn.k_proj.weight,lang_model.model.layers.1.self_attn.v_proj.weight,lang_model.model.layers.1.self_attn.o_proj.weight,lang_model.model.layers.1.mlp.gate_proj.weight,lang_model.model.layers.1.mlp.down_proj.weight,lang_model.model.layers.1.mlp.up_proj.weight,lang_model.model.layers.1.input_layernorm.weight,lang_model.model.layers.1.post_attention_layernorm.weight,lang_model.model.layers.2.self_attn.q_proj.weight,lang_model.model.layers.2.self_attn.k_proj.weight,lang_model.model.layers.2.self_attn.v_proj.weight,lang_model.model.layers.2.self_attn.o_proj.weight,lang_model.model.layers.2.mlp.gate_proj.weight,lang_model.model.layers.2.mlp.down_proj.weight,lang_model.model.layers.2.mlp.up_proj.weight,lang_model.model.layers.2.input_layernorm.weight,lang_model.model.layers.2.post_attention_layernorm.weight,lang_model.model.layers.3.self_attn.q_proj.weight,lang_model.model.layers.3.self_attn.k_proj.weight,lang_model.model.layers.3.self_attn.v_proj.weight,lang_model.model.layers.3.self_attn.o_proj.weight,lang_model.model.layers.3.mlp.gate_proj.weight,lang_model.model.layers.3.mlp.down_proj.weight,lang_model.model.layers.3.mlp.up_proj.weight,lang_model.model.layers.3.input_layernorm.weight,lang_model.model.layers.3.post_attention_layernorm.weight,lang_model.model.layers.4.self_attn.q_proj.weight,lang_model.model.layers.4.self_attn.k_proj.weight,lang_model.model.layers.4.self_attn.v_proj.weight,lang_model.model.layers.4.self_attn.o_proj.weight,lang_model.model.layers.4.mlp.gate_proj.weight,lang_model.model.layers.4.mlp.down_proj.weight,lang_model.model.layers.4.mlp.up_proj.weight,lang_model.model.layers.4.input_layernorm.weight,lang_model.model.layers.4.post_attention_layernorm.weight,lang_model.model.layers.5.self_attn.q_proj.weight,lang_model.model.layers.5.self_attn.k_proj.weight,lang_model.model.layers.5.self_attn.v_proj.weight,lang_model.model.layers.5.self_attn.o_proj.weight,lang_model.model.layers.5.mlp.gate_proj.weight,lang_model.model.layers.5.mlp.down_proj.weight,lang_model.model.layers.5.mlp.up_proj.weight,lang_model.model.layers.5.input_layernorm.weight,lang_model.model.layers.5.post_attention_layernorm.weight,lang_model.model.layers.6.self_attn.q_proj.weight,lang_model.model.layers.6.self_attn.k_proj.weight,lang_model.model.layers.6.self_attn.v_proj.weight,lang_model.model.layers.6.self_attn.o_proj.weight,lang_model.model.layers.6.mlp.gate_proj.weight,lang_model.model.layers.6.mlp.down_proj.weight,lang_model.model.layers.6.mlp.up_proj.weight,lang_model.model.layers.6.input_layernorm.weight,lang_model.model.layers.6.post_attention_layernorm.weight,lang_model.model.layers.7.self_attn.q_proj.weight,lang_model.model.layers.7.self_attn.k_proj.weight,lang_model.model.layers.7.self_attn.v_proj.weight,lang_model.model.layers.7.self_attn.o_proj.weight,lang_model.model.layers.7.mlp.gate_proj.weight,lang_model.model.layers.7.mlp.down_proj.weight,lang_model.model.layers.7.mlp.up_proj.weight,lang_model.model.layers.7.input_layernorm.weight,lang_model.model.layers.7.post_attention_layernorm.weight,lang_model.model.layers.8.self_attn.q_proj.weight,lang_model.model.layers.8.self_attn.k_proj.weight,lang_model.model.layers.8.self_attn.v_proj.weight,lang_model.model.layers.8.self_attn.o_proj.weight,lang_model.model.layers.8.mlp.gate_proj.weight,lang_model.model.layers.8.mlp.down_proj.weight,lang_model.model.layers.8.mlp.up_proj.weight,lang_model.model.layers.8.input_layernorm.weight,lang_model.model.layers.8.post_attention_layernorm.weight,lang_model.model.layers.9.self_attn.q_proj.weight,lang_model.model.layers.9.self_attn.k_proj.weight,lang_model.model.layers.9.self_attn.v_proj.weight,lang_model.model.layers.9.self_attn.o_proj.weight,lang_model.model.layers.9.mlp.gate_proj.weight,lang_model.model.layers.9.mlp.down_proj.weight,lang_model.model.layers.9.mlp.up_proj.weight,lang_model.model.layers.9.input_layernorm.weight,lang_model.model.layers.9.post_attention_layernorm.weight,lang_model.model.layers.10.self_attn.q_proj.weight,lang_model.model.layers.10.self_attn.k_proj.weight,lang_model.model.layers.10.self_attn.v_proj.weight,lang_model.model.layers.10.self_attn.o_proj.weight,lang_model.model.layers.10.mlp.gate_proj.weight,lang_model.model.layers.10.mlp.down_proj.weight,lang_model.model.layers.10.mlp.up_proj.weight,lang_model.model.layers.10.input_layernorm.weight,lang_model.model.layers.10.post_attention_layernorm.weight,lang_model.model.layers.11.self_attn.q_proj.weight,lang_model.model.layers.11.self_attn.k_proj.weight,lang_model.model.layers.11.self_attn.v_proj.weight,lang_model.model.layers.11.self_attn.o_proj.weight,lang_model.model.layers.11.mlp.gate_proj.weight,lang_model.model.layers.11.mlp.down_proj.weight,lang_model.model.layers.11.mlp.up_proj.weight,lang_model.model.layers.11.input_layernorm.weight,lang_model.model.layers.11.post_attention_layernorm.weight,lang_model.model.layers.12.self_attn.q_proj.weight,lang_model.model.layers.12.self_attn.k_proj.weight,lang_model.model.layers.12.self_attn.v_proj.weight,lang_model.model.layers.12.self_attn.o_proj.weight,lang_model.model.layers.12.mlp.gate_proj.weight,lang_model.model.layers.12.mlp.down_proj.weight,lang_model.model.layers.12.mlp.up_proj.weight,lang_model.model.layers.12.input_layernorm.weight,lang_model.model.layers.12.post_attention_layernorm.weight,lang_model.model.layers.13.self_attn.q_proj.weight,lang_model.model.layers.13.self_attn.k_proj.weight,lang_model.model.layers.13.self_attn.v_proj.weight,lang_model.model.layers.13.self_attn.o_proj.weight,lang_model.model.layers.13.mlp.gate_proj.weight,lang_model.model.layers.13.mlp.down_proj.weight,lang_model.model.layers.13.mlp.up_proj.weight,lang_model.model.layers.13.input_layernorm.weight,lang_model.model.layers.13.post_attention_layernorm.weight,lang_model.model.layers.14.self_attn.q_proj.weight,lang_model.model.layers.14.self_attn.k_proj.weight,lang_model.model.layers.14.self_attn.v_proj.weight,lang_model.model.layers.14.self_attn.o_proj.weight,lang_model.model.layers.14.mlp.gate_proj.weight,lang_model.model.layers.14.mlp.down_proj.weight,lang_model.model.layers.14.mlp.up_proj.weight,lang_model.model.layers.14.input_layernorm.weight,lang_model.model.layers.14.post_attention_layernorm.weight,lang_model.model.layers.15.self_attn.q_proj.weight,lang_model.model.layers.15.self_attn.k_proj.weight,lang_model.model.layers.15.self_attn.v_proj.weight,lang_model.model.layers.15.self_attn.o_proj.weight,lang_model.model.layers.15.mlp.gate_proj.weight,lang_model.model.layers.15.mlp.down_proj.weight,lang_model.model.layers.15.mlp.up_proj.weight,lang_model.model.layers.15.input_layernorm.weight,lang_model.model.layers.15.post_attention_layernorm.weight,lang_model.model.layers.16.self_attn.q_proj.weight,lang_model.model.layers.16.self_attn.k_proj.weight,lang_model.model.layers.16.self_attn.v_proj.weight,lang_model.model.layers.16.self_attn.o_proj.weight,lang_model.model.layers.16.mlp.gate_proj.weight,lang_model.model.layers.16.mlp.down_proj.weight,lang_model.model.layers.16.mlp.up_proj.weight,lang_model.model.layers.16.input_layernorm.weight,lang_model.model.layers.16.post_attention_layernorm.weight,lang_model.model.layers.17.self_attn.q_proj.weight,lang_model.model.layers.17.self_attn.k_proj.weight,lang_model.model.layers.17.self_attn.v_proj.weight,lang_model.model.layers.17.self_attn.o_proj.weight,lang_model.model.layers.17.mlp.gate_proj.weight,lang_model.model.layers.17.mlp.down_proj.weight,lang_model.model.layers.17.mlp.up_proj.weight,lang_model.model.layers.17.input_layernorm.weight,lang_model.model.layers.17.post_attention_layernorm.weight,lang_model.model.layers.18.self_attn.q_proj.weight,lang_model.model.layers.18.self_attn.k_proj.weight,lang_model.model.layers.18.self_attn.v_proj.weight,lang_model.model.layers.18.self_attn.o_proj.weight,lang_model.model.layers.18.mlp.gate_proj.weight,lang_model.model.layers.18.mlp.down_proj.weight,lang_model.model.layers.18.mlp.up_proj.weight,lang_model.model.layers.18.input_layernorm.weight,lang_model.model.layers.18.post_attention_layernorm.weight,lang_model.model.layers.19.self_attn.q_proj.weight,lang_model.model.layers.19.self_attn.k_proj.weight,lang_model.model.layers.19.self_attn.v_proj.weight,lang_model.model.layers.19.self_attn.o_proj.weight,lang_model.model.layers.19.mlp.gate_proj.weight,lang_model.model.layers.19.mlp.down_proj.weight,lang_model.model.layers.19.mlp.up_proj.weight,lang_model.model.layers.19.input_layernorm.weight,lang_model.model.layers.19.post_attention_layernorm.weight,lang_model.model.layers.20.self_attn.q_proj.weight,lang_model.model.layers.20.self_attn.k_proj.weight,lang_model.model.layers.20.self_attn.v_proj.weight,lang_model.model.layers.20.self_attn.o_proj.weight,lang_model.model.layers.20.mlp.gate_proj.weight,lang_model.model.layers.20.mlp.down_proj.weight,lang_model.model.layers.20.mlp.up_proj.weight,lang_model.model.layers.20.input_layernorm.weight,lang_model.model.layers.20.post_attention_layernorm.weight,lang_model.model.layers.21.self_attn.q_proj.weight,lang_model.model.layers.21.self_attn.k_proj.weight,lang_model.model.layers.21.self_attn.v_proj.weight,lang_model.model.layers.21.self_attn.o_proj.weight,lang_model.model.layers.21.mlp.gate_proj.weight,lang_model.model.layers.21.mlp.down_proj.weight,lang_model.model.layers.21.mlp.up_proj.weight,lang_model.model.layers.21.input_layernorm.weight,lang_model.model.layers.21.post_attention_layernorm.weight,lang_model.model.layers.22.self_attn.q_proj.weight,lang_model.model.layers.22.self_attn.k_proj.weight,lang_model.model.layers.22.self_attn.v_proj.weight,lang_model.model.layers.22.self_attn.o_proj.weight,lang_model.model.layers.22.mlp.gate_proj.weight,lang_model.model.layers.22.mlp.down_proj.weight,lang_model.model.layers.22.mlp.up_proj.weight,lang_model.model.layers.22.input_layernorm.weight,lang_model.model.layers.22.post_attention_layernorm.weight,lang_model.model.layers.23.self_attn.q_proj.weight,lang_model.model.layers.23.self_attn.k_proj.weight,lang_model.model.layers.23.self_attn.v_proj.weight,lang_model.model.layers.23.self_attn.o_proj.weight,lang_model.model.layers.23.mlp.gate_proj.weight,lang_model.model.layers.23.mlp.down_proj.weight,lang_model.model.layers.23.mlp.up_proj.weight,lang_model.model.layers.23.input_layernorm.weight,lang_model.model.layers.23.post_attention_layernorm.weight,lang_model.model.layers.24.self_attn.q_proj.weight,lang_model.model.layers.24.self_attn.k_proj.weight,lang_model.model.layers.24.self_attn.v_proj.weight,lang_model.model.layers.24.self_attn.o_proj.weight,lang_model.model.layers.24.mlp.gate_proj.weight,lang_model.model.layers.24.mlp.down_proj.weight,lang_model.model.layers.24.mlp.up_proj.weight,lang_model.model.layers.24.input_layernorm.weight,lang_model.model.layers.24.post_attention_layernorm.weight,lang_model.model.layers.25.self_attn.q_proj.weight,lang_model.model.layers.25.self_attn.k_proj.weight,lang_model.model.layers.25.self_attn.v_proj.weight,lang_model.model.layers.25.self_attn.o_proj.weight,lang_model.model.layers.25.mlp.gate_proj.weight,lang_model.model.layers.25.mlp.down_proj.weight,lang_model.model.layers.25.mlp.up_proj.weight,lang_model.model.layers.25.input_layernorm.weight,lang_model.model.layers.25.post_attention_layernorm.weight,lang_model.model.layers.26.self_attn.q_proj.weight,lang_model.model.layers.26.self_attn.k_proj.weight,lang_model.model.layers.26.self_attn.v_proj.weight,lang_model.model.layers.26.self_attn.o_proj.weight,lang_model.model.layers.26.mlp.gate_proj.weight,lang_model.model.layers.26.mlp.down_proj.weight,lang_model.model.layers.26.mlp.up_proj.weight,lang_model.model.layers.26.input_layernorm.weight,lang_model.model.layers.26.post_attention_layernorm.weight,lang_model.model.layers.27.self_attn.q_proj.weight,lang_model.model.layers.27.self_attn.k_proj.weight,lang_model.model.layers.27.self_attn.v_proj.weight,lang_model.model.layers.27.self_attn.o_proj.weight,lang_model.model.layers.27.mlp.gate_proj.weight,lang_model.model.layers.27.mlp.down_proj.weight,lang_model.model.layers.27.mlp.up_proj.weight,lang_model.model.layers.27.input_layernorm.weight,lang_model.model.layers.27.post_attention_layernorm.weight,lang_model.model.layers.28.self_attn.q_proj.weight,lang_model.model.layers.28.self_attn.k_proj.weight,lang_model.model.layers.28.self_attn.v_proj.weight,lang_model.model.layers.28.self_attn.o_proj.weight,lang_model.model.layers.28.mlp.gate_proj.weight,lang_model.model.layers.28.mlp.down_proj.weight,lang_model.model.layers.28.mlp.up_proj.weight,lang_model.model.layers.28.input_layernorm.weight,lang_model.model.layers.28.post_attention_layernorm.weight,lang_model.model.layers.29.self_attn.q_proj.weight,lang_model.model.layers.29.self_attn.k_proj.weight,lang_model.model.layers.29.self_attn.v_proj.weight,lang_model.model.layers.29.self_attn.o_proj.weight,lang_model.model.layers.29.mlp.gate_proj.weight,lang_model.model.layers.29.mlp.down_proj.weight,lang_model.model.layers.29.mlp.up_proj.weight,lang_model.model.layers.29.input_layernorm.weight,lang_model.model.layers.29.post_attention_layernorm.weight,lang_model.model.layers.30.self_attn.q_proj.weight,lang_model.model.layers.30.self_attn.k_proj.weight,lang_model.model.layers.30.self_attn.v_proj.weight,lang_model.model.layers.30.self_attn.o_proj.weight,lang_model.model.layers.30.mlp.gate_proj.weight,lang_model.model.layers.30.mlp.down_proj.weight,lang_model.model.layers.30.mlp.up_proj.weight,lang_model.model.layers.30.input_layernorm.weight,lang_model.model.layers.30.post_attention_layernorm.weight,lang_model.model.layers.31.self_attn.q_proj.weight,lang_model.model.layers.31.self_attn.k_proj.weight,lang_model.model.layers.31.self_attn.v_proj.weight,lang_model.model.layers.31.self_attn.o_proj.weight,lang_model.model.layers.31.mlp.gate_proj.weight,lang_model.model.layers.31.mlp.down_proj.weight,lang_model.model.layers.31.mlp.up_proj.weight,lang_model.model.layers.31.input_layernorm.weight,lang_model.model.layers.31.post_attention_layernorm.weight,lang_model.model.norm.weight,lang_model.lm_head.weight,img_embeddings.img_linear.weight,img_embeddings.img_linear.bias,img_embeddings.img_layer_norm.weight,img_embeddings.img_layer_norm.bias,img_embeddings.loc_linear.weight,img_embeddings.loc_linear.bias,img_embeddings.loc_layer_norm.weight,img_embeddings.loc_layer_norm.bias,img_embeddings.nav_type_embedding.weight,img_embeddings.layer_norm.weight,img_embeddings.layer_norm.bias,img_embeddings.pano_encoder.layers.0.self_attn.in_proj_weight,img_embeddings.pano_encoder.layers.0.self_attn.in_proj_bias,img_embeddings.pano_encoder.layers.0.self_attn.out_proj.weight,img_embeddings.pano_encoder.layers.0.self_attn.out_proj.bias,img_embeddings.pano_encoder.layers.0.linear1.weight,img_embeddings.pano_encoder.layers.0.linear1.bias,img_embeddings.pano_encoder.layers.0.linear2.weight,img_embeddings.pano_encoder.layers.0.linear2.bias,img_embeddings.pano_encoder.layers.0.norm1.weight,img_embeddings.pano_encoder.layers.0.norm1.bias,img_embeddings.pano_encoder.layers.0.norm2.weight,img_embeddings.pano_encoder.layers.0.norm2.bias,img_embeddings.pano_encoder.layers.1.self_attn.in_proj_weight,img_embeddings.pano_encoder.layers.1.self_attn.in_proj_bias,img_embeddings.pano_encoder.layers.1.self_attn.out_proj.weight,img_embeddings.pano_encoder.layers.1.self_attn.out_proj.bias,img_embeddings.pano_encoder.layers.1.linear1.weight,img_embeddings.pano_encoder.layers.1.linear1.bias,img_embeddings.pano_encoder.layers.1.linear2.weight,img_embeddings.pano_encoder.layers.1.linear2.bias,img_embeddings.pano_encoder.layers.1.norm1.weight,img_embeddings.pano_encoder.layers.1.norm1.bias,img_embeddings.pano_encoder.layers.1.norm2.weight,img_embeddings.pano_encoder.layers.1.norm2.bias,img_embeddings.pano_encoder.norm.weight,img_embeddings.pano_encoder.norm.bias,img_embeddings.mapper.weight,img_embeddings.mapper.bias,token_type_embeddings.weight,gmap_pos_embeddings.0.weight,gmap_pos_embeddings.0.bias,gmap_pos_embeddings.1.weight,gmap_pos_embeddings.1.bias,gmap_step_embeddings.weight,vp_pos_embeddings.0.weight,vp_pos_embeddings.0.bias,vp_pos_embeddings.1.weight,vp_pos_embeddings.1.bias,obj_pos_embeddings.0.weight,obj_pos_embeddings.0.bias,obj_pos_embeddings.1.weight,obj_pos_embeddings.1.bias,og_head.0.weight,og_head.0.bias,out_head.0.weight,out_head.0.bias
2026-01-06 11:15:05,510   INFO  *************** init model *************** 
2026-01-06 11:15:09,018   INFO  Loading checkpoint from /data/wanghaoxuan/roomtour3d.pt
2026-01-06 11:15:13,614   INFO  Ignore weight img_embeddings.obj_projector.0.weight: torch.Size([4096, 768])
2026-01-06 11:15:13,614   INFO  Ignore weight img_embeddings.obj_projector.0.bias: torch.Size([4096])
2026-01-06 11:15:13,615   INFO  Ignore weight img_embeddings.obj_projector.1.weight: torch.Size([4096])
2026-01-06 11:15:13,615   INFO  Ignore weight img_embeddings.obj_projector.1.bias: torch.Size([4096])
2026-01-06 11:15:14,636   INFO  <All keys matched successfully>
2026-01-06 11:15:14,990   INFO  model initialized with 6770.32 M trainable parameters
2026-01-06 11:15:14,990   INFO  Training with a single process
2026-01-06 11:15:14,990   INFO  **************************** Test ****************************
2026-01-06 11:15:14,992   INFO  ***** validate test split on CVDN task *****
2026-01-06 11:52:30,758   INFO  
[Eval] test epoch 0

2026-01-06 11:56:24,394   INFO  **********************Start logging**********************
2026-01-06 11:56:24,394   INFO  CUDA_VISIBLE_DEVICES=0,1,2,3
2026-01-06 11:56:24,394   INFO  data_dir         /data/wanghaoxuan/data
2026-01-06 11:56:24,394   INFO  cfg_file         configs/multi.yaml
2026-01-06 11:56:24,394   INFO  pretrained_model_name_or_path /data/wanghaoxuan/data/models/Vicuna-7B
2026-01-06 11:56:24,394   INFO  off_batch_task   False
2026-01-06 11:56:24,394   INFO  debug            False
2026-01-06 11:56:24,394   INFO  few_shot         None
2026-01-06 11:56:24,394   INFO  tour3d_nav_head  False
2026-01-06 11:56:24,394   INFO  seed             0
2026-01-06 11:56:24,394   INFO  num_epochs       30
2026-01-06 11:56:24,394   INFO  resume_from_checkpoint /data/wanghaoxuan/roomtour3d.pt
2026-01-06 11:56:24,394   INFO  from_scratch     False
2026-01-06 11:56:24,394   INFO  batch_size       4
2026-01-06 11:56:24,395   INFO  val_batch_size   2
2026-01-06 11:56:24,395   INFO  lr               1e-05
2026-01-06 11:56:24,395   INFO  feat_dropout     0.4
2026-01-06 11:56:24,395   INFO  num_warmup_steps 0
2026-01-06 11:56:24,395   INFO  num_steps_per_epoch -1
2026-01-06 11:56:24,395   INFO  gradient_accumulation_step 2
2026-01-06 11:56:24,395   INFO  precision        amp_bf16
2026-01-06 11:56:24,395   INFO  workers          0
2026-01-06 11:56:24,395   INFO  gpu              0
2026-01-06 11:56:24,395   INFO  world_size       4
2026-01-06 11:56:24,395   INFO  local_rank       0
2026-01-06 11:56:24,395   INFO  dist_url         env://
2026-01-06 11:56:24,395   INFO  dist_backend     nccl
2026-01-06 11:56:24,395   INFO  horovod          False
2026-01-06 11:56:24,395   INFO  no_set_device_rank False
2026-01-06 11:56:24,395   INFO  output_dir       build/eval
2026-01-06 11:56:24,395   INFO  max_saved_checkpoints 0
2026-01-06 11:56:24,395   INFO  save_ckpt_per_epochs 10
2026-01-06 11:56:24,395   INFO  save_latest_states False
2026-01-06 11:56:24,396   INFO  save_pred_results False
2026-01-06 11:56:24,396   INFO  save_detail_results False
2026-01-06 11:56:24,396   INFO  mode             test
2026-01-06 11:56:24,396   INFO  stage            multi
2026-01-06 11:56:24,396   INFO  ignoreid         -100
2026-01-06 11:56:24,396   INFO  enable_og        False
2026-01-06 11:56:24,396   INFO  enable_summarize False
2026-01-06 11:56:24,396   INFO  enable_fgr2r     False
2026-01-06 11:56:24,396   INFO  disable_nav      False
2026-01-06 11:56:24,396   INFO  gen_loss_coef    1.0
2026-01-06 11:56:24,396   INFO  obj_loss_coef    1.0
2026-01-06 11:56:24,396   INFO  teacher_forcing_coef 1.0
2026-01-06 11:56:24,396   INFO  fuse_obj         False
2026-01-06 11:56:24,396   INFO  use_lora         False
2026-01-06 11:56:24,396   INFO  lora_rank        8
2026-01-06 11:56:24,396   INFO  lora_alpha       16
2026-01-06 11:56:24,396   INFO  lora_dropout     0.05
2026-01-06 11:56:24,396   INFO  lora_target      None
2026-01-06 11:56:24,396   INFO  freeze_llama     False
2026-01-06 11:56:24,397   INFO  tune_token_emb   False
2026-01-06 11:56:24,397   INFO  no_loc_fts       False
2026-01-06 11:56:24,397   INFO  multi_endpoints  1
2026-01-06 11:56:24,397   INFO  path_type        trusted_path
2026-01-06 11:56:24,397   INFO  test_datasets    ['R2R']
2026-01-06 11:56:24,397   INFO  validation_split val_unseen
2026-01-06 11:56:24,397   INFO  do_sample        False
2026-01-06 11:56:24,397   INFO  temperature      1.0
2026-01-06 11:56:24,397   INFO  max_datapoints   None
2026-01-06 11:56:24,397   INFO  rank             0
2026-01-06 11:56:24,397   INFO  distributed      True
2026-01-06 11:56:24,397   INFO  device           cuda:0
2026-01-06 11:56:24,397   INFO  image_feat_size  1024
2026-01-06 11:56:24,397   INFO  obj_feat_size    768
2026-01-06 11:56:24,397   INFO  angle_feat_size  4
2026-01-06 11:56:24,397   INFO  enc_full_graph   True
2026-01-06 11:56:24,397   INFO  expert_policy    spl
2026-01-06 11:56:24,397   INFO  num_pano_layers  2
2026-01-06 11:56:24,398   INFO  ----------- Feature -----------
2026-01-06 11:56:24,398   INFO  cfg.Feature.object_feature_type: 
2026-01-06 11:56:24,398   INFO  cfg.Feature.angle_feat_size: 4
2026-01-06 11:56:24,398   INFO  cfg.Feature.max_objects: 70
2026-01-06 11:56:24,398   INFO  cfg.Feature.image_feat_size: 1024
2026-01-06 11:56:24,398   INFO  ----------- feature_database -----------
2026-01-06 11:56:24,398   INFO  cfg.Feature.feature_database.mp3d: eva_features/mp3d_EVA02-CLIP-L-14-336.hdf5
2026-01-06 11:56:24,398   INFO  cfg.Feature.feature_database.scan_qa: eva_features/scanqa_EVA02-CLIP-L-14-336.hdf5
2026-01-06 11:56:24,398   INFO  cfg.Feature.feature_database.room_tour: eva_features/web_obj_prog_p1_EVA02-CLIP-L-14-336.hdf5.bak
2026-01-06 11:56:24,398   INFO  cfg.Feature.feature_database.room3d_tour: eva_features/web_3d_obj_prog_crop_p1_EVA02-CLIP-L-14-336.hdf5
2026-01-06 11:56:24,398   INFO  cfg.Feature.feature_database.coco: eva_features/coco_EVA02-CLIP-L-14-336.hdf5
2026-01-06 11:56:24,398   INFO  cfg.Feature.obj_feat_size: 768
2026-01-06 11:56:24,398   INFO  ----------- object_database -----------
2026-01-06 11:56:24,398   INFO  cfg.Feature.object_database.reverie: obj_features/reverie_obj_feat
2026-01-06 11:56:24,398   INFO  cfg.Feature.object_database.soon: obj_features/soon_obj_feat
2026-01-06 11:56:24,398   INFO  ----------- Dataset -----------
2026-01-06 11:56:24,398   INFO  ----------- R2R -----------
2026-01-06 11:56:24,398   INFO  cfg.Dataset.R2R.DIR: R2R
2026-01-06 11:56:24,398   INFO  ----------- SPLIT -----------
2026-01-06 11:56:24,399   INFO  cfg.Dataset.R2R.SPLIT.train: FGR2R_train.json
2026-01-06 11:56:24,399   INFO  cfg.Dataset.R2R.SPLIT.val_seen: R2R_val_seen_enc.json
2026-01-06 11:56:24,399   INFO  cfg.Dataset.R2R.SPLIT.val_unseen: R2R_val_unseen_enc.json
2026-01-06 11:56:24,399   INFO  cfg.Dataset.R2R.SPLIT.test: R2R_test_enc.json
2026-01-06 11:56:24,399   INFO  ----------- REVERIE -----------
2026-01-06 11:56:24,399   INFO  cfg.Dataset.REVERIE.DIR: REVERIE
2026-01-06 11:56:24,399   INFO  cfg.Dataset.REVERIE.bbox_file: BBoxes.json
2026-01-06 11:56:24,399   INFO  ----------- SPLIT -----------
2026-01-06 11:56:24,399   INFO  cfg.Dataset.REVERIE.SPLIT.train: REVERIE_train_enc.json
2026-01-06 11:56:24,399   INFO  cfg.Dataset.REVERIE.SPLIT.val_seen: REVERIE_val_seen_enc.json
2026-01-06 11:56:24,399   INFO  cfg.Dataset.REVERIE.SPLIT.val_unseen: REVERIE_val_unseen_enc.json
2026-01-06 11:56:24,399   INFO  cfg.Dataset.REVERIE.SPLIT.test: REVERIE_test_enc.json
2026-01-06 11:56:24,399   INFO  ----------- CVDN -----------
2026-01-06 11:56:24,399   INFO  cfg.Dataset.CVDN.DIR: CVDN
2026-01-06 11:56:24,399   INFO  ----------- SPLIT -----------
2026-01-06 11:56:24,399   INFO  cfg.Dataset.CVDN.SPLIT.train: train.json
2026-01-06 11:56:24,399   INFO  cfg.Dataset.CVDN.SPLIT.val_seen: val_seen.json
2026-01-06 11:56:24,399   INFO  cfg.Dataset.CVDN.SPLIT.val_unseen: val_unseen.json
2026-01-06 11:56:24,399   INFO  cfg.Dataset.CVDN.SPLIT.test: test_cleaned.json
2026-01-06 11:56:24,399   INFO  ----------- SOON -----------
2026-01-06 11:56:24,400   INFO  cfg.Dataset.SOON.DIR: SOON
2026-01-06 11:56:24,400   INFO  ----------- SPLIT -----------
2026-01-06 11:56:24,400   INFO  cfg.Dataset.SOON.SPLIT.train: train_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 11:56:24,400   INFO  cfg.Dataset.SOON.SPLIT.val_seen: val_unseen_instrs_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 11:56:24,400   INFO  cfg.Dataset.SOON.SPLIT.val_unseen: val_unseen_house_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 11:56:24,400   INFO  cfg.Dataset.SOON.SPLIT.test: test_v2_enc.jsonl
2026-01-06 11:56:24,400   INFO  ----------- ScanQA -----------
2026-01-06 11:56:24,400   INFO  cfg.Dataset.ScanQA.DIR: ScanQA
2026-01-06 11:56:24,400   INFO  ----------- SPLIT -----------
2026-01-06 11:56:24,400   INFO  cfg.Dataset.ScanQA.SPLIT.train: ScanQA_v1.0_train_reformat.json
2026-01-06 11:56:24,400   INFO  cfg.Dataset.ScanQA.SPLIT.val_unseen: ScanQA_v1.0_val_reformat.json
2026-01-06 11:56:24,400   INFO  cfg.Dataset.ScanQA.SPLIT.test_wo_obj: ScanQA_v1.0_test_wo_obj_reformat.json
2026-01-06 11:56:24,400   INFO  cfg.Dataset.ScanQA.SPLIT.test_w_obj: ScanQA_v1.0_test_w_obj_reformat.json
2026-01-06 11:56:24,400   INFO  ----------- RoomTour -----------
2026-01-06 11:56:24,400   INFO  cfg.Dataset.RoomTour.DIR: RoomTour
2026-01-06 11:56:24,400   INFO  ----------- SPLIT -----------
2026-01-06 11:56:24,400   INFO  cfg.Dataset.RoomTour.SPLIT.train: p1_train_reformat.json
2026-01-06 11:56:24,400   INFO  ----------- Tour3D -----------
2026-01-06 11:56:24,400   INFO  cfg.Dataset.Tour3D.DIR: RoomTour
2026-01-06 11:56:24,401   INFO  ----------- SPLIT -----------
2026-01-06 11:56:24,401   INFO  cfg.Dataset.Tour3D.SPLIT.train: p1_train_colmap_trajectory_tour3d.json
2026-01-06 11:56:24,401   INFO  ----------- EQA -----------
2026-01-06 11:56:24,401   INFO  cfg.Dataset.EQA.DIR: EQA_MP3D
2026-01-06 11:56:24,401   INFO  ----------- SPLIT -----------
2026-01-06 11:56:24,401   INFO  cfg.Dataset.EQA.SPLIT.val_unseen: eqa_val_enc.json
2026-01-06 11:56:24,401   INFO  cfg.Dataset.EQA.ANSWER_VOCAB: eqa_answer_vocab.json
2026-01-06 11:56:24,401   INFO  ----------- R2R_AUG -----------
2026-01-06 11:56:24,401   INFO  cfg.Dataset.R2R_AUG.DIR: R2R
2026-01-06 11:56:24,401   INFO  ----------- SPLIT -----------
2026-01-06 11:56:24,401   INFO  cfg.Dataset.R2R_AUG.SPLIT.train: R2R_prevalent_aug_train_enc.jsonl
2026-01-06 11:56:24,401   INFO  ----------- REVERIE_AUG -----------
2026-01-06 11:56:24,401   INFO  cfg.Dataset.REVERIE_AUG.DIR: REVERIE
2026-01-06 11:56:24,401   INFO  cfg.Dataset.REVERIE_AUG.bbox_file: BBoxes.json
2026-01-06 11:56:24,401   INFO  ----------- SPLIT -----------
2026-01-06 11:56:24,401   INFO  cfg.Dataset.REVERIE_AUG.SPLIT.train: REVERIE_speaker_aug_enc.jsonl
2026-01-06 11:56:24,401   INFO  ----------- LLaVA -----------
2026-01-06 11:56:24,401   INFO  cfg.Dataset.LLaVA.DIR: LLaVA
2026-01-06 11:56:24,401   INFO  ----------- SPLIT -----------
2026-01-06 11:56:24,402   INFO  cfg.Dataset.LLaVA.SPLIT.train: detail_23k.json
2026-01-06 11:56:24,402   INFO  ----------- Pretrain -----------
2026-01-06 11:56:24,402   INFO  cfg.Pretrain.SOURCE: ['Tour3D', 'RoomTour', 'ScanQA', 'LLaVA']
2026-01-06 11:56:24,402   INFO  cfg.Pretrain.Ratio: [10, 20, 5, 2]
2026-01-06 11:56:24,402   INFO  ----------- LOSS_COEF -----------
2026-01-06 11:56:24,402   INFO  cfg.Pretrain.LOSS_COEF.R2R_AUG: 1
2026-01-06 11:56:24,402   INFO  cfg.Pretrain.LOSS_COEF.REVERIE_AUG: 1
2026-01-06 11:56:24,402   INFO  ----------- Multi -----------
2026-01-06 11:56:24,402   INFO  cfg.Multi.SOURCE: ['Tour3D', 'R2R', 'REVERIE', 'CVDN', 'SOON', 'ScanQA', 'LLaVA']
2026-01-06 11:56:24,402   INFO  cfg.Multi.Ratio: [10, 20, 5, 1, 5, 5, 5]
2026-01-06 11:56:24,402   INFO  ----------- LOSS_COEF -----------
2026-01-06 11:56:24,402   INFO  ----------- Model -----------
2026-01-06 11:56:24,402   INFO  cfg.Model.num_l_layers: 9
2026-01-06 11:56:24,402   INFO  cfg.Model.num_pano_layers: 2
2026-01-06 11:56:24,402   INFO  cfg.Model.num_x_layers: 4
2026-01-06 11:56:24,402   INFO  cfg.Model.graph_sprels: True
2026-01-06 11:56:24,402   INFO  cfg.Model.fusion: dynamic
2026-01-06 11:56:24,402   INFO  cfg.Model.enc_full_graph: True
2026-01-06 11:56:24,402   INFO  cfg.Model.expert_policy: spl
2026-01-06 11:56:24,403   INFO  ----------- Optim -----------
2026-01-06 11:56:24,403   INFO  ----------- val_max_action_len -----------
2026-01-06 11:56:24,403   INFO  cfg.Optim.val_max_action_len.R2R: 15
2026-01-06 11:56:24,403   INFO  cfg.Optim.val_max_action_len.REVERIE: 15
2026-01-06 11:56:24,403   INFO  cfg.Optim.val_max_action_len.CVDN: 30
2026-01-06 11:56:24,403   INFO  cfg.Optim.val_max_action_len.SOON: 20
2026-01-06 11:56:24,403   INFO  cfg.Optim.val_max_action_len.EQA: 15
2026-01-06 11:56:24,403   INFO  ----------- train_max_action_len -----------
2026-01-06 11:56:24,403   INFO  cfg.Optim.train_max_action_len.R2R: 15
2026-01-06 11:56:24,403   INFO  cfg.Optim.train_max_action_len.Tour3D: 15
2026-01-06 11:56:24,403   INFO  cfg.Optim.train_max_action_len.REVERIE: 15
2026-01-06 11:56:24,403   INFO  cfg.Optim.train_max_action_len.CVDN: 15
2026-01-06 11:56:24,403   INFO  cfg.Optim.train_max_action_len.SOON: 15
2026-01-06 11:56:24,403   INFO  cfg.Optim.train_max_action_len.EQA: 15
2026-01-06 11:56:24,403   INFO  cfg.Optim.train_max_action_len.R2R_AUG: 15
2026-01-06 11:56:24,403   INFO  cfg.Optim.train_max_action_len.REVERIE_AUG: 15
2026-01-06 11:56:27,931   INFO  [INFO] R2RDataset loaded with 2349 instructions, using splits: val_unseen
2026-01-06 11:56:27,932   INFO  
- Dataset: load 2349 R2R samples
- Dataset: load val_unseen split: 2349 samples in total
- Dataset: load val_unseen split: 11 scans in total
2026-01-06 11:56:27,932   INFO  R2R: 2349 samples loaded
2026-01-06 11:56:27,997   INFO  Initialize the model from config.
2026-01-06 11:58:04,014   INFO  model type: torch.bfloat16
2026-01-06 11:58:04,016   INFO  Trainable params: lang_model.model.embed_tokens.weight,lang_model.model.layers.0.self_attn.q_proj.weight,lang_model.model.layers.0.self_attn.k_proj.weight,lang_model.model.layers.0.self_attn.v_proj.weight,lang_model.model.layers.0.self_attn.o_proj.weight,lang_model.model.layers.0.mlp.gate_proj.weight,lang_model.model.layers.0.mlp.down_proj.weight,lang_model.model.layers.0.mlp.up_proj.weight,lang_model.model.layers.0.input_layernorm.weight,lang_model.model.layers.0.post_attention_layernorm.weight,lang_model.model.layers.1.self_attn.q_proj.weight,lang_model.model.layers.1.self_attn.k_proj.weight,lang_model.model.layers.1.self_attn.v_proj.weight,lang_model.model.layers.1.self_attn.o_proj.weight,lang_model.model.layers.1.mlp.gate_proj.weight,lang_model.model.layers.1.mlp.down_proj.weight,lang_model.model.layers.1.mlp.up_proj.weight,lang_model.model.layers.1.input_layernorm.weight,lang_model.model.layers.1.post_attention_layernorm.weight,lang_model.model.layers.2.self_attn.q_proj.weight,lang_model.model.layers.2.self_attn.k_proj.weight,lang_model.model.layers.2.self_attn.v_proj.weight,lang_model.model.layers.2.self_attn.o_proj.weight,lang_model.model.layers.2.mlp.gate_proj.weight,lang_model.model.layers.2.mlp.down_proj.weight,lang_model.model.layers.2.mlp.up_proj.weight,lang_model.model.layers.2.input_layernorm.weight,lang_model.model.layers.2.post_attention_layernorm.weight,lang_model.model.layers.3.self_attn.q_proj.weight,lang_model.model.layers.3.self_attn.k_proj.weight,lang_model.model.layers.3.self_attn.v_proj.weight,lang_model.model.layers.3.self_attn.o_proj.weight,lang_model.model.layers.3.mlp.gate_proj.weight,lang_model.model.layers.3.mlp.down_proj.weight,lang_model.model.layers.3.mlp.up_proj.weight,lang_model.model.layers.3.input_layernorm.weight,lang_model.model.layers.3.post_attention_layernorm.weight,lang_model.model.layers.4.self_attn.q_proj.weight,lang_model.model.layers.4.self_attn.k_proj.weight,lang_model.model.layers.4.self_attn.v_proj.weight,lang_model.model.layers.4.self_attn.o_proj.weight,lang_model.model.layers.4.mlp.gate_proj.weight,lang_model.model.layers.4.mlp.down_proj.weight,lang_model.model.layers.4.mlp.up_proj.weight,lang_model.model.layers.4.input_layernorm.weight,lang_model.model.layers.4.post_attention_layernorm.weight,lang_model.model.layers.5.self_attn.q_proj.weight,lang_model.model.layers.5.self_attn.k_proj.weight,lang_model.model.layers.5.self_attn.v_proj.weight,lang_model.model.layers.5.self_attn.o_proj.weight,lang_model.model.layers.5.mlp.gate_proj.weight,lang_model.model.layers.5.mlp.down_proj.weight,lang_model.model.layers.5.mlp.up_proj.weight,lang_model.model.layers.5.input_layernorm.weight,lang_model.model.layers.5.post_attention_layernorm.weight,lang_model.model.layers.6.self_attn.q_proj.weight,lang_model.model.layers.6.self_attn.k_proj.weight,lang_model.model.layers.6.self_attn.v_proj.weight,lang_model.model.layers.6.self_attn.o_proj.weight,lang_model.model.layers.6.mlp.gate_proj.weight,lang_model.model.layers.6.mlp.down_proj.weight,lang_model.model.layers.6.mlp.up_proj.weight,lang_model.model.layers.6.input_layernorm.weight,lang_model.model.layers.6.post_attention_layernorm.weight,lang_model.model.layers.7.self_attn.q_proj.weight,lang_model.model.layers.7.self_attn.k_proj.weight,lang_model.model.layers.7.self_attn.v_proj.weight,lang_model.model.layers.7.self_attn.o_proj.weight,lang_model.model.layers.7.mlp.gate_proj.weight,lang_model.model.layers.7.mlp.down_proj.weight,lang_model.model.layers.7.mlp.up_proj.weight,lang_model.model.layers.7.input_layernorm.weight,lang_model.model.layers.7.post_attention_layernorm.weight,lang_model.model.layers.8.self_attn.q_proj.weight,lang_model.model.layers.8.self_attn.k_proj.weight,lang_model.model.layers.8.self_attn.v_proj.weight,lang_model.model.layers.8.self_attn.o_proj.weight,lang_model.model.layers.8.mlp.gate_proj.weight,lang_model.model.layers.8.mlp.down_proj.weight,lang_model.model.layers.8.mlp.up_proj.weight,lang_model.model.layers.8.input_layernorm.weight,lang_model.model.layers.8.post_attention_layernorm.weight,lang_model.model.layers.9.self_attn.q_proj.weight,lang_model.model.layers.9.self_attn.k_proj.weight,lang_model.model.layers.9.self_attn.v_proj.weight,lang_model.model.layers.9.self_attn.o_proj.weight,lang_model.model.layers.9.mlp.gate_proj.weight,lang_model.model.layers.9.mlp.down_proj.weight,lang_model.model.layers.9.mlp.up_proj.weight,lang_model.model.layers.9.input_layernorm.weight,lang_model.model.layers.9.post_attention_layernorm.weight,lang_model.model.layers.10.self_attn.q_proj.weight,lang_model.model.layers.10.self_attn.k_proj.weight,lang_model.model.layers.10.self_attn.v_proj.weight,lang_model.model.layers.10.self_attn.o_proj.weight,lang_model.model.layers.10.mlp.gate_proj.weight,lang_model.model.layers.10.mlp.down_proj.weight,lang_model.model.layers.10.mlp.up_proj.weight,lang_model.model.layers.10.input_layernorm.weight,lang_model.model.layers.10.post_attention_layernorm.weight,lang_model.model.layers.11.self_attn.q_proj.weight,lang_model.model.layers.11.self_attn.k_proj.weight,lang_model.model.layers.11.self_attn.v_proj.weight,lang_model.model.layers.11.self_attn.o_proj.weight,lang_model.model.layers.11.mlp.gate_proj.weight,lang_model.model.layers.11.mlp.down_proj.weight,lang_model.model.layers.11.mlp.up_proj.weight,lang_model.model.layers.11.input_layernorm.weight,lang_model.model.layers.11.post_attention_layernorm.weight,lang_model.model.layers.12.self_attn.q_proj.weight,lang_model.model.layers.12.self_attn.k_proj.weight,lang_model.model.layers.12.self_attn.v_proj.weight,lang_model.model.layers.12.self_attn.o_proj.weight,lang_model.model.layers.12.mlp.gate_proj.weight,lang_model.model.layers.12.mlp.down_proj.weight,lang_model.model.layers.12.mlp.up_proj.weight,lang_model.model.layers.12.input_layernorm.weight,lang_model.model.layers.12.post_attention_layernorm.weight,lang_model.model.layers.13.self_attn.q_proj.weight,lang_model.model.layers.13.self_attn.k_proj.weight,lang_model.model.layers.13.self_attn.v_proj.weight,lang_model.model.layers.13.self_attn.o_proj.weight,lang_model.model.layers.13.mlp.gate_proj.weight,lang_model.model.layers.13.mlp.down_proj.weight,lang_model.model.layers.13.mlp.up_proj.weight,lang_model.model.layers.13.input_layernorm.weight,lang_model.model.layers.13.post_attention_layernorm.weight,lang_model.model.layers.14.self_attn.q_proj.weight,lang_model.model.layers.14.self_attn.k_proj.weight,lang_model.model.layers.14.self_attn.v_proj.weight,lang_model.model.layers.14.self_attn.o_proj.weight,lang_model.model.layers.14.mlp.gate_proj.weight,lang_model.model.layers.14.mlp.down_proj.weight,lang_model.model.layers.14.mlp.up_proj.weight,lang_model.model.layers.14.input_layernorm.weight,lang_model.model.layers.14.post_attention_layernorm.weight,lang_model.model.layers.15.self_attn.q_proj.weight,lang_model.model.layers.15.self_attn.k_proj.weight,lang_model.model.layers.15.self_attn.v_proj.weight,lang_model.model.layers.15.self_attn.o_proj.weight,lang_model.model.layers.15.mlp.gate_proj.weight,lang_model.model.layers.15.mlp.down_proj.weight,lang_model.model.layers.15.mlp.up_proj.weight,lang_model.model.layers.15.input_layernorm.weight,lang_model.model.layers.15.post_attention_layernorm.weight,lang_model.model.layers.16.self_attn.q_proj.weight,lang_model.model.layers.16.self_attn.k_proj.weight,lang_model.model.layers.16.self_attn.v_proj.weight,lang_model.model.layers.16.self_attn.o_proj.weight,lang_model.model.layers.16.mlp.gate_proj.weight,lang_model.model.layers.16.mlp.down_proj.weight,lang_model.model.layers.16.mlp.up_proj.weight,lang_model.model.layers.16.input_layernorm.weight,lang_model.model.layers.16.post_attention_layernorm.weight,lang_model.model.layers.17.self_attn.q_proj.weight,lang_model.model.layers.17.self_attn.k_proj.weight,lang_model.model.layers.17.self_attn.v_proj.weight,lang_model.model.layers.17.self_attn.o_proj.weight,lang_model.model.layers.17.mlp.gate_proj.weight,lang_model.model.layers.17.mlp.down_proj.weight,lang_model.model.layers.17.mlp.up_proj.weight,lang_model.model.layers.17.input_layernorm.weight,lang_model.model.layers.17.post_attention_layernorm.weight,lang_model.model.layers.18.self_attn.q_proj.weight,lang_model.model.layers.18.self_attn.k_proj.weight,lang_model.model.layers.18.self_attn.v_proj.weight,lang_model.model.layers.18.self_attn.o_proj.weight,lang_model.model.layers.18.mlp.gate_proj.weight,lang_model.model.layers.18.mlp.down_proj.weight,lang_model.model.layers.18.mlp.up_proj.weight,lang_model.model.layers.18.input_layernorm.weight,lang_model.model.layers.18.post_attention_layernorm.weight,lang_model.model.layers.19.self_attn.q_proj.weight,lang_model.model.layers.19.self_attn.k_proj.weight,lang_model.model.layers.19.self_attn.v_proj.weight,lang_model.model.layers.19.self_attn.o_proj.weight,lang_model.model.layers.19.mlp.gate_proj.weight,lang_model.model.layers.19.mlp.down_proj.weight,lang_model.model.layers.19.mlp.up_proj.weight,lang_model.model.layers.19.input_layernorm.weight,lang_model.model.layers.19.post_attention_layernorm.weight,lang_model.model.layers.20.self_attn.q_proj.weight,lang_model.model.layers.20.self_attn.k_proj.weight,lang_model.model.layers.20.self_attn.v_proj.weight,lang_model.model.layers.20.self_attn.o_proj.weight,lang_model.model.layers.20.mlp.gate_proj.weight,lang_model.model.layers.20.mlp.down_proj.weight,lang_model.model.layers.20.mlp.up_proj.weight,lang_model.model.layers.20.input_layernorm.weight,lang_model.model.layers.20.post_attention_layernorm.weight,lang_model.model.layers.21.self_attn.q_proj.weight,lang_model.model.layers.21.self_attn.k_proj.weight,lang_model.model.layers.21.self_attn.v_proj.weight,lang_model.model.layers.21.self_attn.o_proj.weight,lang_model.model.layers.21.mlp.gate_proj.weight,lang_model.model.layers.21.mlp.down_proj.weight,lang_model.model.layers.21.mlp.up_proj.weight,lang_model.model.layers.21.input_layernorm.weight,lang_model.model.layers.21.post_attention_layernorm.weight,lang_model.model.layers.22.self_attn.q_proj.weight,lang_model.model.layers.22.self_attn.k_proj.weight,lang_model.model.layers.22.self_attn.v_proj.weight,lang_model.model.layers.22.self_attn.o_proj.weight,lang_model.model.layers.22.mlp.gate_proj.weight,lang_model.model.layers.22.mlp.down_proj.weight,lang_model.model.layers.22.mlp.up_proj.weight,lang_model.model.layers.22.input_layernorm.weight,lang_model.model.layers.22.post_attention_layernorm.weight,lang_model.model.layers.23.self_attn.q_proj.weight,lang_model.model.layers.23.self_attn.k_proj.weight,lang_model.model.layers.23.self_attn.v_proj.weight,lang_model.model.layers.23.self_attn.o_proj.weight,lang_model.model.layers.23.mlp.gate_proj.weight,lang_model.model.layers.23.mlp.down_proj.weight,lang_model.model.layers.23.mlp.up_proj.weight,lang_model.model.layers.23.input_layernorm.weight,lang_model.model.layers.23.post_attention_layernorm.weight,lang_model.model.layers.24.self_attn.q_proj.weight,lang_model.model.layers.24.self_attn.k_proj.weight,lang_model.model.layers.24.self_attn.v_proj.weight,lang_model.model.layers.24.self_attn.o_proj.weight,lang_model.model.layers.24.mlp.gate_proj.weight,lang_model.model.layers.24.mlp.down_proj.weight,lang_model.model.layers.24.mlp.up_proj.weight,lang_model.model.layers.24.input_layernorm.weight,lang_model.model.layers.24.post_attention_layernorm.weight,lang_model.model.layers.25.self_attn.q_proj.weight,lang_model.model.layers.25.self_attn.k_proj.weight,lang_model.model.layers.25.self_attn.v_proj.weight,lang_model.model.layers.25.self_attn.o_proj.weight,lang_model.model.layers.25.mlp.gate_proj.weight,lang_model.model.layers.25.mlp.down_proj.weight,lang_model.model.layers.25.mlp.up_proj.weight,lang_model.model.layers.25.input_layernorm.weight,lang_model.model.layers.25.post_attention_layernorm.weight,lang_model.model.layers.26.self_attn.q_proj.weight,lang_model.model.layers.26.self_attn.k_proj.weight,lang_model.model.layers.26.self_attn.v_proj.weight,lang_model.model.layers.26.self_attn.o_proj.weight,lang_model.model.layers.26.mlp.gate_proj.weight,lang_model.model.layers.26.mlp.down_proj.weight,lang_model.model.layers.26.mlp.up_proj.weight,lang_model.model.layers.26.input_layernorm.weight,lang_model.model.layers.26.post_attention_layernorm.weight,lang_model.model.layers.27.self_attn.q_proj.weight,lang_model.model.layers.27.self_attn.k_proj.weight,lang_model.model.layers.27.self_attn.v_proj.weight,lang_model.model.layers.27.self_attn.o_proj.weight,lang_model.model.layers.27.mlp.gate_proj.weight,lang_model.model.layers.27.mlp.down_proj.weight,lang_model.model.layers.27.mlp.up_proj.weight,lang_model.model.layers.27.input_layernorm.weight,lang_model.model.layers.27.post_attention_layernorm.weight,lang_model.model.layers.28.self_attn.q_proj.weight,lang_model.model.layers.28.self_attn.k_proj.weight,lang_model.model.layers.28.self_attn.v_proj.weight,lang_model.model.layers.28.self_attn.o_proj.weight,lang_model.model.layers.28.mlp.gate_proj.weight,lang_model.model.layers.28.mlp.down_proj.weight,lang_model.model.layers.28.mlp.up_proj.weight,lang_model.model.layers.28.input_layernorm.weight,lang_model.model.layers.28.post_attention_layernorm.weight,lang_model.model.layers.29.self_attn.q_proj.weight,lang_model.model.layers.29.self_attn.k_proj.weight,lang_model.model.layers.29.self_attn.v_proj.weight,lang_model.model.layers.29.self_attn.o_proj.weight,lang_model.model.layers.29.mlp.gate_proj.weight,lang_model.model.layers.29.mlp.down_proj.weight,lang_model.model.layers.29.mlp.up_proj.weight,lang_model.model.layers.29.input_layernorm.weight,lang_model.model.layers.29.post_attention_layernorm.weight,lang_model.model.layers.30.self_attn.q_proj.weight,lang_model.model.layers.30.self_attn.k_proj.weight,lang_model.model.layers.30.self_attn.v_proj.weight,lang_model.model.layers.30.self_attn.o_proj.weight,lang_model.model.layers.30.mlp.gate_proj.weight,lang_model.model.layers.30.mlp.down_proj.weight,lang_model.model.layers.30.mlp.up_proj.weight,lang_model.model.layers.30.input_layernorm.weight,lang_model.model.layers.30.post_attention_layernorm.weight,lang_model.model.layers.31.self_attn.q_proj.weight,lang_model.model.layers.31.self_attn.k_proj.weight,lang_model.model.layers.31.self_attn.v_proj.weight,lang_model.model.layers.31.self_attn.o_proj.weight,lang_model.model.layers.31.mlp.gate_proj.weight,lang_model.model.layers.31.mlp.down_proj.weight,lang_model.model.layers.31.mlp.up_proj.weight,lang_model.model.layers.31.input_layernorm.weight,lang_model.model.layers.31.post_attention_layernorm.weight,lang_model.model.norm.weight,lang_model.lm_head.weight,img_embeddings.img_linear.weight,img_embeddings.img_linear.bias,img_embeddings.img_layer_norm.weight,img_embeddings.img_layer_norm.bias,img_embeddings.loc_linear.weight,img_embeddings.loc_linear.bias,img_embeddings.loc_layer_norm.weight,img_embeddings.loc_layer_norm.bias,img_embeddings.nav_type_embedding.weight,img_embeddings.layer_norm.weight,img_embeddings.layer_norm.bias,img_embeddings.pano_encoder.layers.0.self_attn.in_proj_weight,img_embeddings.pano_encoder.layers.0.self_attn.in_proj_bias,img_embeddings.pano_encoder.layers.0.self_attn.out_proj.weight,img_embeddings.pano_encoder.layers.0.self_attn.out_proj.bias,img_embeddings.pano_encoder.layers.0.linear1.weight,img_embeddings.pano_encoder.layers.0.linear1.bias,img_embeddings.pano_encoder.layers.0.linear2.weight,img_embeddings.pano_encoder.layers.0.linear2.bias,img_embeddings.pano_encoder.layers.0.norm1.weight,img_embeddings.pano_encoder.layers.0.norm1.bias,img_embeddings.pano_encoder.layers.0.norm2.weight,img_embeddings.pano_encoder.layers.0.norm2.bias,img_embeddings.pano_encoder.layers.1.self_attn.in_proj_weight,img_embeddings.pano_encoder.layers.1.self_attn.in_proj_bias,img_embeddings.pano_encoder.layers.1.self_attn.out_proj.weight,img_embeddings.pano_encoder.layers.1.self_attn.out_proj.bias,img_embeddings.pano_encoder.layers.1.linear1.weight,img_embeddings.pano_encoder.layers.1.linear1.bias,img_embeddings.pano_encoder.layers.1.linear2.weight,img_embeddings.pano_encoder.layers.1.linear2.bias,img_embeddings.pano_encoder.layers.1.norm1.weight,img_embeddings.pano_encoder.layers.1.norm1.bias,img_embeddings.pano_encoder.layers.1.norm2.weight,img_embeddings.pano_encoder.layers.1.norm2.bias,img_embeddings.pano_encoder.norm.weight,img_embeddings.pano_encoder.norm.bias,img_embeddings.mapper.weight,img_embeddings.mapper.bias,token_type_embeddings.weight,gmap_pos_embeddings.0.weight,gmap_pos_embeddings.0.bias,gmap_pos_embeddings.1.weight,gmap_pos_embeddings.1.bias,gmap_step_embeddings.weight,vp_pos_embeddings.0.weight,vp_pos_embeddings.0.bias,vp_pos_embeddings.1.weight,vp_pos_embeddings.1.bias,obj_pos_embeddings.0.weight,obj_pos_embeddings.0.bias,obj_pos_embeddings.1.weight,obj_pos_embeddings.1.bias,og_head.0.weight,og_head.0.bias,out_head.0.weight,out_head.0.bias
2026-01-06 11:58:04,016   INFO  *************** init model *************** 
2026-01-06 11:58:07,431   INFO  Loading checkpoint from /data/wanghaoxuan/roomtour3d.pt
2026-01-06 11:58:12,547   INFO  Ignore weight img_embeddings.obj_projector.0.weight: torch.Size([4096, 768])
2026-01-06 11:58:12,548   INFO  Ignore weight img_embeddings.obj_projector.0.bias: torch.Size([4096])
2026-01-06 11:58:12,548   INFO  Ignore weight img_embeddings.obj_projector.1.weight: torch.Size([4096])
2026-01-06 11:58:12,548   INFO  Ignore weight img_embeddings.obj_projector.1.bias: torch.Size([4096])
2026-01-06 11:58:13,858   INFO  <All keys matched successfully>
2026-01-06 11:58:14,623   INFO  model initialized with 6770.32 M trainable parameters
2026-01-06 11:59:22,302   INFO  **********************Start logging**********************
2026-01-06 11:59:22,302   INFO  CUDA_VISIBLE_DEVICES=0
2026-01-06 11:59:22,302   INFO  data_dir         /data/wanghaoxuan/data
2026-01-06 11:59:22,302   INFO  cfg_file         configs/multi.yaml
2026-01-06 11:59:22,302   INFO  pretrained_model_name_or_path /data/wanghaoxuan/data/models/Vicuna-7B
2026-01-06 11:59:22,303   INFO  off_batch_task   False
2026-01-06 11:59:22,303   INFO  debug            False
2026-01-06 11:59:22,303   INFO  few_shot         None
2026-01-06 11:59:22,303   INFO  tour3d_nav_head  False
2026-01-06 11:59:22,303   INFO  seed             0
2026-01-06 11:59:22,303   INFO  num_epochs       30
2026-01-06 11:59:22,303   INFO  resume_from_checkpoint /data/wanghaoxuan/roomtour3d.pt
2026-01-06 11:59:22,303   INFO  from_scratch     False
2026-01-06 11:59:22,303   INFO  batch_size       4
2026-01-06 11:59:22,303   INFO  val_batch_size   2
2026-01-06 11:59:22,303   INFO  lr               1e-05
2026-01-06 11:59:22,303   INFO  feat_dropout     0.4
2026-01-06 11:59:22,303   INFO  num_warmup_steps 0
2026-01-06 11:59:22,303   INFO  num_steps_per_epoch -1
2026-01-06 11:59:22,303   INFO  gradient_accumulation_step 2
2026-01-06 11:59:22,303   INFO  precision        amp_bf16
2026-01-06 11:59:22,303   INFO  workers          0
2026-01-06 11:59:22,303   INFO  gpu              0
2026-01-06 11:59:22,303   INFO  world_size       1
2026-01-06 11:59:22,304   INFO  local_rank       0
2026-01-06 11:59:22,304   INFO  dist_url         env://
2026-01-06 11:59:22,304   INFO  dist_backend     nccl
2026-01-06 11:59:22,304   INFO  horovod          False
2026-01-06 11:59:22,304   INFO  no_set_device_rank False
2026-01-06 11:59:22,304   INFO  output_dir       build/eval
2026-01-06 11:59:22,304   INFO  max_saved_checkpoints 0
2026-01-06 11:59:22,304   INFO  save_ckpt_per_epochs 10
2026-01-06 11:59:22,304   INFO  save_latest_states False
2026-01-06 11:59:22,304   INFO  save_pred_results False
2026-01-06 11:59:22,304   INFO  save_detail_results False
2026-01-06 11:59:22,304   INFO  mode             test
2026-01-06 11:59:22,304   INFO  stage            multi
2026-01-06 11:59:22,304   INFO  ignoreid         -100
2026-01-06 11:59:22,304   INFO  enable_og        False
2026-01-06 11:59:22,304   INFO  enable_summarize False
2026-01-06 11:59:22,304   INFO  enable_fgr2r     False
2026-01-06 11:59:22,304   INFO  disable_nav      False
2026-01-06 11:59:22,304   INFO  gen_loss_coef    1.0
2026-01-06 11:59:22,304   INFO  obj_loss_coef    1.0
2026-01-06 11:59:22,305   INFO  teacher_forcing_coef 1.0
2026-01-06 11:59:22,305   INFO  fuse_obj         False
2026-01-06 11:59:22,305   INFO  use_lora         False
2026-01-06 11:59:22,305   INFO  lora_rank        8
2026-01-06 11:59:22,305   INFO  lora_alpha       16
2026-01-06 11:59:22,305   INFO  lora_dropout     0.05
2026-01-06 11:59:22,305   INFO  lora_target      None
2026-01-06 11:59:22,305   INFO  freeze_llama     False
2026-01-06 11:59:22,305   INFO  tune_token_emb   False
2026-01-06 11:59:22,305   INFO  no_loc_fts       False
2026-01-06 11:59:22,305   INFO  multi_endpoints  1
2026-01-06 11:59:22,305   INFO  path_type        trusted_path
2026-01-06 11:59:22,305   INFO  test_datasets    ['R2R']
2026-01-06 11:59:22,305   INFO  validation_split val_unseen
2026-01-06 11:59:22,305   INFO  do_sample        False
2026-01-06 11:59:22,305   INFO  temperature      1.0
2026-01-06 11:59:22,305   INFO  max_datapoints   None
2026-01-06 11:59:22,305   INFO  rank             0
2026-01-06 11:59:22,305   INFO  distributed      False
2026-01-06 11:59:22,306   INFO  device           cuda:0
2026-01-06 11:59:22,306   INFO  image_feat_size  1024
2026-01-06 11:59:22,306   INFO  obj_feat_size    768
2026-01-06 11:59:22,306   INFO  angle_feat_size  4
2026-01-06 11:59:22,306   INFO  enc_full_graph   True
2026-01-06 11:59:22,306   INFO  expert_policy    spl
2026-01-06 11:59:22,306   INFO  num_pano_layers  2
2026-01-06 11:59:22,306   INFO  ----------- Feature -----------
2026-01-06 11:59:22,306   INFO  cfg.Feature.object_feature_type: 
2026-01-06 11:59:22,306   INFO  cfg.Feature.angle_feat_size: 4
2026-01-06 11:59:22,306   INFO  cfg.Feature.max_objects: 70
2026-01-06 11:59:22,306   INFO  cfg.Feature.image_feat_size: 1024
2026-01-06 11:59:22,306   INFO  ----------- feature_database -----------
2026-01-06 11:59:22,306   INFO  cfg.Feature.feature_database.mp3d: eva_features/mp3d_EVA02-CLIP-L-14-336.hdf5
2026-01-06 11:59:22,306   INFO  cfg.Feature.feature_database.scan_qa: eva_features/scanqa_EVA02-CLIP-L-14-336.hdf5
2026-01-06 11:59:22,306   INFO  cfg.Feature.feature_database.room_tour: eva_features/web_obj_prog_p1_EVA02-CLIP-L-14-336.hdf5.bak
2026-01-06 11:59:22,306   INFO  cfg.Feature.feature_database.room3d_tour: eva_features/web_3d_obj_prog_crop_p1_EVA02-CLIP-L-14-336.hdf5
2026-01-06 11:59:22,306   INFO  cfg.Feature.feature_database.coco: eva_features/coco_EVA02-CLIP-L-14-336.hdf5
2026-01-06 11:59:22,306   INFO  cfg.Feature.obj_feat_size: 768
2026-01-06 11:59:22,306   INFO  ----------- object_database -----------
2026-01-06 11:59:22,307   INFO  cfg.Feature.object_database.reverie: obj_features/reverie_obj_feat
2026-01-06 11:59:22,307   INFO  cfg.Feature.object_database.soon: obj_features/soon_obj_feat
2026-01-06 11:59:22,307   INFO  ----------- Dataset -----------
2026-01-06 11:59:22,307   INFO  ----------- R2R -----------
2026-01-06 11:59:22,307   INFO  cfg.Dataset.R2R.DIR: R2R
2026-01-06 11:59:22,307   INFO  ----------- SPLIT -----------
2026-01-06 11:59:22,307   INFO  cfg.Dataset.R2R.SPLIT.train: FGR2R_train.json
2026-01-06 11:59:22,307   INFO  cfg.Dataset.R2R.SPLIT.val_seen: R2R_val_seen_enc.json
2026-01-06 11:59:22,307   INFO  cfg.Dataset.R2R.SPLIT.val_unseen: R2R_val_unseen_enc.json
2026-01-06 11:59:22,307   INFO  cfg.Dataset.R2R.SPLIT.test: R2R_test_enc.json
2026-01-06 11:59:22,307   INFO  ----------- REVERIE -----------
2026-01-06 11:59:22,307   INFO  cfg.Dataset.REVERIE.DIR: REVERIE
2026-01-06 11:59:22,307   INFO  cfg.Dataset.REVERIE.bbox_file: BBoxes.json
2026-01-06 11:59:22,307   INFO  ----------- SPLIT -----------
2026-01-06 11:59:22,307   INFO  cfg.Dataset.REVERIE.SPLIT.train: REVERIE_train_enc.json
2026-01-06 11:59:22,307   INFO  cfg.Dataset.REVERIE.SPLIT.val_seen: REVERIE_val_seen_enc.json
2026-01-06 11:59:22,307   INFO  cfg.Dataset.REVERIE.SPLIT.val_unseen: REVERIE_val_unseen_enc.json
2026-01-06 11:59:22,307   INFO  cfg.Dataset.REVERIE.SPLIT.test: REVERIE_test_enc.json
2026-01-06 11:59:22,307   INFO  ----------- CVDN -----------
2026-01-06 11:59:22,307   INFO  cfg.Dataset.CVDN.DIR: CVDN
2026-01-06 11:59:22,307   INFO  ----------- SPLIT -----------
2026-01-06 11:59:22,308   INFO  cfg.Dataset.CVDN.SPLIT.train: train.json
2026-01-06 11:59:22,308   INFO  cfg.Dataset.CVDN.SPLIT.val_seen: val_seen.json
2026-01-06 11:59:22,308   INFO  cfg.Dataset.CVDN.SPLIT.val_unseen: val_unseen.json
2026-01-06 11:59:22,308   INFO  cfg.Dataset.CVDN.SPLIT.test: test_cleaned.json
2026-01-06 11:59:22,308   INFO  ----------- SOON -----------
2026-01-06 11:59:22,308   INFO  cfg.Dataset.SOON.DIR: SOON
2026-01-06 11:59:22,308   INFO  ----------- SPLIT -----------
2026-01-06 11:59:22,308   INFO  cfg.Dataset.SOON.SPLIT.train: train_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 11:59:22,308   INFO  cfg.Dataset.SOON.SPLIT.val_seen: val_unseen_instrs_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 11:59:22,308   INFO  cfg.Dataset.SOON.SPLIT.val_unseen: val_unseen_house_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 11:59:22,308   INFO  cfg.Dataset.SOON.SPLIT.test: test_v2_enc.jsonl
2026-01-06 11:59:22,308   INFO  ----------- ScanQA -----------
2026-01-06 11:59:22,308   INFO  cfg.Dataset.ScanQA.DIR: ScanQA
2026-01-06 11:59:22,308   INFO  ----------- SPLIT -----------
2026-01-06 11:59:22,308   INFO  cfg.Dataset.ScanQA.SPLIT.train: ScanQA_v1.0_train_reformat.json
2026-01-06 11:59:22,308   INFO  cfg.Dataset.ScanQA.SPLIT.val_unseen: ScanQA_v1.0_val_reformat.json
2026-01-06 11:59:22,308   INFO  cfg.Dataset.ScanQA.SPLIT.test_wo_obj: ScanQA_v1.0_test_wo_obj_reformat.json
2026-01-06 11:59:22,308   INFO  cfg.Dataset.ScanQA.SPLIT.test_w_obj: ScanQA_v1.0_test_w_obj_reformat.json
2026-01-06 11:59:22,308   INFO  ----------- RoomTour -----------
2026-01-06 11:59:22,308   INFO  cfg.Dataset.RoomTour.DIR: RoomTour
2026-01-06 11:59:22,309   INFO  ----------- SPLIT -----------
2026-01-06 11:59:22,309   INFO  cfg.Dataset.RoomTour.SPLIT.train: p1_train_reformat.json
2026-01-06 11:59:22,309   INFO  ----------- Tour3D -----------
2026-01-06 11:59:22,309   INFO  cfg.Dataset.Tour3D.DIR: RoomTour
2026-01-06 11:59:22,309   INFO  ----------- SPLIT -----------
2026-01-06 11:59:22,309   INFO  cfg.Dataset.Tour3D.SPLIT.train: p1_train_colmap_trajectory_tour3d.json
2026-01-06 11:59:22,309   INFO  ----------- EQA -----------
2026-01-06 11:59:22,309   INFO  cfg.Dataset.EQA.DIR: EQA_MP3D
2026-01-06 11:59:22,309   INFO  ----------- SPLIT -----------
2026-01-06 11:59:22,309   INFO  cfg.Dataset.EQA.SPLIT.val_unseen: eqa_val_enc.json
2026-01-06 11:59:22,309   INFO  cfg.Dataset.EQA.ANSWER_VOCAB: eqa_answer_vocab.json
2026-01-06 11:59:22,309   INFO  ----------- R2R_AUG -----------
2026-01-06 11:59:22,309   INFO  cfg.Dataset.R2R_AUG.DIR: R2R
2026-01-06 11:59:22,309   INFO  ----------- SPLIT -----------
2026-01-06 11:59:22,309   INFO  cfg.Dataset.R2R_AUG.SPLIT.train: R2R_prevalent_aug_train_enc.jsonl
2026-01-06 11:59:22,309   INFO  ----------- REVERIE_AUG -----------
2026-01-06 11:59:22,309   INFO  cfg.Dataset.REVERIE_AUG.DIR: REVERIE
2026-01-06 11:59:22,309   INFO  cfg.Dataset.REVERIE_AUG.bbox_file: BBoxes.json
2026-01-06 11:59:22,309   INFO  ----------- SPLIT -----------
2026-01-06 11:59:22,310   INFO  cfg.Dataset.REVERIE_AUG.SPLIT.train: REVERIE_speaker_aug_enc.jsonl
2026-01-06 11:59:22,310   INFO  ----------- LLaVA -----------
2026-01-06 11:59:22,310   INFO  cfg.Dataset.LLaVA.DIR: LLaVA
2026-01-06 11:59:22,310   INFO  ----------- SPLIT -----------
2026-01-06 11:59:22,310   INFO  cfg.Dataset.LLaVA.SPLIT.train: detail_23k.json
2026-01-06 11:59:22,310   INFO  ----------- Pretrain -----------
2026-01-06 11:59:22,310   INFO  cfg.Pretrain.SOURCE: ['Tour3D', 'RoomTour', 'ScanQA', 'LLaVA']
2026-01-06 11:59:22,310   INFO  cfg.Pretrain.Ratio: [10, 20, 5, 2]
2026-01-06 11:59:22,310   INFO  ----------- LOSS_COEF -----------
2026-01-06 11:59:22,310   INFO  cfg.Pretrain.LOSS_COEF.R2R_AUG: 1
2026-01-06 11:59:22,310   INFO  cfg.Pretrain.LOSS_COEF.REVERIE_AUG: 1
2026-01-06 11:59:22,310   INFO  ----------- Multi -----------
2026-01-06 11:59:22,310   INFO  cfg.Multi.SOURCE: ['Tour3D', 'R2R', 'REVERIE', 'CVDN', 'SOON', 'ScanQA', 'LLaVA']
2026-01-06 11:59:22,310   INFO  cfg.Multi.Ratio: [10, 20, 5, 1, 5, 5, 5]
2026-01-06 11:59:22,310   INFO  ----------- LOSS_COEF -----------
2026-01-06 11:59:22,310   INFO  ----------- Model -----------
2026-01-06 11:59:22,310   INFO  cfg.Model.num_l_layers: 9
2026-01-06 11:59:22,310   INFO  cfg.Model.num_pano_layers: 2
2026-01-06 11:59:22,310   INFO  cfg.Model.num_x_layers: 4
2026-01-06 11:59:22,310   INFO  cfg.Model.graph_sprels: True
2026-01-06 11:59:22,311   INFO  cfg.Model.fusion: dynamic
2026-01-06 11:59:22,311   INFO  cfg.Model.enc_full_graph: True
2026-01-06 11:59:22,311   INFO  cfg.Model.expert_policy: spl
2026-01-06 11:59:22,311   INFO  ----------- Optim -----------
2026-01-06 11:59:22,311   INFO  ----------- val_max_action_len -----------
2026-01-06 11:59:22,311   INFO  cfg.Optim.val_max_action_len.R2R: 15
2026-01-06 11:59:22,311   INFO  cfg.Optim.val_max_action_len.REVERIE: 15
2026-01-06 11:59:22,311   INFO  cfg.Optim.val_max_action_len.CVDN: 30
2026-01-06 11:59:22,311   INFO  cfg.Optim.val_max_action_len.SOON: 20
2026-01-06 11:59:22,311   INFO  cfg.Optim.val_max_action_len.EQA: 15
2026-01-06 11:59:22,311   INFO  ----------- train_max_action_len -----------
2026-01-06 11:59:22,311   INFO  cfg.Optim.train_max_action_len.R2R: 15
2026-01-06 11:59:22,311   INFO  cfg.Optim.train_max_action_len.Tour3D: 15
2026-01-06 11:59:22,311   INFO  cfg.Optim.train_max_action_len.REVERIE: 15
2026-01-06 11:59:22,311   INFO  cfg.Optim.train_max_action_len.CVDN: 15
2026-01-06 11:59:22,311   INFO  cfg.Optim.train_max_action_len.SOON: 15
2026-01-06 11:59:22,311   INFO  cfg.Optim.train_max_action_len.EQA: 15
2026-01-06 11:59:22,311   INFO  cfg.Optim.train_max_action_len.R2R_AUG: 15
2026-01-06 11:59:22,311   INFO  cfg.Optim.train_max_action_len.REVERIE_AUG: 15
2026-01-06 11:59:24,396   INFO  [INFO] R2RDataset loaded with 2349 instructions, using splits: val_unseen
2026-01-06 11:59:24,397   INFO  
- Dataset: load 2349 R2R samples
- Dataset: load val_unseen split: 2349 samples in total
- Dataset: load val_unseen split: 11 scans in total
2026-01-06 11:59:24,397   INFO  R2R: 2349 samples loaded
2026-01-06 11:59:24,469   INFO  Initialize the model from config.
2026-01-06 12:00:50,839   INFO  model type: torch.bfloat16
2026-01-06 12:00:50,841   INFO  Trainable params: lang_model.model.embed_tokens.weight,lang_model.model.layers.0.self_attn.q_proj.weight,lang_model.model.layers.0.self_attn.k_proj.weight,lang_model.model.layers.0.self_attn.v_proj.weight,lang_model.model.layers.0.self_attn.o_proj.weight,lang_model.model.layers.0.mlp.gate_proj.weight,lang_model.model.layers.0.mlp.down_proj.weight,lang_model.model.layers.0.mlp.up_proj.weight,lang_model.model.layers.0.input_layernorm.weight,lang_model.model.layers.0.post_attention_layernorm.weight,lang_model.model.layers.1.self_attn.q_proj.weight,lang_model.model.layers.1.self_attn.k_proj.weight,lang_model.model.layers.1.self_attn.v_proj.weight,lang_model.model.layers.1.self_attn.o_proj.weight,lang_model.model.layers.1.mlp.gate_proj.weight,lang_model.model.layers.1.mlp.down_proj.weight,lang_model.model.layers.1.mlp.up_proj.weight,lang_model.model.layers.1.input_layernorm.weight,lang_model.model.layers.1.post_attention_layernorm.weight,lang_model.model.layers.2.self_attn.q_proj.weight,lang_model.model.layers.2.self_attn.k_proj.weight,lang_model.model.layers.2.self_attn.v_proj.weight,lang_model.model.layers.2.self_attn.o_proj.weight,lang_model.model.layers.2.mlp.gate_proj.weight,lang_model.model.layers.2.mlp.down_proj.weight,lang_model.model.layers.2.mlp.up_proj.weight,lang_model.model.layers.2.input_layernorm.weight,lang_model.model.layers.2.post_attention_layernorm.weight,lang_model.model.layers.3.self_attn.q_proj.weight,lang_model.model.layers.3.self_attn.k_proj.weight,lang_model.model.layers.3.self_attn.v_proj.weight,lang_model.model.layers.3.self_attn.o_proj.weight,lang_model.model.layers.3.mlp.gate_proj.weight,lang_model.model.layers.3.mlp.down_proj.weight,lang_model.model.layers.3.mlp.up_proj.weight,lang_model.model.layers.3.input_layernorm.weight,lang_model.model.layers.3.post_attention_layernorm.weight,lang_model.model.layers.4.self_attn.q_proj.weight,lang_model.model.layers.4.self_attn.k_proj.weight,lang_model.model.layers.4.self_attn.v_proj.weight,lang_model.model.layers.4.self_attn.o_proj.weight,lang_model.model.layers.4.mlp.gate_proj.weight,lang_model.model.layers.4.mlp.down_proj.weight,lang_model.model.layers.4.mlp.up_proj.weight,lang_model.model.layers.4.input_layernorm.weight,lang_model.model.layers.4.post_attention_layernorm.weight,lang_model.model.layers.5.self_attn.q_proj.weight,lang_model.model.layers.5.self_attn.k_proj.weight,lang_model.model.layers.5.self_attn.v_proj.weight,lang_model.model.layers.5.self_attn.o_proj.weight,lang_model.model.layers.5.mlp.gate_proj.weight,lang_model.model.layers.5.mlp.down_proj.weight,lang_model.model.layers.5.mlp.up_proj.weight,lang_model.model.layers.5.input_layernorm.weight,lang_model.model.layers.5.post_attention_layernorm.weight,lang_model.model.layers.6.self_attn.q_proj.weight,lang_model.model.layers.6.self_attn.k_proj.weight,lang_model.model.layers.6.self_attn.v_proj.weight,lang_model.model.layers.6.self_attn.o_proj.weight,lang_model.model.layers.6.mlp.gate_proj.weight,lang_model.model.layers.6.mlp.down_proj.weight,lang_model.model.layers.6.mlp.up_proj.weight,lang_model.model.layers.6.input_layernorm.weight,lang_model.model.layers.6.post_attention_layernorm.weight,lang_model.model.layers.7.self_attn.q_proj.weight,lang_model.model.layers.7.self_attn.k_proj.weight,lang_model.model.layers.7.self_attn.v_proj.weight,lang_model.model.layers.7.self_attn.o_proj.weight,lang_model.model.layers.7.mlp.gate_proj.weight,lang_model.model.layers.7.mlp.down_proj.weight,lang_model.model.layers.7.mlp.up_proj.weight,lang_model.model.layers.7.input_layernorm.weight,lang_model.model.layers.7.post_attention_layernorm.weight,lang_model.model.layers.8.self_attn.q_proj.weight,lang_model.model.layers.8.self_attn.k_proj.weight,lang_model.model.layers.8.self_attn.v_proj.weight,lang_model.model.layers.8.self_attn.o_proj.weight,lang_model.model.layers.8.mlp.gate_proj.weight,lang_model.model.layers.8.mlp.down_proj.weight,lang_model.model.layers.8.mlp.up_proj.weight,lang_model.model.layers.8.input_layernorm.weight,lang_model.model.layers.8.post_attention_layernorm.weight,lang_model.model.layers.9.self_attn.q_proj.weight,lang_model.model.layers.9.self_attn.k_proj.weight,lang_model.model.layers.9.self_attn.v_proj.weight,lang_model.model.layers.9.self_attn.o_proj.weight,lang_model.model.layers.9.mlp.gate_proj.weight,lang_model.model.layers.9.mlp.down_proj.weight,lang_model.model.layers.9.mlp.up_proj.weight,lang_model.model.layers.9.input_layernorm.weight,lang_model.model.layers.9.post_attention_layernorm.weight,lang_model.model.layers.10.self_attn.q_proj.weight,lang_model.model.layers.10.self_attn.k_proj.weight,lang_model.model.layers.10.self_attn.v_proj.weight,lang_model.model.layers.10.self_attn.o_proj.weight,lang_model.model.layers.10.mlp.gate_proj.weight,lang_model.model.layers.10.mlp.down_proj.weight,lang_model.model.layers.10.mlp.up_proj.weight,lang_model.model.layers.10.input_layernorm.weight,lang_model.model.layers.10.post_attention_layernorm.weight,lang_model.model.layers.11.self_attn.q_proj.weight,lang_model.model.layers.11.self_attn.k_proj.weight,lang_model.model.layers.11.self_attn.v_proj.weight,lang_model.model.layers.11.self_attn.o_proj.weight,lang_model.model.layers.11.mlp.gate_proj.weight,lang_model.model.layers.11.mlp.down_proj.weight,lang_model.model.layers.11.mlp.up_proj.weight,lang_model.model.layers.11.input_layernorm.weight,lang_model.model.layers.11.post_attention_layernorm.weight,lang_model.model.layers.12.self_attn.q_proj.weight,lang_model.model.layers.12.self_attn.k_proj.weight,lang_model.model.layers.12.self_attn.v_proj.weight,lang_model.model.layers.12.self_attn.o_proj.weight,lang_model.model.layers.12.mlp.gate_proj.weight,lang_model.model.layers.12.mlp.down_proj.weight,lang_model.model.layers.12.mlp.up_proj.weight,lang_model.model.layers.12.input_layernorm.weight,lang_model.model.layers.12.post_attention_layernorm.weight,lang_model.model.layers.13.self_attn.q_proj.weight,lang_model.model.layers.13.self_attn.k_proj.weight,lang_model.model.layers.13.self_attn.v_proj.weight,lang_model.model.layers.13.self_attn.o_proj.weight,lang_model.model.layers.13.mlp.gate_proj.weight,lang_model.model.layers.13.mlp.down_proj.weight,lang_model.model.layers.13.mlp.up_proj.weight,lang_model.model.layers.13.input_layernorm.weight,lang_model.model.layers.13.post_attention_layernorm.weight,lang_model.model.layers.14.self_attn.q_proj.weight,lang_model.model.layers.14.self_attn.k_proj.weight,lang_model.model.layers.14.self_attn.v_proj.weight,lang_model.model.layers.14.self_attn.o_proj.weight,lang_model.model.layers.14.mlp.gate_proj.weight,lang_model.model.layers.14.mlp.down_proj.weight,lang_model.model.layers.14.mlp.up_proj.weight,lang_model.model.layers.14.input_layernorm.weight,lang_model.model.layers.14.post_attention_layernorm.weight,lang_model.model.layers.15.self_attn.q_proj.weight,lang_model.model.layers.15.self_attn.k_proj.weight,lang_model.model.layers.15.self_attn.v_proj.weight,lang_model.model.layers.15.self_attn.o_proj.weight,lang_model.model.layers.15.mlp.gate_proj.weight,lang_model.model.layers.15.mlp.down_proj.weight,lang_model.model.layers.15.mlp.up_proj.weight,lang_model.model.layers.15.input_layernorm.weight,lang_model.model.layers.15.post_attention_layernorm.weight,lang_model.model.layers.16.self_attn.q_proj.weight,lang_model.model.layers.16.self_attn.k_proj.weight,lang_model.model.layers.16.self_attn.v_proj.weight,lang_model.model.layers.16.self_attn.o_proj.weight,lang_model.model.layers.16.mlp.gate_proj.weight,lang_model.model.layers.16.mlp.down_proj.weight,lang_model.model.layers.16.mlp.up_proj.weight,lang_model.model.layers.16.input_layernorm.weight,lang_model.model.layers.16.post_attention_layernorm.weight,lang_model.model.layers.17.self_attn.q_proj.weight,lang_model.model.layers.17.self_attn.k_proj.weight,lang_model.model.layers.17.self_attn.v_proj.weight,lang_model.model.layers.17.self_attn.o_proj.weight,lang_model.model.layers.17.mlp.gate_proj.weight,lang_model.model.layers.17.mlp.down_proj.weight,lang_model.model.layers.17.mlp.up_proj.weight,lang_model.model.layers.17.input_layernorm.weight,lang_model.model.layers.17.post_attention_layernorm.weight,lang_model.model.layers.18.self_attn.q_proj.weight,lang_model.model.layers.18.self_attn.k_proj.weight,lang_model.model.layers.18.self_attn.v_proj.weight,lang_model.model.layers.18.self_attn.o_proj.weight,lang_model.model.layers.18.mlp.gate_proj.weight,lang_model.model.layers.18.mlp.down_proj.weight,lang_model.model.layers.18.mlp.up_proj.weight,lang_model.model.layers.18.input_layernorm.weight,lang_model.model.layers.18.post_attention_layernorm.weight,lang_model.model.layers.19.self_attn.q_proj.weight,lang_model.model.layers.19.self_attn.k_proj.weight,lang_model.model.layers.19.self_attn.v_proj.weight,lang_model.model.layers.19.self_attn.o_proj.weight,lang_model.model.layers.19.mlp.gate_proj.weight,lang_model.model.layers.19.mlp.down_proj.weight,lang_model.model.layers.19.mlp.up_proj.weight,lang_model.model.layers.19.input_layernorm.weight,lang_model.model.layers.19.post_attention_layernorm.weight,lang_model.model.layers.20.self_attn.q_proj.weight,lang_model.model.layers.20.self_attn.k_proj.weight,lang_model.model.layers.20.self_attn.v_proj.weight,lang_model.model.layers.20.self_attn.o_proj.weight,lang_model.model.layers.20.mlp.gate_proj.weight,lang_model.model.layers.20.mlp.down_proj.weight,lang_model.model.layers.20.mlp.up_proj.weight,lang_model.model.layers.20.input_layernorm.weight,lang_model.model.layers.20.post_attention_layernorm.weight,lang_model.model.layers.21.self_attn.q_proj.weight,lang_model.model.layers.21.self_attn.k_proj.weight,lang_model.model.layers.21.self_attn.v_proj.weight,lang_model.model.layers.21.self_attn.o_proj.weight,lang_model.model.layers.21.mlp.gate_proj.weight,lang_model.model.layers.21.mlp.down_proj.weight,lang_model.model.layers.21.mlp.up_proj.weight,lang_model.model.layers.21.input_layernorm.weight,lang_model.model.layers.21.post_attention_layernorm.weight,lang_model.model.layers.22.self_attn.q_proj.weight,lang_model.model.layers.22.self_attn.k_proj.weight,lang_model.model.layers.22.self_attn.v_proj.weight,lang_model.model.layers.22.self_attn.o_proj.weight,lang_model.model.layers.22.mlp.gate_proj.weight,lang_model.model.layers.22.mlp.down_proj.weight,lang_model.model.layers.22.mlp.up_proj.weight,lang_model.model.layers.22.input_layernorm.weight,lang_model.model.layers.22.post_attention_layernorm.weight,lang_model.model.layers.23.self_attn.q_proj.weight,lang_model.model.layers.23.self_attn.k_proj.weight,lang_model.model.layers.23.self_attn.v_proj.weight,lang_model.model.layers.23.self_attn.o_proj.weight,lang_model.model.layers.23.mlp.gate_proj.weight,lang_model.model.layers.23.mlp.down_proj.weight,lang_model.model.layers.23.mlp.up_proj.weight,lang_model.model.layers.23.input_layernorm.weight,lang_model.model.layers.23.post_attention_layernorm.weight,lang_model.model.layers.24.self_attn.q_proj.weight,lang_model.model.layers.24.self_attn.k_proj.weight,lang_model.model.layers.24.self_attn.v_proj.weight,lang_model.model.layers.24.self_attn.o_proj.weight,lang_model.model.layers.24.mlp.gate_proj.weight,lang_model.model.layers.24.mlp.down_proj.weight,lang_model.model.layers.24.mlp.up_proj.weight,lang_model.model.layers.24.input_layernorm.weight,lang_model.model.layers.24.post_attention_layernorm.weight,lang_model.model.layers.25.self_attn.q_proj.weight,lang_model.model.layers.25.self_attn.k_proj.weight,lang_model.model.layers.25.self_attn.v_proj.weight,lang_model.model.layers.25.self_attn.o_proj.weight,lang_model.model.layers.25.mlp.gate_proj.weight,lang_model.model.layers.25.mlp.down_proj.weight,lang_model.model.layers.25.mlp.up_proj.weight,lang_model.model.layers.25.input_layernorm.weight,lang_model.model.layers.25.post_attention_layernorm.weight,lang_model.model.layers.26.self_attn.q_proj.weight,lang_model.model.layers.26.self_attn.k_proj.weight,lang_model.model.layers.26.self_attn.v_proj.weight,lang_model.model.layers.26.self_attn.o_proj.weight,lang_model.model.layers.26.mlp.gate_proj.weight,lang_model.model.layers.26.mlp.down_proj.weight,lang_model.model.layers.26.mlp.up_proj.weight,lang_model.model.layers.26.input_layernorm.weight,lang_model.model.layers.26.post_attention_layernorm.weight,lang_model.model.layers.27.self_attn.q_proj.weight,lang_model.model.layers.27.self_attn.k_proj.weight,lang_model.model.layers.27.self_attn.v_proj.weight,lang_model.model.layers.27.self_attn.o_proj.weight,lang_model.model.layers.27.mlp.gate_proj.weight,lang_model.model.layers.27.mlp.down_proj.weight,lang_model.model.layers.27.mlp.up_proj.weight,lang_model.model.layers.27.input_layernorm.weight,lang_model.model.layers.27.post_attention_layernorm.weight,lang_model.model.layers.28.self_attn.q_proj.weight,lang_model.model.layers.28.self_attn.k_proj.weight,lang_model.model.layers.28.self_attn.v_proj.weight,lang_model.model.layers.28.self_attn.o_proj.weight,lang_model.model.layers.28.mlp.gate_proj.weight,lang_model.model.layers.28.mlp.down_proj.weight,lang_model.model.layers.28.mlp.up_proj.weight,lang_model.model.layers.28.input_layernorm.weight,lang_model.model.layers.28.post_attention_layernorm.weight,lang_model.model.layers.29.self_attn.q_proj.weight,lang_model.model.layers.29.self_attn.k_proj.weight,lang_model.model.layers.29.self_attn.v_proj.weight,lang_model.model.layers.29.self_attn.o_proj.weight,lang_model.model.layers.29.mlp.gate_proj.weight,lang_model.model.layers.29.mlp.down_proj.weight,lang_model.model.layers.29.mlp.up_proj.weight,lang_model.model.layers.29.input_layernorm.weight,lang_model.model.layers.29.post_attention_layernorm.weight,lang_model.model.layers.30.self_attn.q_proj.weight,lang_model.model.layers.30.self_attn.k_proj.weight,lang_model.model.layers.30.self_attn.v_proj.weight,lang_model.model.layers.30.self_attn.o_proj.weight,lang_model.model.layers.30.mlp.gate_proj.weight,lang_model.model.layers.30.mlp.down_proj.weight,lang_model.model.layers.30.mlp.up_proj.weight,lang_model.model.layers.30.input_layernorm.weight,lang_model.model.layers.30.post_attention_layernorm.weight,lang_model.model.layers.31.self_attn.q_proj.weight,lang_model.model.layers.31.self_attn.k_proj.weight,lang_model.model.layers.31.self_attn.v_proj.weight,lang_model.model.layers.31.self_attn.o_proj.weight,lang_model.model.layers.31.mlp.gate_proj.weight,lang_model.model.layers.31.mlp.down_proj.weight,lang_model.model.layers.31.mlp.up_proj.weight,lang_model.model.layers.31.input_layernorm.weight,lang_model.model.layers.31.post_attention_layernorm.weight,lang_model.model.norm.weight,lang_model.lm_head.weight,img_embeddings.img_linear.weight,img_embeddings.img_linear.bias,img_embeddings.img_layer_norm.weight,img_embeddings.img_layer_norm.bias,img_embeddings.loc_linear.weight,img_embeddings.loc_linear.bias,img_embeddings.loc_layer_norm.weight,img_embeddings.loc_layer_norm.bias,img_embeddings.nav_type_embedding.weight,img_embeddings.layer_norm.weight,img_embeddings.layer_norm.bias,img_embeddings.pano_encoder.layers.0.self_attn.in_proj_weight,img_embeddings.pano_encoder.layers.0.self_attn.in_proj_bias,img_embeddings.pano_encoder.layers.0.self_attn.out_proj.weight,img_embeddings.pano_encoder.layers.0.self_attn.out_proj.bias,img_embeddings.pano_encoder.layers.0.linear1.weight,img_embeddings.pano_encoder.layers.0.linear1.bias,img_embeddings.pano_encoder.layers.0.linear2.weight,img_embeddings.pano_encoder.layers.0.linear2.bias,img_embeddings.pano_encoder.layers.0.norm1.weight,img_embeddings.pano_encoder.layers.0.norm1.bias,img_embeddings.pano_encoder.layers.0.norm2.weight,img_embeddings.pano_encoder.layers.0.norm2.bias,img_embeddings.pano_encoder.layers.1.self_attn.in_proj_weight,img_embeddings.pano_encoder.layers.1.self_attn.in_proj_bias,img_embeddings.pano_encoder.layers.1.self_attn.out_proj.weight,img_embeddings.pano_encoder.layers.1.self_attn.out_proj.bias,img_embeddings.pano_encoder.layers.1.linear1.weight,img_embeddings.pano_encoder.layers.1.linear1.bias,img_embeddings.pano_encoder.layers.1.linear2.weight,img_embeddings.pano_encoder.layers.1.linear2.bias,img_embeddings.pano_encoder.layers.1.norm1.weight,img_embeddings.pano_encoder.layers.1.norm1.bias,img_embeddings.pano_encoder.layers.1.norm2.weight,img_embeddings.pano_encoder.layers.1.norm2.bias,img_embeddings.pano_encoder.norm.weight,img_embeddings.pano_encoder.norm.bias,img_embeddings.mapper.weight,img_embeddings.mapper.bias,token_type_embeddings.weight,gmap_pos_embeddings.0.weight,gmap_pos_embeddings.0.bias,gmap_pos_embeddings.1.weight,gmap_pos_embeddings.1.bias,gmap_step_embeddings.weight,vp_pos_embeddings.0.weight,vp_pos_embeddings.0.bias,vp_pos_embeddings.1.weight,vp_pos_embeddings.1.bias,obj_pos_embeddings.0.weight,obj_pos_embeddings.0.bias,obj_pos_embeddings.1.weight,obj_pos_embeddings.1.bias,og_head.0.weight,og_head.0.bias,out_head.0.weight,out_head.0.bias
2026-01-06 12:00:50,842   INFO  *************** init model *************** 
2026-01-06 12:00:53,407   INFO  Loading checkpoint from /data/wanghaoxuan/roomtour3d.pt
2026-01-06 12:00:58,314   INFO  Ignore weight img_embeddings.obj_projector.0.weight: torch.Size([4096, 768])
2026-01-06 12:00:58,315   INFO  Ignore weight img_embeddings.obj_projector.0.bias: torch.Size([4096])
2026-01-06 12:00:58,315   INFO  Ignore weight img_embeddings.obj_projector.1.weight: torch.Size([4096])
2026-01-06 12:00:58,315   INFO  Ignore weight img_embeddings.obj_projector.1.bias: torch.Size([4096])
2026-01-06 12:00:59,339   INFO  <All keys matched successfully>
2026-01-06 12:00:59,879   INFO  model initialized with 6770.32 M trainable parameters
2026-01-06 12:00:59,880   INFO  Training with a single process
2026-01-06 12:00:59,880   INFO  **************************** Test ****************************
2026-01-06 12:00:59,882   INFO  ***** validate val_unseen split on R2R task *****
2026-01-06 12:19:28,000   INFO  eval 2349 predictions
2026-01-06 12:19:28,051   INFO  
[Eval] val_unseen epoch 0

 [Eval] dataset=[R2R] 
, action_steps: 5.70, steps: 6.18, lengths: 11.90, nav_error: 3.49, oracle_error: 1.93
[Eval] ||| sr: 68.41, oracle_sr: 76.76, spl: 61.17
2026-01-06 13:17:05,976   INFO  **********************Start logging**********************
2026-01-06 13:17:05,977   INFO  CUDA_VISIBLE_DEVICES=0
2026-01-06 13:17:05,977   INFO  data_dir         /data/wanghaoxuan/data
2026-01-06 13:17:05,977   INFO  cfg_file         configs/multi.yaml
2026-01-06 13:17:05,977   INFO  pretrained_model_name_or_path /data/wanghaoxuan/data/models/Vicuna-7B
2026-01-06 13:17:05,977   INFO  off_batch_task   False
2026-01-06 13:17:05,977   INFO  debug            False
2026-01-06 13:17:05,977   INFO  few_shot         None
2026-01-06 13:17:05,977   INFO  tour3d_nav_head  False
2026-01-06 13:17:05,977   INFO  seed             0
2026-01-06 13:17:05,977   INFO  num_epochs       30
2026-01-06 13:17:05,977   INFO  resume_from_checkpoint /data/wanghaoxuan/roomtour3d.pt
2026-01-06 13:17:05,977   INFO  from_scratch     False
2026-01-06 13:17:05,977   INFO  batch_size       4
2026-01-06 13:17:05,977   INFO  val_batch_size   2
2026-01-06 13:17:05,977   INFO  lr               1e-05
2026-01-06 13:17:05,977   INFO  feat_dropout     0.4
2026-01-06 13:17:05,977   INFO  num_warmup_steps 0
2026-01-06 13:17:05,978   INFO  num_steps_per_epoch -1
2026-01-06 13:17:05,978   INFO  gradient_accumulation_step 2
2026-01-06 13:17:05,978   INFO  precision        amp_bf16
2026-01-06 13:17:05,978   INFO  workers          0
2026-01-06 13:17:05,978   INFO  gpu              0
2026-01-06 13:17:05,978   INFO  world_size       1
2026-01-06 13:17:05,978   INFO  local_rank       0
2026-01-06 13:17:05,978   INFO  dist_url         env://
2026-01-06 13:17:05,978   INFO  dist_backend     nccl
2026-01-06 13:17:05,978   INFO  horovod          False
2026-01-06 13:17:05,978   INFO  no_set_device_rank False
2026-01-06 13:17:05,978   INFO  output_dir       build/eval
2026-01-06 13:17:05,978   INFO  max_saved_checkpoints 0
2026-01-06 13:17:05,978   INFO  save_ckpt_per_epochs 10
2026-01-06 13:17:05,978   INFO  save_latest_states False
2026-01-06 13:17:05,978   INFO  save_pred_results False
2026-01-06 13:17:05,978   INFO  save_detail_results False
2026-01-06 13:17:05,978   INFO  mode             test
2026-01-06 13:17:05,979   INFO  stage            multi
2026-01-06 13:17:05,979   INFO  ignoreid         -100
2026-01-06 13:17:05,979   INFO  enable_og        True
2026-01-06 13:17:05,979   INFO  enable_summarize False
2026-01-06 13:17:05,979   INFO  enable_fgr2r     False
2026-01-06 13:17:05,979   INFO  disable_nav      False
2026-01-06 13:17:05,979   INFO  gen_loss_coef    1.0
2026-01-06 13:17:05,979   INFO  obj_loss_coef    1.0
2026-01-06 13:17:05,979   INFO  teacher_forcing_coef 1.0
2026-01-06 13:17:05,979   INFO  fuse_obj         False
2026-01-06 13:17:05,979   INFO  use_lora         False
2026-01-06 13:17:05,979   INFO  lora_rank        8
2026-01-06 13:17:05,979   INFO  lora_alpha       16
2026-01-06 13:17:05,979   INFO  lora_dropout     0.05
2026-01-06 13:17:05,979   INFO  lora_target      None
2026-01-06 13:17:05,979   INFO  freeze_llama     False
2026-01-06 13:17:05,979   INFO  tune_token_emb   False
2026-01-06 13:17:05,979   INFO  no_loc_fts       False
2026-01-06 13:17:05,980   INFO  multi_endpoints  1
2026-01-06 13:17:05,980   INFO  path_type        trusted_path
2026-01-06 13:17:05,980   INFO  test_datasets    ['REVERIE']
2026-01-06 13:17:05,980   INFO  validation_split val_unseen
2026-01-06 13:17:05,980   INFO  do_sample        True
2026-01-06 13:17:05,980   INFO  temperature      0.01
2026-01-06 13:17:05,980   INFO  max_datapoints   None
2026-01-06 13:17:05,980   INFO  rank             0
2026-01-06 13:17:05,980   INFO  distributed      False
2026-01-06 13:17:05,980   INFO  device           cuda:0
2026-01-06 13:17:05,980   INFO  image_feat_size  1024
2026-01-06 13:17:05,980   INFO  obj_feat_size    768
2026-01-06 13:17:05,980   INFO  angle_feat_size  4
2026-01-06 13:17:05,980   INFO  enc_full_graph   True
2026-01-06 13:17:05,980   INFO  expert_policy    spl
2026-01-06 13:17:05,980   INFO  num_pano_layers  2
2026-01-06 13:17:05,980   INFO  ----------- Feature -----------
2026-01-06 13:17:05,980   INFO  cfg.Feature.object_feature_type: 
2026-01-06 13:17:05,980   INFO  cfg.Feature.angle_feat_size: 4
2026-01-06 13:17:05,981   INFO  cfg.Feature.max_objects: 70
2026-01-06 13:17:05,981   INFO  cfg.Feature.image_feat_size: 1024
2026-01-06 13:17:05,981   INFO  ----------- feature_database -----------
2026-01-06 13:17:05,981   INFO  cfg.Feature.feature_database.mp3d: eva_features/mp3d_EVA02-CLIP-L-14-336.hdf5
2026-01-06 13:17:05,981   INFO  cfg.Feature.feature_database.scan_qa: eva_features/scanqa_EVA02-CLIP-L-14-336.hdf5
2026-01-06 13:17:05,981   INFO  cfg.Feature.feature_database.room_tour: eva_features/web_obj_prog_p1_EVA02-CLIP-L-14-336.hdf5.bak
2026-01-06 13:17:05,981   INFO  cfg.Feature.feature_database.room3d_tour: eva_features/web_3d_obj_prog_crop_p1_EVA02-CLIP-L-14-336.hdf5
2026-01-06 13:17:05,981   INFO  cfg.Feature.feature_database.coco: eva_features/coco_EVA02-CLIP-L-14-336.hdf5
2026-01-06 13:17:05,981   INFO  cfg.Feature.obj_feat_size: 768
2026-01-06 13:17:05,981   INFO  ----------- object_database -----------
2026-01-06 13:17:05,981   INFO  cfg.Feature.object_database.reverie: obj_features/reverie_obj_feat
2026-01-06 13:17:05,981   INFO  cfg.Feature.object_database.soon: obj_features/soon_obj_feat
2026-01-06 13:17:05,981   INFO  ----------- Dataset -----------
2026-01-06 13:17:05,981   INFO  ----------- R2R -----------
2026-01-06 13:17:05,981   INFO  cfg.Dataset.R2R.DIR: R2R
2026-01-06 13:17:05,981   INFO  ----------- SPLIT -----------
2026-01-06 13:17:05,981   INFO  cfg.Dataset.R2R.SPLIT.train: FGR2R_train.json
2026-01-06 13:17:05,981   INFO  cfg.Dataset.R2R.SPLIT.val_seen: R2R_val_seen_enc.json
2026-01-06 13:17:05,982   INFO  cfg.Dataset.R2R.SPLIT.val_unseen: R2R_val_unseen_enc.json
2026-01-06 13:17:05,982   INFO  cfg.Dataset.R2R.SPLIT.test: R2R_test_enc.json
2026-01-06 13:17:05,982   INFO  ----------- REVERIE -----------
2026-01-06 13:17:05,982   INFO  cfg.Dataset.REVERIE.DIR: REVERIE
2026-01-06 13:17:05,982   INFO  cfg.Dataset.REVERIE.bbox_file: BBoxes.json
2026-01-06 13:17:05,982   INFO  ----------- SPLIT -----------
2026-01-06 13:17:05,982   INFO  cfg.Dataset.REVERIE.SPLIT.train: REVERIE_train_enc.json
2026-01-06 13:17:05,982   INFO  cfg.Dataset.REVERIE.SPLIT.val_seen: REVERIE_val_seen_enc.json
2026-01-06 13:17:05,982   INFO  cfg.Dataset.REVERIE.SPLIT.val_unseen: REVERIE_val_unseen_enc.json
2026-01-06 13:17:05,982   INFO  cfg.Dataset.REVERIE.SPLIT.test: REVERIE_test_enc.json
2026-01-06 13:17:05,982   INFO  ----------- CVDN -----------
2026-01-06 13:17:05,982   INFO  cfg.Dataset.CVDN.DIR: CVDN
2026-01-06 13:17:05,982   INFO  ----------- SPLIT -----------
2026-01-06 13:17:05,982   INFO  cfg.Dataset.CVDN.SPLIT.train: train.json
2026-01-06 13:17:05,982   INFO  cfg.Dataset.CVDN.SPLIT.val_seen: val_seen.json
2026-01-06 13:17:05,982   INFO  cfg.Dataset.CVDN.SPLIT.val_unseen: val_unseen.json
2026-01-06 13:17:05,982   INFO  cfg.Dataset.CVDN.SPLIT.test: test_cleaned.json
2026-01-06 13:17:05,982   INFO  ----------- SOON -----------
2026-01-06 13:17:05,983   INFO  cfg.Dataset.SOON.DIR: SOON
2026-01-06 13:17:05,983   INFO  ----------- SPLIT -----------
2026-01-06 13:17:05,983   INFO  cfg.Dataset.SOON.SPLIT.train: train_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 13:17:05,983   INFO  cfg.Dataset.SOON.SPLIT.val_seen: val_unseen_instrs_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 13:17:05,983   INFO  cfg.Dataset.SOON.SPLIT.val_unseen: val_unseen_house_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 13:17:05,983   INFO  cfg.Dataset.SOON.SPLIT.test: test_v2_enc.jsonl
2026-01-06 13:17:05,983   INFO  ----------- ScanQA -----------
2026-01-06 13:17:05,983   INFO  cfg.Dataset.ScanQA.DIR: ScanQA
2026-01-06 13:17:05,983   INFO  ----------- SPLIT -----------
2026-01-06 13:17:05,983   INFO  cfg.Dataset.ScanQA.SPLIT.train: ScanQA_v1.0_train_reformat.json
2026-01-06 13:17:05,983   INFO  cfg.Dataset.ScanQA.SPLIT.val_unseen: ScanQA_v1.0_val_reformat.json
2026-01-06 13:17:05,983   INFO  cfg.Dataset.ScanQA.SPLIT.test_wo_obj: ScanQA_v1.0_test_wo_obj_reformat.json
2026-01-06 13:17:05,983   INFO  cfg.Dataset.ScanQA.SPLIT.test_w_obj: ScanQA_v1.0_test_w_obj_reformat.json
2026-01-06 13:17:05,983   INFO  ----------- RoomTour -----------
2026-01-06 13:17:05,983   INFO  cfg.Dataset.RoomTour.DIR: RoomTour
2026-01-06 13:17:05,983   INFO  ----------- SPLIT -----------
2026-01-06 13:17:05,983   INFO  cfg.Dataset.RoomTour.SPLIT.train: p1_train_reformat.json
2026-01-06 13:17:05,983   INFO  ----------- Tour3D -----------
2026-01-06 13:17:05,983   INFO  cfg.Dataset.Tour3D.DIR: RoomTour
2026-01-06 13:17:05,984   INFO  ----------- SPLIT -----------
2026-01-06 13:17:05,984   INFO  cfg.Dataset.Tour3D.SPLIT.train: p1_train_colmap_trajectory_tour3d.json
2026-01-06 13:17:05,984   INFO  ----------- EQA -----------
2026-01-06 13:17:05,984   INFO  cfg.Dataset.EQA.DIR: EQA_MP3D
2026-01-06 13:17:05,984   INFO  ----------- SPLIT -----------
2026-01-06 13:17:05,984   INFO  cfg.Dataset.EQA.SPLIT.val_unseen: eqa_val_enc.json
2026-01-06 13:17:05,984   INFO  cfg.Dataset.EQA.ANSWER_VOCAB: eqa_answer_vocab.json
2026-01-06 13:17:05,984   INFO  ----------- R2R_AUG -----------
2026-01-06 13:17:05,984   INFO  cfg.Dataset.R2R_AUG.DIR: R2R
2026-01-06 13:17:05,984   INFO  ----------- SPLIT -----------
2026-01-06 13:17:05,984   INFO  cfg.Dataset.R2R_AUG.SPLIT.train: R2R_prevalent_aug_train_enc.jsonl
2026-01-06 13:17:05,984   INFO  ----------- REVERIE_AUG -----------
2026-01-06 13:17:05,984   INFO  cfg.Dataset.REVERIE_AUG.DIR: REVERIE
2026-01-06 13:17:05,984   INFO  cfg.Dataset.REVERIE_AUG.bbox_file: BBoxes.json
2026-01-06 13:17:05,984   INFO  ----------- SPLIT -----------
2026-01-06 13:17:05,984   INFO  cfg.Dataset.REVERIE_AUG.SPLIT.train: REVERIE_speaker_aug_enc.jsonl
2026-01-06 13:17:05,984   INFO  ----------- LLaVA -----------
2026-01-06 13:17:05,984   INFO  cfg.Dataset.LLaVA.DIR: LLaVA
2026-01-06 13:17:05,985   INFO  ----------- SPLIT -----------
2026-01-06 13:17:05,985   INFO  cfg.Dataset.LLaVA.SPLIT.train: detail_23k.json
2026-01-06 13:17:05,985   INFO  ----------- Pretrain -----------
2026-01-06 13:17:05,985   INFO  cfg.Pretrain.SOURCE: ['Tour3D', 'RoomTour', 'ScanQA', 'LLaVA']
2026-01-06 13:17:05,985   INFO  cfg.Pretrain.Ratio: [10, 20, 5, 2]
2026-01-06 13:17:05,985   INFO  ----------- LOSS_COEF -----------
2026-01-06 13:17:05,985   INFO  cfg.Pretrain.LOSS_COEF.R2R_AUG: 1
2026-01-06 13:17:05,985   INFO  cfg.Pretrain.LOSS_COEF.REVERIE_AUG: 1
2026-01-06 13:17:05,985   INFO  ----------- Multi -----------
2026-01-06 13:17:05,985   INFO  cfg.Multi.SOURCE: ['Tour3D', 'R2R', 'REVERIE', 'CVDN', 'SOON', 'ScanQA', 'LLaVA']
2026-01-06 13:17:05,985   INFO  cfg.Multi.Ratio: [10, 20, 5, 1, 5, 5, 5]
2026-01-06 13:17:05,985   INFO  ----------- LOSS_COEF -----------
2026-01-06 13:17:05,985   INFO  ----------- Model -----------
2026-01-06 13:17:05,985   INFO  cfg.Model.num_l_layers: 9
2026-01-06 13:17:05,985   INFO  cfg.Model.num_pano_layers: 2
2026-01-06 13:17:05,985   INFO  cfg.Model.num_x_layers: 4
2026-01-06 13:17:05,985   INFO  cfg.Model.graph_sprels: True
2026-01-06 13:17:05,985   INFO  cfg.Model.fusion: dynamic
2026-01-06 13:17:05,985   INFO  cfg.Model.enc_full_graph: True
2026-01-06 13:17:05,986   INFO  cfg.Model.expert_policy: spl
2026-01-06 13:17:05,986   INFO  ----------- Optim -----------
2026-01-06 13:17:05,986   INFO  ----------- val_max_action_len -----------
2026-01-06 13:17:05,986   INFO  cfg.Optim.val_max_action_len.R2R: 15
2026-01-06 13:17:05,986   INFO  cfg.Optim.val_max_action_len.REVERIE: 15
2026-01-06 13:17:05,986   INFO  cfg.Optim.val_max_action_len.CVDN: 30
2026-01-06 13:17:05,986   INFO  cfg.Optim.val_max_action_len.SOON: 20
2026-01-06 13:17:05,986   INFO  cfg.Optim.val_max_action_len.EQA: 15
2026-01-06 13:17:05,986   INFO  ----------- train_max_action_len -----------
2026-01-06 13:17:05,986   INFO  cfg.Optim.train_max_action_len.R2R: 15
2026-01-06 13:17:05,986   INFO  cfg.Optim.train_max_action_len.Tour3D: 15
2026-01-06 13:17:05,986   INFO  cfg.Optim.train_max_action_len.REVERIE: 15
2026-01-06 13:17:05,986   INFO  cfg.Optim.train_max_action_len.CVDN: 15
2026-01-06 13:17:05,986   INFO  cfg.Optim.train_max_action_len.SOON: 15
2026-01-06 13:17:05,986   INFO  cfg.Optim.train_max_action_len.EQA: 15
2026-01-06 13:17:05,986   INFO  cfg.Optim.train_max_action_len.R2R_AUG: 15
2026-01-06 13:17:05,986   INFO  cfg.Optim.train_max_action_len.REVERIE_AUG: 15
2026-01-06 13:17:08,803   INFO  [INFO] REVERIEDataset loaded with 3521 instructions, using splits: val_unseen
2026-01-06 13:17:08,804   INFO  
- Dataset: load 3521 REVERIE samples
- Dataset: load val_unseen split: 3521 samples in total
- Dataset: load val_unseen split: 10 scans in total
2026-01-06 13:17:08,804   INFO  REVERIE: 3521 samples loaded
2026-01-06 13:17:08,916   INFO  Initialize the model from config.
2026-01-06 13:18:34,851   INFO  model type: torch.bfloat16
2026-01-06 13:18:34,853   INFO  Trainable params: lang_model.model.embed_tokens.weight,lang_model.model.layers.0.self_attn.q_proj.weight,lang_model.model.layers.0.self_attn.k_proj.weight,lang_model.model.layers.0.self_attn.v_proj.weight,lang_model.model.layers.0.self_attn.o_proj.weight,lang_model.model.layers.0.mlp.gate_proj.weight,lang_model.model.layers.0.mlp.down_proj.weight,lang_model.model.layers.0.mlp.up_proj.weight,lang_model.model.layers.0.input_layernorm.weight,lang_model.model.layers.0.post_attention_layernorm.weight,lang_model.model.layers.1.self_attn.q_proj.weight,lang_model.model.layers.1.self_attn.k_proj.weight,lang_model.model.layers.1.self_attn.v_proj.weight,lang_model.model.layers.1.self_attn.o_proj.weight,lang_model.model.layers.1.mlp.gate_proj.weight,lang_model.model.layers.1.mlp.down_proj.weight,lang_model.model.layers.1.mlp.up_proj.weight,lang_model.model.layers.1.input_layernorm.weight,lang_model.model.layers.1.post_attention_layernorm.weight,lang_model.model.layers.2.self_attn.q_proj.weight,lang_model.model.layers.2.self_attn.k_proj.weight,lang_model.model.layers.2.self_attn.v_proj.weight,lang_model.model.layers.2.self_attn.o_proj.weight,lang_model.model.layers.2.mlp.gate_proj.weight,lang_model.model.layers.2.mlp.down_proj.weight,lang_model.model.layers.2.mlp.up_proj.weight,lang_model.model.layers.2.input_layernorm.weight,lang_model.model.layers.2.post_attention_layernorm.weight,lang_model.model.layers.3.self_attn.q_proj.weight,lang_model.model.layers.3.self_attn.k_proj.weight,lang_model.model.layers.3.self_attn.v_proj.weight,lang_model.model.layers.3.self_attn.o_proj.weight,lang_model.model.layers.3.mlp.gate_proj.weight,lang_model.model.layers.3.mlp.down_proj.weight,lang_model.model.layers.3.mlp.up_proj.weight,lang_model.model.layers.3.input_layernorm.weight,lang_model.model.layers.3.post_attention_layernorm.weight,lang_model.model.layers.4.self_attn.q_proj.weight,lang_model.model.layers.4.self_attn.k_proj.weight,lang_model.model.layers.4.self_attn.v_proj.weight,lang_model.model.layers.4.self_attn.o_proj.weight,lang_model.model.layers.4.mlp.gate_proj.weight,lang_model.model.layers.4.mlp.down_proj.weight,lang_model.model.layers.4.mlp.up_proj.weight,lang_model.model.layers.4.input_layernorm.weight,lang_model.model.layers.4.post_attention_layernorm.weight,lang_model.model.layers.5.self_attn.q_proj.weight,lang_model.model.layers.5.self_attn.k_proj.weight,lang_model.model.layers.5.self_attn.v_proj.weight,lang_model.model.layers.5.self_attn.o_proj.weight,lang_model.model.layers.5.mlp.gate_proj.weight,lang_model.model.layers.5.mlp.down_proj.weight,lang_model.model.layers.5.mlp.up_proj.weight,lang_model.model.layers.5.input_layernorm.weight,lang_model.model.layers.5.post_attention_layernorm.weight,lang_model.model.layers.6.self_attn.q_proj.weight,lang_model.model.layers.6.self_attn.k_proj.weight,lang_model.model.layers.6.self_attn.v_proj.weight,lang_model.model.layers.6.self_attn.o_proj.weight,lang_model.model.layers.6.mlp.gate_proj.weight,lang_model.model.layers.6.mlp.down_proj.weight,lang_model.model.layers.6.mlp.up_proj.weight,lang_model.model.layers.6.input_layernorm.weight,lang_model.model.layers.6.post_attention_layernorm.weight,lang_model.model.layers.7.self_attn.q_proj.weight,lang_model.model.layers.7.self_attn.k_proj.weight,lang_model.model.layers.7.self_attn.v_proj.weight,lang_model.model.layers.7.self_attn.o_proj.weight,lang_model.model.layers.7.mlp.gate_proj.weight,lang_model.model.layers.7.mlp.down_proj.weight,lang_model.model.layers.7.mlp.up_proj.weight,lang_model.model.layers.7.input_layernorm.weight,lang_model.model.layers.7.post_attention_layernorm.weight,lang_model.model.layers.8.self_attn.q_proj.weight,lang_model.model.layers.8.self_attn.k_proj.weight,lang_model.model.layers.8.self_attn.v_proj.weight,lang_model.model.layers.8.self_attn.o_proj.weight,lang_model.model.layers.8.mlp.gate_proj.weight,lang_model.model.layers.8.mlp.down_proj.weight,lang_model.model.layers.8.mlp.up_proj.weight,lang_model.model.layers.8.input_layernorm.weight,lang_model.model.layers.8.post_attention_layernorm.weight,lang_model.model.layers.9.self_attn.q_proj.weight,lang_model.model.layers.9.self_attn.k_proj.weight,lang_model.model.layers.9.self_attn.v_proj.weight,lang_model.model.layers.9.self_attn.o_proj.weight,lang_model.model.layers.9.mlp.gate_proj.weight,lang_model.model.layers.9.mlp.down_proj.weight,lang_model.model.layers.9.mlp.up_proj.weight,lang_model.model.layers.9.input_layernorm.weight,lang_model.model.layers.9.post_attention_layernorm.weight,lang_model.model.layers.10.self_attn.q_proj.weight,lang_model.model.layers.10.self_attn.k_proj.weight,lang_model.model.layers.10.self_attn.v_proj.weight,lang_model.model.layers.10.self_attn.o_proj.weight,lang_model.model.layers.10.mlp.gate_proj.weight,lang_model.model.layers.10.mlp.down_proj.weight,lang_model.model.layers.10.mlp.up_proj.weight,lang_model.model.layers.10.input_layernorm.weight,lang_model.model.layers.10.post_attention_layernorm.weight,lang_model.model.layers.11.self_attn.q_proj.weight,lang_model.model.layers.11.self_attn.k_proj.weight,lang_model.model.layers.11.self_attn.v_proj.weight,lang_model.model.layers.11.self_attn.o_proj.weight,lang_model.model.layers.11.mlp.gate_proj.weight,lang_model.model.layers.11.mlp.down_proj.weight,lang_model.model.layers.11.mlp.up_proj.weight,lang_model.model.layers.11.input_layernorm.weight,lang_model.model.layers.11.post_attention_layernorm.weight,lang_model.model.layers.12.self_attn.q_proj.weight,lang_model.model.layers.12.self_attn.k_proj.weight,lang_model.model.layers.12.self_attn.v_proj.weight,lang_model.model.layers.12.self_attn.o_proj.weight,lang_model.model.layers.12.mlp.gate_proj.weight,lang_model.model.layers.12.mlp.down_proj.weight,lang_model.model.layers.12.mlp.up_proj.weight,lang_model.model.layers.12.input_layernorm.weight,lang_model.model.layers.12.post_attention_layernorm.weight,lang_model.model.layers.13.self_attn.q_proj.weight,lang_model.model.layers.13.self_attn.k_proj.weight,lang_model.model.layers.13.self_attn.v_proj.weight,lang_model.model.layers.13.self_attn.o_proj.weight,lang_model.model.layers.13.mlp.gate_proj.weight,lang_model.model.layers.13.mlp.down_proj.weight,lang_model.model.layers.13.mlp.up_proj.weight,lang_model.model.layers.13.input_layernorm.weight,lang_model.model.layers.13.post_attention_layernorm.weight,lang_model.model.layers.14.self_attn.q_proj.weight,lang_model.model.layers.14.self_attn.k_proj.weight,lang_model.model.layers.14.self_attn.v_proj.weight,lang_model.model.layers.14.self_attn.o_proj.weight,lang_model.model.layers.14.mlp.gate_proj.weight,lang_model.model.layers.14.mlp.down_proj.weight,lang_model.model.layers.14.mlp.up_proj.weight,lang_model.model.layers.14.input_layernorm.weight,lang_model.model.layers.14.post_attention_layernorm.weight,lang_model.model.layers.15.self_attn.q_proj.weight,lang_model.model.layers.15.self_attn.k_proj.weight,lang_model.model.layers.15.self_attn.v_proj.weight,lang_model.model.layers.15.self_attn.o_proj.weight,lang_model.model.layers.15.mlp.gate_proj.weight,lang_model.model.layers.15.mlp.down_proj.weight,lang_model.model.layers.15.mlp.up_proj.weight,lang_model.model.layers.15.input_layernorm.weight,lang_model.model.layers.15.post_attention_layernorm.weight,lang_model.model.layers.16.self_attn.q_proj.weight,lang_model.model.layers.16.self_attn.k_proj.weight,lang_model.model.layers.16.self_attn.v_proj.weight,lang_model.model.layers.16.self_attn.o_proj.weight,lang_model.model.layers.16.mlp.gate_proj.weight,lang_model.model.layers.16.mlp.down_proj.weight,lang_model.model.layers.16.mlp.up_proj.weight,lang_model.model.layers.16.input_layernorm.weight,lang_model.model.layers.16.post_attention_layernorm.weight,lang_model.model.layers.17.self_attn.q_proj.weight,lang_model.model.layers.17.self_attn.k_proj.weight,lang_model.model.layers.17.self_attn.v_proj.weight,lang_model.model.layers.17.self_attn.o_proj.weight,lang_model.model.layers.17.mlp.gate_proj.weight,lang_model.model.layers.17.mlp.down_proj.weight,lang_model.model.layers.17.mlp.up_proj.weight,lang_model.model.layers.17.input_layernorm.weight,lang_model.model.layers.17.post_attention_layernorm.weight,lang_model.model.layers.18.self_attn.q_proj.weight,lang_model.model.layers.18.self_attn.k_proj.weight,lang_model.model.layers.18.self_attn.v_proj.weight,lang_model.model.layers.18.self_attn.o_proj.weight,lang_model.model.layers.18.mlp.gate_proj.weight,lang_model.model.layers.18.mlp.down_proj.weight,lang_model.model.layers.18.mlp.up_proj.weight,lang_model.model.layers.18.input_layernorm.weight,lang_model.model.layers.18.post_attention_layernorm.weight,lang_model.model.layers.19.self_attn.q_proj.weight,lang_model.model.layers.19.self_attn.k_proj.weight,lang_model.model.layers.19.self_attn.v_proj.weight,lang_model.model.layers.19.self_attn.o_proj.weight,lang_model.model.layers.19.mlp.gate_proj.weight,lang_model.model.layers.19.mlp.down_proj.weight,lang_model.model.layers.19.mlp.up_proj.weight,lang_model.model.layers.19.input_layernorm.weight,lang_model.model.layers.19.post_attention_layernorm.weight,lang_model.model.layers.20.self_attn.q_proj.weight,lang_model.model.layers.20.self_attn.k_proj.weight,lang_model.model.layers.20.self_attn.v_proj.weight,lang_model.model.layers.20.self_attn.o_proj.weight,lang_model.model.layers.20.mlp.gate_proj.weight,lang_model.model.layers.20.mlp.down_proj.weight,lang_model.model.layers.20.mlp.up_proj.weight,lang_model.model.layers.20.input_layernorm.weight,lang_model.model.layers.20.post_attention_layernorm.weight,lang_model.model.layers.21.self_attn.q_proj.weight,lang_model.model.layers.21.self_attn.k_proj.weight,lang_model.model.layers.21.self_attn.v_proj.weight,lang_model.model.layers.21.self_attn.o_proj.weight,lang_model.model.layers.21.mlp.gate_proj.weight,lang_model.model.layers.21.mlp.down_proj.weight,lang_model.model.layers.21.mlp.up_proj.weight,lang_model.model.layers.21.input_layernorm.weight,lang_model.model.layers.21.post_attention_layernorm.weight,lang_model.model.layers.22.self_attn.q_proj.weight,lang_model.model.layers.22.self_attn.k_proj.weight,lang_model.model.layers.22.self_attn.v_proj.weight,lang_model.model.layers.22.self_attn.o_proj.weight,lang_model.model.layers.22.mlp.gate_proj.weight,lang_model.model.layers.22.mlp.down_proj.weight,lang_model.model.layers.22.mlp.up_proj.weight,lang_model.model.layers.22.input_layernorm.weight,lang_model.model.layers.22.post_attention_layernorm.weight,lang_model.model.layers.23.self_attn.q_proj.weight,lang_model.model.layers.23.self_attn.k_proj.weight,lang_model.model.layers.23.self_attn.v_proj.weight,lang_model.model.layers.23.self_attn.o_proj.weight,lang_model.model.layers.23.mlp.gate_proj.weight,lang_model.model.layers.23.mlp.down_proj.weight,lang_model.model.layers.23.mlp.up_proj.weight,lang_model.model.layers.23.input_layernorm.weight,lang_model.model.layers.23.post_attention_layernorm.weight,lang_model.model.layers.24.self_attn.q_proj.weight,lang_model.model.layers.24.self_attn.k_proj.weight,lang_model.model.layers.24.self_attn.v_proj.weight,lang_model.model.layers.24.self_attn.o_proj.weight,lang_model.model.layers.24.mlp.gate_proj.weight,lang_model.model.layers.24.mlp.down_proj.weight,lang_model.model.layers.24.mlp.up_proj.weight,lang_model.model.layers.24.input_layernorm.weight,lang_model.model.layers.24.post_attention_layernorm.weight,lang_model.model.layers.25.self_attn.q_proj.weight,lang_model.model.layers.25.self_attn.k_proj.weight,lang_model.model.layers.25.self_attn.v_proj.weight,lang_model.model.layers.25.self_attn.o_proj.weight,lang_model.model.layers.25.mlp.gate_proj.weight,lang_model.model.layers.25.mlp.down_proj.weight,lang_model.model.layers.25.mlp.up_proj.weight,lang_model.model.layers.25.input_layernorm.weight,lang_model.model.layers.25.post_attention_layernorm.weight,lang_model.model.layers.26.self_attn.q_proj.weight,lang_model.model.layers.26.self_attn.k_proj.weight,lang_model.model.layers.26.self_attn.v_proj.weight,lang_model.model.layers.26.self_attn.o_proj.weight,lang_model.model.layers.26.mlp.gate_proj.weight,lang_model.model.layers.26.mlp.down_proj.weight,lang_model.model.layers.26.mlp.up_proj.weight,lang_model.model.layers.26.input_layernorm.weight,lang_model.model.layers.26.post_attention_layernorm.weight,lang_model.model.layers.27.self_attn.q_proj.weight,lang_model.model.layers.27.self_attn.k_proj.weight,lang_model.model.layers.27.self_attn.v_proj.weight,lang_model.model.layers.27.self_attn.o_proj.weight,lang_model.model.layers.27.mlp.gate_proj.weight,lang_model.model.layers.27.mlp.down_proj.weight,lang_model.model.layers.27.mlp.up_proj.weight,lang_model.model.layers.27.input_layernorm.weight,lang_model.model.layers.27.post_attention_layernorm.weight,lang_model.model.layers.28.self_attn.q_proj.weight,lang_model.model.layers.28.self_attn.k_proj.weight,lang_model.model.layers.28.self_attn.v_proj.weight,lang_model.model.layers.28.self_attn.o_proj.weight,lang_model.model.layers.28.mlp.gate_proj.weight,lang_model.model.layers.28.mlp.down_proj.weight,lang_model.model.layers.28.mlp.up_proj.weight,lang_model.model.layers.28.input_layernorm.weight,lang_model.model.layers.28.post_attention_layernorm.weight,lang_model.model.layers.29.self_attn.q_proj.weight,lang_model.model.layers.29.self_attn.k_proj.weight,lang_model.model.layers.29.self_attn.v_proj.weight,lang_model.model.layers.29.self_attn.o_proj.weight,lang_model.model.layers.29.mlp.gate_proj.weight,lang_model.model.layers.29.mlp.down_proj.weight,lang_model.model.layers.29.mlp.up_proj.weight,lang_model.model.layers.29.input_layernorm.weight,lang_model.model.layers.29.post_attention_layernorm.weight,lang_model.model.layers.30.self_attn.q_proj.weight,lang_model.model.layers.30.self_attn.k_proj.weight,lang_model.model.layers.30.self_attn.v_proj.weight,lang_model.model.layers.30.self_attn.o_proj.weight,lang_model.model.layers.30.mlp.gate_proj.weight,lang_model.model.layers.30.mlp.down_proj.weight,lang_model.model.layers.30.mlp.up_proj.weight,lang_model.model.layers.30.input_layernorm.weight,lang_model.model.layers.30.post_attention_layernorm.weight,lang_model.model.layers.31.self_attn.q_proj.weight,lang_model.model.layers.31.self_attn.k_proj.weight,lang_model.model.layers.31.self_attn.v_proj.weight,lang_model.model.layers.31.self_attn.o_proj.weight,lang_model.model.layers.31.mlp.gate_proj.weight,lang_model.model.layers.31.mlp.down_proj.weight,lang_model.model.layers.31.mlp.up_proj.weight,lang_model.model.layers.31.input_layernorm.weight,lang_model.model.layers.31.post_attention_layernorm.weight,lang_model.model.norm.weight,lang_model.lm_head.weight,img_embeddings.img_linear.weight,img_embeddings.img_linear.bias,img_embeddings.img_layer_norm.weight,img_embeddings.img_layer_norm.bias,img_embeddings.loc_linear.weight,img_embeddings.loc_linear.bias,img_embeddings.loc_layer_norm.weight,img_embeddings.loc_layer_norm.bias,img_embeddings.obj_projector.0.weight,img_embeddings.obj_projector.0.bias,img_embeddings.obj_projector.1.weight,img_embeddings.obj_projector.1.bias,img_embeddings.nav_type_embedding.weight,img_embeddings.layer_norm.weight,img_embeddings.layer_norm.bias,img_embeddings.pano_encoder.layers.0.self_attn.in_proj_weight,img_embeddings.pano_encoder.layers.0.self_attn.in_proj_bias,img_embeddings.pano_encoder.layers.0.self_attn.out_proj.weight,img_embeddings.pano_encoder.layers.0.self_attn.out_proj.bias,img_embeddings.pano_encoder.layers.0.linear1.weight,img_embeddings.pano_encoder.layers.0.linear1.bias,img_embeddings.pano_encoder.layers.0.linear2.weight,img_embeddings.pano_encoder.layers.0.linear2.bias,img_embeddings.pano_encoder.layers.0.norm1.weight,img_embeddings.pano_encoder.layers.0.norm1.bias,img_embeddings.pano_encoder.layers.0.norm2.weight,img_embeddings.pano_encoder.layers.0.norm2.bias,img_embeddings.pano_encoder.layers.1.self_attn.in_proj_weight,img_embeddings.pano_encoder.layers.1.self_attn.in_proj_bias,img_embeddings.pano_encoder.layers.1.self_attn.out_proj.weight,img_embeddings.pano_encoder.layers.1.self_attn.out_proj.bias,img_embeddings.pano_encoder.layers.1.linear1.weight,img_embeddings.pano_encoder.layers.1.linear1.bias,img_embeddings.pano_encoder.layers.1.linear2.weight,img_embeddings.pano_encoder.layers.1.linear2.bias,img_embeddings.pano_encoder.layers.1.norm1.weight,img_embeddings.pano_encoder.layers.1.norm1.bias,img_embeddings.pano_encoder.layers.1.norm2.weight,img_embeddings.pano_encoder.layers.1.norm2.bias,img_embeddings.pano_encoder.norm.weight,img_embeddings.pano_encoder.norm.bias,img_embeddings.mapper.weight,img_embeddings.mapper.bias,token_type_embeddings.weight,gmap_pos_embeddings.0.weight,gmap_pos_embeddings.0.bias,gmap_pos_embeddings.1.weight,gmap_pos_embeddings.1.bias,gmap_step_embeddings.weight,vp_pos_embeddings.0.weight,vp_pos_embeddings.0.bias,vp_pos_embeddings.1.weight,vp_pos_embeddings.1.bias,obj_pos_embeddings.0.weight,obj_pos_embeddings.0.bias,obj_pos_embeddings.1.weight,obj_pos_embeddings.1.bias,og_head.0.weight,og_head.0.bias,out_head.0.weight,out_head.0.bias
2026-01-06 13:18:34,853   INFO  *************** init model *************** 
2026-01-06 13:18:37,646   INFO  Loading checkpoint from /data/wanghaoxuan/roomtour3d.pt
2026-01-06 13:18:43,504   INFO  <All keys matched successfully>
2026-01-06 13:18:44,024   INFO  model initialized with 6773.48 M trainable parameters
2026-01-06 13:18:44,025   INFO  Training with a single process
2026-01-06 13:18:44,025   INFO  **************************** Test ****************************
2026-01-06 13:18:44,027   INFO  ***** validate val_unseen split on REVERIE task *****
2026-01-06 13:51:05,658   INFO  eval 3521 predictions
2026-01-06 13:51:05,762   INFO  
[Eval] val_unseen epoch 0

 [Eval] dataset=[REVERIE] 
, action_steps: 6.18, steps: 7.29, lengths: 13.89, nav_error: 5.66, oracle_error: 3.06
[Eval] ||| sr: 44.16, oracle_sr: 49.87, spl: 37.94, rgs: 10.08, rgspl: 8.43
2026-01-06 14:01:33,901   INFO  **********************Start logging**********************
2026-01-06 14:01:33,901   INFO  CUDA_VISIBLE_DEVICES=0
2026-01-06 14:01:33,901   INFO  data_dir         /data/wanghaoxuan/data
2026-01-06 14:01:33,901   INFO  cfg_file         configs/multi.yaml
2026-01-06 14:01:33,901   INFO  pretrained_model_name_or_path /data/wanghaoxuan/data/models/Vicuna-7B
2026-01-06 14:01:33,901   INFO  off_batch_task   False
2026-01-06 14:01:33,901   INFO  debug            False
2026-01-06 14:01:33,902   INFO  few_shot         None
2026-01-06 14:01:33,902   INFO  tour3d_nav_head  False
2026-01-06 14:01:33,902   INFO  seed             0
2026-01-06 14:01:33,902   INFO  num_epochs       30
2026-01-06 14:01:33,902   INFO  resume_from_checkpoint /data/wanghaoxuan/roomtour3d.pt
2026-01-06 14:01:33,902   INFO  from_scratch     False
2026-01-06 14:01:33,902   INFO  batch_size       4
2026-01-06 14:01:33,902   INFO  val_batch_size   2
2026-01-06 14:01:33,902   INFO  lr               1e-05
2026-01-06 14:01:33,902   INFO  feat_dropout     0.4
2026-01-06 14:01:33,902   INFO  num_warmup_steps 0
2026-01-06 14:01:33,902   INFO  num_steps_per_epoch -1
2026-01-06 14:01:33,902   INFO  gradient_accumulation_step 2
2026-01-06 14:01:33,902   INFO  precision        amp_bf16
2026-01-06 14:01:33,902   INFO  workers          0
2026-01-06 14:01:33,902   INFO  gpu              0
2026-01-06 14:01:33,902   INFO  world_size       1
2026-01-06 14:01:33,902   INFO  local_rank       0
2026-01-06 14:01:33,902   INFO  dist_url         env://
2026-01-06 14:01:33,903   INFO  dist_backend     nccl
2026-01-06 14:01:33,903   INFO  horovod          False
2026-01-06 14:01:33,903   INFO  no_set_device_rank False
2026-01-06 14:01:33,903   INFO  output_dir       build/eval
2026-01-06 14:01:33,903   INFO  max_saved_checkpoints 0
2026-01-06 14:01:33,903   INFO  save_ckpt_per_epochs 10
2026-01-06 14:01:33,903   INFO  save_latest_states False
2026-01-06 14:01:33,903   INFO  save_pred_results False
2026-01-06 14:01:33,903   INFO  save_detail_results False
2026-01-06 14:01:33,903   INFO  mode             test
2026-01-06 14:01:33,903   INFO  stage            multi
2026-01-06 14:01:33,903   INFO  ignoreid         -100
2026-01-06 14:01:33,903   INFO  enable_og        True
2026-01-06 14:01:33,903   INFO  enable_summarize False
2026-01-06 14:01:33,903   INFO  enable_fgr2r     False
2026-01-06 14:01:33,903   INFO  disable_nav      False
2026-01-06 14:01:33,903   INFO  gen_loss_coef    1.0
2026-01-06 14:01:33,903   INFO  obj_loss_coef    1.0
2026-01-06 14:01:33,903   INFO  teacher_forcing_coef 1.0
2026-01-06 14:01:33,903   INFO  fuse_obj         False
2026-01-06 14:01:33,903   INFO  use_lora         False
2026-01-06 14:01:33,904   INFO  lora_rank        8
2026-01-06 14:01:33,904   INFO  lora_alpha       16
2026-01-06 14:01:33,904   INFO  lora_dropout     0.05
2026-01-06 14:01:33,904   INFO  lora_target      None
2026-01-06 14:01:33,904   INFO  freeze_llama     False
2026-01-06 14:01:33,904   INFO  tune_token_emb   False
2026-01-06 14:01:33,904   INFO  no_loc_fts       False
2026-01-06 14:01:33,904   INFO  multi_endpoints  1
2026-01-06 14:01:33,904   INFO  path_type        trusted_path
2026-01-06 14:01:33,904   INFO  test_datasets    ['SOON']
2026-01-06 14:01:33,904   INFO  validation_split val_unseen
2026-01-06 14:01:33,904   INFO  do_sample        True
2026-01-06 14:01:33,904   INFO  temperature      0.01
2026-01-06 14:01:33,904   INFO  max_datapoints   None
2026-01-06 14:01:33,904   INFO  rank             0
2026-01-06 14:01:33,904   INFO  distributed      False
2026-01-06 14:01:33,904   INFO  device           cuda:0
2026-01-06 14:01:33,904   INFO  image_feat_size  1024
2026-01-06 14:01:33,904   INFO  obj_feat_size    768
2026-01-06 14:01:33,904   INFO  angle_feat_size  4
2026-01-06 14:01:33,904   INFO  enc_full_graph   True
2026-01-06 14:01:33,905   INFO  expert_policy    spl
2026-01-06 14:01:33,905   INFO  num_pano_layers  2
2026-01-06 14:01:33,905   INFO  ----------- Feature -----------
2026-01-06 14:01:33,905   INFO  cfg.Feature.object_feature_type: 
2026-01-06 14:01:33,905   INFO  cfg.Feature.angle_feat_size: 4
2026-01-06 14:01:33,905   INFO  cfg.Feature.max_objects: 70
2026-01-06 14:01:33,905   INFO  cfg.Feature.image_feat_size: 1024
2026-01-06 14:01:33,905   INFO  ----------- feature_database -----------
2026-01-06 14:01:33,905   INFO  cfg.Feature.feature_database.mp3d: eva_features/mp3d_EVA02-CLIP-L-14-336.hdf5
2026-01-06 14:01:33,905   INFO  cfg.Feature.feature_database.scan_qa: eva_features/scanqa_EVA02-CLIP-L-14-336.hdf5
2026-01-06 14:01:33,905   INFO  cfg.Feature.feature_database.room_tour: eva_features/web_obj_prog_p1_EVA02-CLIP-L-14-336.hdf5.bak
2026-01-06 14:01:33,905   INFO  cfg.Feature.feature_database.room3d_tour: eva_features/web_3d_obj_prog_crop_p1_EVA02-CLIP-L-14-336.hdf5
2026-01-06 14:01:33,905   INFO  cfg.Feature.feature_database.coco: eva_features/coco_EVA02-CLIP-L-14-336.hdf5
2026-01-06 14:01:33,905   INFO  cfg.Feature.obj_feat_size: 768
2026-01-06 14:01:33,905   INFO  ----------- object_database -----------
2026-01-06 14:01:33,905   INFO  cfg.Feature.object_database.reverie: obj_features/reverie_obj_feat
2026-01-06 14:01:33,905   INFO  cfg.Feature.object_database.soon: obj_features/soon_obj_feat
2026-01-06 14:01:33,905   INFO  ----------- Dataset -----------
2026-01-06 14:01:33,905   INFO  ----------- R2R -----------
2026-01-06 14:01:33,905   INFO  cfg.Dataset.R2R.DIR: R2R
2026-01-06 14:01:33,905   INFO  ----------- SPLIT -----------
2026-01-06 14:01:33,906   INFO  cfg.Dataset.R2R.SPLIT.train: FGR2R_train.json
2026-01-06 14:01:33,906   INFO  cfg.Dataset.R2R.SPLIT.val_seen: R2R_val_seen_enc.json
2026-01-06 14:01:33,906   INFO  cfg.Dataset.R2R.SPLIT.val_unseen: R2R_val_unseen_enc.json
2026-01-06 14:01:33,906   INFO  cfg.Dataset.R2R.SPLIT.test: R2R_test_enc.json
2026-01-06 14:01:33,906   INFO  ----------- REVERIE -----------
2026-01-06 14:01:33,906   INFO  cfg.Dataset.REVERIE.DIR: REVERIE
2026-01-06 14:01:33,906   INFO  cfg.Dataset.REVERIE.bbox_file: BBoxes.json
2026-01-06 14:01:33,906   INFO  ----------- SPLIT -----------
2026-01-06 14:01:33,906   INFO  cfg.Dataset.REVERIE.SPLIT.train: REVERIE_train_enc.json
2026-01-06 14:01:33,906   INFO  cfg.Dataset.REVERIE.SPLIT.val_seen: REVERIE_val_seen_enc.json
2026-01-06 14:01:33,906   INFO  cfg.Dataset.REVERIE.SPLIT.val_unseen: REVERIE_val_unseen_enc.json
2026-01-06 14:01:33,906   INFO  cfg.Dataset.REVERIE.SPLIT.test: REVERIE_test_enc.json
2026-01-06 14:01:33,906   INFO  ----------- CVDN -----------
2026-01-06 14:01:33,906   INFO  cfg.Dataset.CVDN.DIR: CVDN
2026-01-06 14:01:33,906   INFO  ----------- SPLIT -----------
2026-01-06 14:01:33,906   INFO  cfg.Dataset.CVDN.SPLIT.train: train.json
2026-01-06 14:01:33,906   INFO  cfg.Dataset.CVDN.SPLIT.val_seen: val_seen.json
2026-01-06 14:01:33,906   INFO  cfg.Dataset.CVDN.SPLIT.val_unseen: val_unseen.json
2026-01-06 14:01:33,906   INFO  cfg.Dataset.CVDN.SPLIT.test: test_cleaned.json
2026-01-06 14:01:33,906   INFO  ----------- SOON -----------
2026-01-06 14:01:33,907   INFO  cfg.Dataset.SOON.DIR: SOON
2026-01-06 14:01:33,907   INFO  ----------- SPLIT -----------
2026-01-06 14:01:33,907   INFO  cfg.Dataset.SOON.SPLIT.train: train_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 14:01:33,907   INFO  cfg.Dataset.SOON.SPLIT.val_seen: val_unseen_instrs_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 14:01:33,907   INFO  cfg.Dataset.SOON.SPLIT.val_unseen: val_unseen_house_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 14:01:33,907   INFO  cfg.Dataset.SOON.SPLIT.test: test_v2_enc.jsonl
2026-01-06 14:01:33,907   INFO  ----------- ScanQA -----------
2026-01-06 14:01:33,907   INFO  cfg.Dataset.ScanQA.DIR: ScanQA
2026-01-06 14:01:33,907   INFO  ----------- SPLIT -----------
2026-01-06 14:01:33,907   INFO  cfg.Dataset.ScanQA.SPLIT.train: ScanQA_v1.0_train_reformat.json
2026-01-06 14:01:33,907   INFO  cfg.Dataset.ScanQA.SPLIT.val_unseen: ScanQA_v1.0_val_reformat.json
2026-01-06 14:01:33,907   INFO  cfg.Dataset.ScanQA.SPLIT.test_wo_obj: ScanQA_v1.0_test_wo_obj_reformat.json
2026-01-06 14:01:33,907   INFO  cfg.Dataset.ScanQA.SPLIT.test_w_obj: ScanQA_v1.0_test_w_obj_reformat.json
2026-01-06 14:01:33,907   INFO  ----------- RoomTour -----------
2026-01-06 14:01:33,907   INFO  cfg.Dataset.RoomTour.DIR: RoomTour
2026-01-06 14:01:33,907   INFO  ----------- SPLIT -----------
2026-01-06 14:01:33,907   INFO  cfg.Dataset.RoomTour.SPLIT.train: p1_train_reformat.json
2026-01-06 14:01:33,907   INFO  ----------- Tour3D -----------
2026-01-06 14:01:33,907   INFO  cfg.Dataset.Tour3D.DIR: RoomTour
2026-01-06 14:01:33,907   INFO  ----------- SPLIT -----------
2026-01-06 14:01:33,907   INFO  cfg.Dataset.Tour3D.SPLIT.train: p1_train_colmap_trajectory_tour3d.json
2026-01-06 14:01:33,907   INFO  ----------- EQA -----------
2026-01-06 14:01:33,908   INFO  cfg.Dataset.EQA.DIR: EQA_MP3D
2026-01-06 14:01:33,908   INFO  ----------- SPLIT -----------
2026-01-06 14:01:33,908   INFO  cfg.Dataset.EQA.SPLIT.val_unseen: eqa_val_enc.json
2026-01-06 14:01:33,908   INFO  cfg.Dataset.EQA.ANSWER_VOCAB: eqa_answer_vocab.json
2026-01-06 14:01:33,908   INFO  ----------- R2R_AUG -----------
2026-01-06 14:01:33,908   INFO  cfg.Dataset.R2R_AUG.DIR: R2R
2026-01-06 14:01:33,908   INFO  ----------- SPLIT -----------
2026-01-06 14:01:33,908   INFO  cfg.Dataset.R2R_AUG.SPLIT.train: R2R_prevalent_aug_train_enc.jsonl
2026-01-06 14:01:33,908   INFO  ----------- REVERIE_AUG -----------
2026-01-06 14:01:33,908   INFO  cfg.Dataset.REVERIE_AUG.DIR: REVERIE
2026-01-06 14:01:33,908   INFO  cfg.Dataset.REVERIE_AUG.bbox_file: BBoxes.json
2026-01-06 14:01:33,908   INFO  ----------- SPLIT -----------
2026-01-06 14:01:33,908   INFO  cfg.Dataset.REVERIE_AUG.SPLIT.train: REVERIE_speaker_aug_enc.jsonl
2026-01-06 14:01:33,908   INFO  ----------- LLaVA -----------
2026-01-06 14:01:33,908   INFO  cfg.Dataset.LLaVA.DIR: LLaVA
2026-01-06 14:01:33,908   INFO  ----------- SPLIT -----------
2026-01-06 14:01:33,908   INFO  cfg.Dataset.LLaVA.SPLIT.train: detail_23k.json
2026-01-06 14:01:33,908   INFO  ----------- Pretrain -----------
2026-01-06 14:01:33,908   INFO  cfg.Pretrain.SOURCE: ['Tour3D', 'RoomTour', 'ScanQA', 'LLaVA']
2026-01-06 14:01:33,908   INFO  cfg.Pretrain.Ratio: [10, 20, 5, 2]
2026-01-06 14:01:33,909   INFO  ----------- LOSS_COEF -----------
2026-01-06 14:01:33,909   INFO  cfg.Pretrain.LOSS_COEF.R2R_AUG: 1
2026-01-06 14:01:33,909   INFO  cfg.Pretrain.LOSS_COEF.REVERIE_AUG: 1
2026-01-06 14:01:33,909   INFO  ----------- Multi -----------
2026-01-06 14:01:33,909   INFO  cfg.Multi.SOURCE: ['Tour3D', 'R2R', 'REVERIE', 'CVDN', 'SOON', 'ScanQA', 'LLaVA']
2026-01-06 14:01:33,909   INFO  cfg.Multi.Ratio: [10, 20, 5, 1, 5, 5, 5]
2026-01-06 14:01:33,909   INFO  ----------- LOSS_COEF -----------
2026-01-06 14:01:33,909   INFO  ----------- Model -----------
2026-01-06 14:01:33,909   INFO  cfg.Model.num_l_layers: 9
2026-01-06 14:01:33,909   INFO  cfg.Model.num_pano_layers: 2
2026-01-06 14:01:33,909   INFO  cfg.Model.num_x_layers: 4
2026-01-06 14:01:33,909   INFO  cfg.Model.graph_sprels: True
2026-01-06 14:01:33,909   INFO  cfg.Model.fusion: dynamic
2026-01-06 14:01:33,909   INFO  cfg.Model.enc_full_graph: True
2026-01-06 14:01:33,909   INFO  cfg.Model.expert_policy: spl
2026-01-06 14:01:33,909   INFO  ----------- Optim -----------
2026-01-06 14:01:33,909   INFO  ----------- val_max_action_len -----------
2026-01-06 14:01:33,909   INFO  cfg.Optim.val_max_action_len.R2R: 15
2026-01-06 14:01:33,909   INFO  cfg.Optim.val_max_action_len.REVERIE: 15
2026-01-06 14:01:33,909   INFO  cfg.Optim.val_max_action_len.CVDN: 30
2026-01-06 14:01:33,909   INFO  cfg.Optim.val_max_action_len.SOON: 20
2026-01-06 14:01:33,910   INFO  cfg.Optim.val_max_action_len.EQA: 15
2026-01-06 14:01:33,910   INFO  ----------- train_max_action_len -----------
2026-01-06 14:01:33,910   INFO  cfg.Optim.train_max_action_len.R2R: 15
2026-01-06 14:01:33,910   INFO  cfg.Optim.train_max_action_len.Tour3D: 15
2026-01-06 14:01:33,910   INFO  cfg.Optim.train_max_action_len.REVERIE: 15
2026-01-06 14:01:33,910   INFO  cfg.Optim.train_max_action_len.CVDN: 15
2026-01-06 14:01:33,910   INFO  cfg.Optim.train_max_action_len.SOON: 15
2026-01-06 14:01:33,910   INFO  cfg.Optim.train_max_action_len.EQA: 15
2026-01-06 14:01:33,910   INFO  cfg.Optim.train_max_action_len.R2R_AUG: 15
2026-01-06 14:01:33,910   INFO  cfg.Optim.train_max_action_len.REVERIE_AUG: 15
2026-01-06 14:01:36,891   INFO  [INFO] SOONDataset loaded with 3390 instructions, using splits: val_unseen
2026-01-06 14:01:36,891   INFO  
- Dataset: load 3390 SOON samples
- Dataset: load val_unseen split: 3390 samples in total
- Dataset: load val_unseen split: 5 scans in total
2026-01-06 14:01:36,892   INFO  SOON: 3390 samples loaded
2026-01-06 14:01:36,974   INFO  Initialize the model from config.
2026-01-06 14:03:02,718   INFO  model type: torch.bfloat16
2026-01-06 14:03:02,721   INFO  Trainable params: lang_model.model.embed_tokens.weight,lang_model.model.layers.0.self_attn.q_proj.weight,lang_model.model.layers.0.self_attn.k_proj.weight,lang_model.model.layers.0.self_attn.v_proj.weight,lang_model.model.layers.0.self_attn.o_proj.weight,lang_model.model.layers.0.mlp.gate_proj.weight,lang_model.model.layers.0.mlp.down_proj.weight,lang_model.model.layers.0.mlp.up_proj.weight,lang_model.model.layers.0.input_layernorm.weight,lang_model.model.layers.0.post_attention_layernorm.weight,lang_model.model.layers.1.self_attn.q_proj.weight,lang_model.model.layers.1.self_attn.k_proj.weight,lang_model.model.layers.1.self_attn.v_proj.weight,lang_model.model.layers.1.self_attn.o_proj.weight,lang_model.model.layers.1.mlp.gate_proj.weight,lang_model.model.layers.1.mlp.down_proj.weight,lang_model.model.layers.1.mlp.up_proj.weight,lang_model.model.layers.1.input_layernorm.weight,lang_model.model.layers.1.post_attention_layernorm.weight,lang_model.model.layers.2.self_attn.q_proj.weight,lang_model.model.layers.2.self_attn.k_proj.weight,lang_model.model.layers.2.self_attn.v_proj.weight,lang_model.model.layers.2.self_attn.o_proj.weight,lang_model.model.layers.2.mlp.gate_proj.weight,lang_model.model.layers.2.mlp.down_proj.weight,lang_model.model.layers.2.mlp.up_proj.weight,lang_model.model.layers.2.input_layernorm.weight,lang_model.model.layers.2.post_attention_layernorm.weight,lang_model.model.layers.3.self_attn.q_proj.weight,lang_model.model.layers.3.self_attn.k_proj.weight,lang_model.model.layers.3.self_attn.v_proj.weight,lang_model.model.layers.3.self_attn.o_proj.weight,lang_model.model.layers.3.mlp.gate_proj.weight,lang_model.model.layers.3.mlp.down_proj.weight,lang_model.model.layers.3.mlp.up_proj.weight,lang_model.model.layers.3.input_layernorm.weight,lang_model.model.layers.3.post_attention_layernorm.weight,lang_model.model.layers.4.self_attn.q_proj.weight,lang_model.model.layers.4.self_attn.k_proj.weight,lang_model.model.layers.4.self_attn.v_proj.weight,lang_model.model.layers.4.self_attn.o_proj.weight,lang_model.model.layers.4.mlp.gate_proj.weight,lang_model.model.layers.4.mlp.down_proj.weight,lang_model.model.layers.4.mlp.up_proj.weight,lang_model.model.layers.4.input_layernorm.weight,lang_model.model.layers.4.post_attention_layernorm.weight,lang_model.model.layers.5.self_attn.q_proj.weight,lang_model.model.layers.5.self_attn.k_proj.weight,lang_model.model.layers.5.self_attn.v_proj.weight,lang_model.model.layers.5.self_attn.o_proj.weight,lang_model.model.layers.5.mlp.gate_proj.weight,lang_model.model.layers.5.mlp.down_proj.weight,lang_model.model.layers.5.mlp.up_proj.weight,lang_model.model.layers.5.input_layernorm.weight,lang_model.model.layers.5.post_attention_layernorm.weight,lang_model.model.layers.6.self_attn.q_proj.weight,lang_model.model.layers.6.self_attn.k_proj.weight,lang_model.model.layers.6.self_attn.v_proj.weight,lang_model.model.layers.6.self_attn.o_proj.weight,lang_model.model.layers.6.mlp.gate_proj.weight,lang_model.model.layers.6.mlp.down_proj.weight,lang_model.model.layers.6.mlp.up_proj.weight,lang_model.model.layers.6.input_layernorm.weight,lang_model.model.layers.6.post_attention_layernorm.weight,lang_model.model.layers.7.self_attn.q_proj.weight,lang_model.model.layers.7.self_attn.k_proj.weight,lang_model.model.layers.7.self_attn.v_proj.weight,lang_model.model.layers.7.self_attn.o_proj.weight,lang_model.model.layers.7.mlp.gate_proj.weight,lang_model.model.layers.7.mlp.down_proj.weight,lang_model.model.layers.7.mlp.up_proj.weight,lang_model.model.layers.7.input_layernorm.weight,lang_model.model.layers.7.post_attention_layernorm.weight,lang_model.model.layers.8.self_attn.q_proj.weight,lang_model.model.layers.8.self_attn.k_proj.weight,lang_model.model.layers.8.self_attn.v_proj.weight,lang_model.model.layers.8.self_attn.o_proj.weight,lang_model.model.layers.8.mlp.gate_proj.weight,lang_model.model.layers.8.mlp.down_proj.weight,lang_model.model.layers.8.mlp.up_proj.weight,lang_model.model.layers.8.input_layernorm.weight,lang_model.model.layers.8.post_attention_layernorm.weight,lang_model.model.layers.9.self_attn.q_proj.weight,lang_model.model.layers.9.self_attn.k_proj.weight,lang_model.model.layers.9.self_attn.v_proj.weight,lang_model.model.layers.9.self_attn.o_proj.weight,lang_model.model.layers.9.mlp.gate_proj.weight,lang_model.model.layers.9.mlp.down_proj.weight,lang_model.model.layers.9.mlp.up_proj.weight,lang_model.model.layers.9.input_layernorm.weight,lang_model.model.layers.9.post_attention_layernorm.weight,lang_model.model.layers.10.self_attn.q_proj.weight,lang_model.model.layers.10.self_attn.k_proj.weight,lang_model.model.layers.10.self_attn.v_proj.weight,lang_model.model.layers.10.self_attn.o_proj.weight,lang_model.model.layers.10.mlp.gate_proj.weight,lang_model.model.layers.10.mlp.down_proj.weight,lang_model.model.layers.10.mlp.up_proj.weight,lang_model.model.layers.10.input_layernorm.weight,lang_model.model.layers.10.post_attention_layernorm.weight,lang_model.model.layers.11.self_attn.q_proj.weight,lang_model.model.layers.11.self_attn.k_proj.weight,lang_model.model.layers.11.self_attn.v_proj.weight,lang_model.model.layers.11.self_attn.o_proj.weight,lang_model.model.layers.11.mlp.gate_proj.weight,lang_model.model.layers.11.mlp.down_proj.weight,lang_model.model.layers.11.mlp.up_proj.weight,lang_model.model.layers.11.input_layernorm.weight,lang_model.model.layers.11.post_attention_layernorm.weight,lang_model.model.layers.12.self_attn.q_proj.weight,lang_model.model.layers.12.self_attn.k_proj.weight,lang_model.model.layers.12.self_attn.v_proj.weight,lang_model.model.layers.12.self_attn.o_proj.weight,lang_model.model.layers.12.mlp.gate_proj.weight,lang_model.model.layers.12.mlp.down_proj.weight,lang_model.model.layers.12.mlp.up_proj.weight,lang_model.model.layers.12.input_layernorm.weight,lang_model.model.layers.12.post_attention_layernorm.weight,lang_model.model.layers.13.self_attn.q_proj.weight,lang_model.model.layers.13.self_attn.k_proj.weight,lang_model.model.layers.13.self_attn.v_proj.weight,lang_model.model.layers.13.self_attn.o_proj.weight,lang_model.model.layers.13.mlp.gate_proj.weight,lang_model.model.layers.13.mlp.down_proj.weight,lang_model.model.layers.13.mlp.up_proj.weight,lang_model.model.layers.13.input_layernorm.weight,lang_model.model.layers.13.post_attention_layernorm.weight,lang_model.model.layers.14.self_attn.q_proj.weight,lang_model.model.layers.14.self_attn.k_proj.weight,lang_model.model.layers.14.self_attn.v_proj.weight,lang_model.model.layers.14.self_attn.o_proj.weight,lang_model.model.layers.14.mlp.gate_proj.weight,lang_model.model.layers.14.mlp.down_proj.weight,lang_model.model.layers.14.mlp.up_proj.weight,lang_model.model.layers.14.input_layernorm.weight,lang_model.model.layers.14.post_attention_layernorm.weight,lang_model.model.layers.15.self_attn.q_proj.weight,lang_model.model.layers.15.self_attn.k_proj.weight,lang_model.model.layers.15.self_attn.v_proj.weight,lang_model.model.layers.15.self_attn.o_proj.weight,lang_model.model.layers.15.mlp.gate_proj.weight,lang_model.model.layers.15.mlp.down_proj.weight,lang_model.model.layers.15.mlp.up_proj.weight,lang_model.model.layers.15.input_layernorm.weight,lang_model.model.layers.15.post_attention_layernorm.weight,lang_model.model.layers.16.self_attn.q_proj.weight,lang_model.model.layers.16.self_attn.k_proj.weight,lang_model.model.layers.16.self_attn.v_proj.weight,lang_model.model.layers.16.self_attn.o_proj.weight,lang_model.model.layers.16.mlp.gate_proj.weight,lang_model.model.layers.16.mlp.down_proj.weight,lang_model.model.layers.16.mlp.up_proj.weight,lang_model.model.layers.16.input_layernorm.weight,lang_model.model.layers.16.post_attention_layernorm.weight,lang_model.model.layers.17.self_attn.q_proj.weight,lang_model.model.layers.17.self_attn.k_proj.weight,lang_model.model.layers.17.self_attn.v_proj.weight,lang_model.model.layers.17.self_attn.o_proj.weight,lang_model.model.layers.17.mlp.gate_proj.weight,lang_model.model.layers.17.mlp.down_proj.weight,lang_model.model.layers.17.mlp.up_proj.weight,lang_model.model.layers.17.input_layernorm.weight,lang_model.model.layers.17.post_attention_layernorm.weight,lang_model.model.layers.18.self_attn.q_proj.weight,lang_model.model.layers.18.self_attn.k_proj.weight,lang_model.model.layers.18.self_attn.v_proj.weight,lang_model.model.layers.18.self_attn.o_proj.weight,lang_model.model.layers.18.mlp.gate_proj.weight,lang_model.model.layers.18.mlp.down_proj.weight,lang_model.model.layers.18.mlp.up_proj.weight,lang_model.model.layers.18.input_layernorm.weight,lang_model.model.layers.18.post_attention_layernorm.weight,lang_model.model.layers.19.self_attn.q_proj.weight,lang_model.model.layers.19.self_attn.k_proj.weight,lang_model.model.layers.19.self_attn.v_proj.weight,lang_model.model.layers.19.self_attn.o_proj.weight,lang_model.model.layers.19.mlp.gate_proj.weight,lang_model.model.layers.19.mlp.down_proj.weight,lang_model.model.layers.19.mlp.up_proj.weight,lang_model.model.layers.19.input_layernorm.weight,lang_model.model.layers.19.post_attention_layernorm.weight,lang_model.model.layers.20.self_attn.q_proj.weight,lang_model.model.layers.20.self_attn.k_proj.weight,lang_model.model.layers.20.self_attn.v_proj.weight,lang_model.model.layers.20.self_attn.o_proj.weight,lang_model.model.layers.20.mlp.gate_proj.weight,lang_model.model.layers.20.mlp.down_proj.weight,lang_model.model.layers.20.mlp.up_proj.weight,lang_model.model.layers.20.input_layernorm.weight,lang_model.model.layers.20.post_attention_layernorm.weight,lang_model.model.layers.21.self_attn.q_proj.weight,lang_model.model.layers.21.self_attn.k_proj.weight,lang_model.model.layers.21.self_attn.v_proj.weight,lang_model.model.layers.21.self_attn.o_proj.weight,lang_model.model.layers.21.mlp.gate_proj.weight,lang_model.model.layers.21.mlp.down_proj.weight,lang_model.model.layers.21.mlp.up_proj.weight,lang_model.model.layers.21.input_layernorm.weight,lang_model.model.layers.21.post_attention_layernorm.weight,lang_model.model.layers.22.self_attn.q_proj.weight,lang_model.model.layers.22.self_attn.k_proj.weight,lang_model.model.layers.22.self_attn.v_proj.weight,lang_model.model.layers.22.self_attn.o_proj.weight,lang_model.model.layers.22.mlp.gate_proj.weight,lang_model.model.layers.22.mlp.down_proj.weight,lang_model.model.layers.22.mlp.up_proj.weight,lang_model.model.layers.22.input_layernorm.weight,lang_model.model.layers.22.post_attention_layernorm.weight,lang_model.model.layers.23.self_attn.q_proj.weight,lang_model.model.layers.23.self_attn.k_proj.weight,lang_model.model.layers.23.self_attn.v_proj.weight,lang_model.model.layers.23.self_attn.o_proj.weight,lang_model.model.layers.23.mlp.gate_proj.weight,lang_model.model.layers.23.mlp.down_proj.weight,lang_model.model.layers.23.mlp.up_proj.weight,lang_model.model.layers.23.input_layernorm.weight,lang_model.model.layers.23.post_attention_layernorm.weight,lang_model.model.layers.24.self_attn.q_proj.weight,lang_model.model.layers.24.self_attn.k_proj.weight,lang_model.model.layers.24.self_attn.v_proj.weight,lang_model.model.layers.24.self_attn.o_proj.weight,lang_model.model.layers.24.mlp.gate_proj.weight,lang_model.model.layers.24.mlp.down_proj.weight,lang_model.model.layers.24.mlp.up_proj.weight,lang_model.model.layers.24.input_layernorm.weight,lang_model.model.layers.24.post_attention_layernorm.weight,lang_model.model.layers.25.self_attn.q_proj.weight,lang_model.model.layers.25.self_attn.k_proj.weight,lang_model.model.layers.25.self_attn.v_proj.weight,lang_model.model.layers.25.self_attn.o_proj.weight,lang_model.model.layers.25.mlp.gate_proj.weight,lang_model.model.layers.25.mlp.down_proj.weight,lang_model.model.layers.25.mlp.up_proj.weight,lang_model.model.layers.25.input_layernorm.weight,lang_model.model.layers.25.post_attention_layernorm.weight,lang_model.model.layers.26.self_attn.q_proj.weight,lang_model.model.layers.26.self_attn.k_proj.weight,lang_model.model.layers.26.self_attn.v_proj.weight,lang_model.model.layers.26.self_attn.o_proj.weight,lang_model.model.layers.26.mlp.gate_proj.weight,lang_model.model.layers.26.mlp.down_proj.weight,lang_model.model.layers.26.mlp.up_proj.weight,lang_model.model.layers.26.input_layernorm.weight,lang_model.model.layers.26.post_attention_layernorm.weight,lang_model.model.layers.27.self_attn.q_proj.weight,lang_model.model.layers.27.self_attn.k_proj.weight,lang_model.model.layers.27.self_attn.v_proj.weight,lang_model.model.layers.27.self_attn.o_proj.weight,lang_model.model.layers.27.mlp.gate_proj.weight,lang_model.model.layers.27.mlp.down_proj.weight,lang_model.model.layers.27.mlp.up_proj.weight,lang_model.model.layers.27.input_layernorm.weight,lang_model.model.layers.27.post_attention_layernorm.weight,lang_model.model.layers.28.self_attn.q_proj.weight,lang_model.model.layers.28.self_attn.k_proj.weight,lang_model.model.layers.28.self_attn.v_proj.weight,lang_model.model.layers.28.self_attn.o_proj.weight,lang_model.model.layers.28.mlp.gate_proj.weight,lang_model.model.layers.28.mlp.down_proj.weight,lang_model.model.layers.28.mlp.up_proj.weight,lang_model.model.layers.28.input_layernorm.weight,lang_model.model.layers.28.post_attention_layernorm.weight,lang_model.model.layers.29.self_attn.q_proj.weight,lang_model.model.layers.29.self_attn.k_proj.weight,lang_model.model.layers.29.self_attn.v_proj.weight,lang_model.model.layers.29.self_attn.o_proj.weight,lang_model.model.layers.29.mlp.gate_proj.weight,lang_model.model.layers.29.mlp.down_proj.weight,lang_model.model.layers.29.mlp.up_proj.weight,lang_model.model.layers.29.input_layernorm.weight,lang_model.model.layers.29.post_attention_layernorm.weight,lang_model.model.layers.30.self_attn.q_proj.weight,lang_model.model.layers.30.self_attn.k_proj.weight,lang_model.model.layers.30.self_attn.v_proj.weight,lang_model.model.layers.30.self_attn.o_proj.weight,lang_model.model.layers.30.mlp.gate_proj.weight,lang_model.model.layers.30.mlp.down_proj.weight,lang_model.model.layers.30.mlp.up_proj.weight,lang_model.model.layers.30.input_layernorm.weight,lang_model.model.layers.30.post_attention_layernorm.weight,lang_model.model.layers.31.self_attn.q_proj.weight,lang_model.model.layers.31.self_attn.k_proj.weight,lang_model.model.layers.31.self_attn.v_proj.weight,lang_model.model.layers.31.self_attn.o_proj.weight,lang_model.model.layers.31.mlp.gate_proj.weight,lang_model.model.layers.31.mlp.down_proj.weight,lang_model.model.layers.31.mlp.up_proj.weight,lang_model.model.layers.31.input_layernorm.weight,lang_model.model.layers.31.post_attention_layernorm.weight,lang_model.model.norm.weight,lang_model.lm_head.weight,img_embeddings.img_linear.weight,img_embeddings.img_linear.bias,img_embeddings.img_layer_norm.weight,img_embeddings.img_layer_norm.bias,img_embeddings.loc_linear.weight,img_embeddings.loc_linear.bias,img_embeddings.loc_layer_norm.weight,img_embeddings.loc_layer_norm.bias,img_embeddings.obj_projector.0.weight,img_embeddings.obj_projector.0.bias,img_embeddings.obj_projector.1.weight,img_embeddings.obj_projector.1.bias,img_embeddings.nav_type_embedding.weight,img_embeddings.layer_norm.weight,img_embeddings.layer_norm.bias,img_embeddings.pano_encoder.layers.0.self_attn.in_proj_weight,img_embeddings.pano_encoder.layers.0.self_attn.in_proj_bias,img_embeddings.pano_encoder.layers.0.self_attn.out_proj.weight,img_embeddings.pano_encoder.layers.0.self_attn.out_proj.bias,img_embeddings.pano_encoder.layers.0.linear1.weight,img_embeddings.pano_encoder.layers.0.linear1.bias,img_embeddings.pano_encoder.layers.0.linear2.weight,img_embeddings.pano_encoder.layers.0.linear2.bias,img_embeddings.pano_encoder.layers.0.norm1.weight,img_embeddings.pano_encoder.layers.0.norm1.bias,img_embeddings.pano_encoder.layers.0.norm2.weight,img_embeddings.pano_encoder.layers.0.norm2.bias,img_embeddings.pano_encoder.layers.1.self_attn.in_proj_weight,img_embeddings.pano_encoder.layers.1.self_attn.in_proj_bias,img_embeddings.pano_encoder.layers.1.self_attn.out_proj.weight,img_embeddings.pano_encoder.layers.1.self_attn.out_proj.bias,img_embeddings.pano_encoder.layers.1.linear1.weight,img_embeddings.pano_encoder.layers.1.linear1.bias,img_embeddings.pano_encoder.layers.1.linear2.weight,img_embeddings.pano_encoder.layers.1.linear2.bias,img_embeddings.pano_encoder.layers.1.norm1.weight,img_embeddings.pano_encoder.layers.1.norm1.bias,img_embeddings.pano_encoder.layers.1.norm2.weight,img_embeddings.pano_encoder.layers.1.norm2.bias,img_embeddings.pano_encoder.norm.weight,img_embeddings.pano_encoder.norm.bias,img_embeddings.mapper.weight,img_embeddings.mapper.bias,token_type_embeddings.weight,gmap_pos_embeddings.0.weight,gmap_pos_embeddings.0.bias,gmap_pos_embeddings.1.weight,gmap_pos_embeddings.1.bias,gmap_step_embeddings.weight,vp_pos_embeddings.0.weight,vp_pos_embeddings.0.bias,vp_pos_embeddings.1.weight,vp_pos_embeddings.1.bias,obj_pos_embeddings.0.weight,obj_pos_embeddings.0.bias,obj_pos_embeddings.1.weight,obj_pos_embeddings.1.bias,og_head.0.weight,og_head.0.bias,out_head.0.weight,out_head.0.bias
2026-01-06 14:03:02,721   INFO  *************** init model *************** 
2026-01-06 14:03:05,591   INFO  Loading checkpoint from /data/wanghaoxuan/roomtour3d.pt
2026-01-06 14:03:11,558   INFO  <All keys matched successfully>
2026-01-06 14:03:12,097   INFO  model initialized with 6773.48 M trainable parameters
2026-01-06 14:03:12,098   INFO  Training with a single process
2026-01-06 14:03:12,098   INFO  **************************** Test ****************************
2026-01-06 14:03:12,100   INFO  ***** validate val_unseen split on SOON task *****
2026-01-06 15:06:26,064   INFO  eval 3390 predictions
2026-01-06 15:06:26,191   INFO  
[Eval] val_unseen epoch 0

 [Eval] dataset=[SOON] 
, action_steps: 12.02, steps: 14.91, lengths: 27.67, nav_error: 7.74, oracle_error: 4.63
[Eval] ||| sr: 38.17, oracle_sr: 53.16, spl: 29.87, det_sr: 1.53, det_spl: 1.20
2026-01-06 15:44:40,903   INFO  **********************Start logging**********************
2026-01-06 15:44:40,903   INFO  CUDA_VISIBLE_DEVICES=0
2026-01-06 15:44:40,903   INFO  data_dir         /data/wanghaoxuan/data
2026-01-06 15:44:40,903   INFO  cfg_file         configs/multi.yaml
2026-01-06 15:44:40,903   INFO  pretrained_model_name_or_path /data/wanghaoxuan/data/models/Vicuna-7B
2026-01-06 15:44:40,903   INFO  off_batch_task   False
2026-01-06 15:44:40,903   INFO  debug            False
2026-01-06 15:44:40,903   INFO  few_shot         None
2026-01-06 15:44:40,903   INFO  tour3d_nav_head  False
2026-01-06 15:44:40,903   INFO  seed             0
2026-01-06 15:44:40,903   INFO  num_epochs       30
2026-01-06 15:44:40,903   INFO  resume_from_checkpoint /data/wanghaoxuan/roomtour3d.pt
2026-01-06 15:44:40,903   INFO  from_scratch     False
2026-01-06 15:44:40,904   INFO  batch_size       4
2026-01-06 15:44:40,904   INFO  val_batch_size   2
2026-01-06 15:44:40,904   INFO  lr               1e-05
2026-01-06 15:44:40,904   INFO  feat_dropout     0.4
2026-01-06 15:44:40,904   INFO  num_warmup_steps 0
2026-01-06 15:44:40,904   INFO  num_steps_per_epoch -1
2026-01-06 15:44:40,904   INFO  gradient_accumulation_step 2
2026-01-06 15:44:40,904   INFO  precision        amp_bf16
2026-01-06 15:44:40,904   INFO  workers          0
2026-01-06 15:44:40,904   INFO  gpu              0
2026-01-06 15:44:40,904   INFO  world_size       1
2026-01-06 15:44:40,904   INFO  local_rank       0
2026-01-06 15:44:40,904   INFO  dist_url         env://
2026-01-06 15:44:40,904   INFO  dist_backend     nccl
2026-01-06 15:44:40,904   INFO  horovod          False
2026-01-06 15:44:40,904   INFO  no_set_device_rank False
2026-01-06 15:44:40,904   INFO  output_dir       build/eval
2026-01-06 15:44:40,904   INFO  max_saved_checkpoints 0
2026-01-06 15:44:40,904   INFO  save_ckpt_per_epochs 10
2026-01-06 15:44:40,905   INFO  save_latest_states False
2026-01-06 15:44:40,905   INFO  save_pred_results True
2026-01-06 15:44:40,905   INFO  save_detail_results False
2026-01-06 15:44:40,905   INFO  mode             test
2026-01-06 15:44:40,905   INFO  stage            multi
2026-01-06 15:44:40,905   INFO  ignoreid         -100
2026-01-06 15:44:40,905   INFO  enable_og        False
2026-01-06 15:44:40,905   INFO  enable_summarize False
2026-01-06 15:44:40,905   INFO  enable_fgr2r     False
2026-01-06 15:44:40,905   INFO  disable_nav      False
2026-01-06 15:44:40,905   INFO  gen_loss_coef    1.0
2026-01-06 15:44:40,905   INFO  obj_loss_coef    1.0
2026-01-06 15:44:40,905   INFO  teacher_forcing_coef 1.0
2026-01-06 15:44:40,905   INFO  fuse_obj         False
2026-01-06 15:44:40,905   INFO  use_lora         False
2026-01-06 15:44:40,905   INFO  lora_rank        8
2026-01-06 15:44:40,905   INFO  lora_alpha       16
2026-01-06 15:44:40,905   INFO  lora_dropout     0.05
2026-01-06 15:44:40,905   INFO  lora_target      None
2026-01-06 15:44:40,906   INFO  freeze_llama     False
2026-01-06 15:44:40,906   INFO  tune_token_emb   False
2026-01-06 15:44:40,906   INFO  no_loc_fts       False
2026-01-06 15:44:40,906   INFO  multi_endpoints  1
2026-01-06 15:44:40,906   INFO  path_type        trusted_path
2026-01-06 15:44:40,906   INFO  test_datasets    ['R2R']
2026-01-06 15:44:40,906   INFO  validation_split test
2026-01-06 15:44:40,906   INFO  do_sample        False
2026-01-06 15:44:40,906   INFO  temperature      1.0
2026-01-06 15:44:40,906   INFO  max_datapoints   None
2026-01-06 15:44:40,906   INFO  rank             0
2026-01-06 15:44:40,906   INFO  distributed      False
2026-01-06 15:44:40,906   INFO  device           cuda:0
2026-01-06 15:44:40,906   INFO  image_feat_size  1024
2026-01-06 15:44:40,906   INFO  obj_feat_size    768
2026-01-06 15:44:40,906   INFO  angle_feat_size  4
2026-01-06 15:44:40,906   INFO  enc_full_graph   True
2026-01-06 15:44:40,906   INFO  expert_policy    spl
2026-01-06 15:44:40,906   INFO  num_pano_layers  2
2026-01-06 15:44:40,907   INFO  ----------- Feature -----------
2026-01-06 15:44:40,907   INFO  cfg.Feature.object_feature_type: 
2026-01-06 15:44:40,907   INFO  cfg.Feature.angle_feat_size: 4
2026-01-06 15:44:40,907   INFO  cfg.Feature.max_objects: 70
2026-01-06 15:44:40,907   INFO  cfg.Feature.image_feat_size: 1024
2026-01-06 15:44:40,907   INFO  ----------- feature_database -----------
2026-01-06 15:44:40,907   INFO  cfg.Feature.feature_database.mp3d: eva_features/mp3d_EVA02-CLIP-L-14-336.hdf5
2026-01-06 15:44:40,907   INFO  cfg.Feature.feature_database.scan_qa: eva_features/scanqa_EVA02-CLIP-L-14-336.hdf5
2026-01-06 15:44:40,907   INFO  cfg.Feature.feature_database.room_tour: eva_features/web_obj_prog_p1_EVA02-CLIP-L-14-336.hdf5.bak
2026-01-06 15:44:40,907   INFO  cfg.Feature.feature_database.room3d_tour: eva_features/web_3d_obj_prog_crop_p1_EVA02-CLIP-L-14-336.hdf5
2026-01-06 15:44:40,907   INFO  cfg.Feature.feature_database.coco: eva_features/coco_EVA02-CLIP-L-14-336.hdf5
2026-01-06 15:44:40,907   INFO  cfg.Feature.obj_feat_size: 768
2026-01-06 15:44:40,907   INFO  ----------- object_database -----------
2026-01-06 15:44:40,907   INFO  cfg.Feature.object_database.reverie: obj_features/reverie_obj_feat
2026-01-06 15:44:40,907   INFO  cfg.Feature.object_database.soon: obj_features/soon_obj_feat
2026-01-06 15:44:40,907   INFO  ----------- Dataset -----------
2026-01-06 15:44:40,907   INFO  ----------- R2R -----------
2026-01-06 15:44:40,907   INFO  cfg.Dataset.R2R.DIR: R2R
2026-01-06 15:44:40,907   INFO  ----------- SPLIT -----------
2026-01-06 15:44:40,908   INFO  cfg.Dataset.R2R.SPLIT.train: FGR2R_train.json
2026-01-06 15:44:40,908   INFO  cfg.Dataset.R2R.SPLIT.val_seen: R2R_val_seen_enc.json
2026-01-06 15:44:40,908   INFO  cfg.Dataset.R2R.SPLIT.val_unseen: R2R_val_unseen_enc.json
2026-01-06 15:44:40,908   INFO  cfg.Dataset.R2R.SPLIT.test: R2R_test_enc.json
2026-01-06 15:44:40,908   INFO  ----------- REVERIE -----------
2026-01-06 15:44:40,908   INFO  cfg.Dataset.REVERIE.DIR: REVERIE
2026-01-06 15:44:40,908   INFO  cfg.Dataset.REVERIE.bbox_file: BBoxes.json
2026-01-06 15:44:40,908   INFO  ----------- SPLIT -----------
2026-01-06 15:44:40,908   INFO  cfg.Dataset.REVERIE.SPLIT.train: REVERIE_train_enc.json
2026-01-06 15:44:40,908   INFO  cfg.Dataset.REVERIE.SPLIT.val_seen: REVERIE_val_seen_enc.json
2026-01-06 15:44:40,908   INFO  cfg.Dataset.REVERIE.SPLIT.val_unseen: REVERIE_val_unseen_enc.json
2026-01-06 15:44:40,908   INFO  cfg.Dataset.REVERIE.SPLIT.test: REVERIE_test_enc.json
2026-01-06 15:44:40,908   INFO  ----------- CVDN -----------
2026-01-06 15:44:40,908   INFO  cfg.Dataset.CVDN.DIR: CVDN
2026-01-06 15:44:40,908   INFO  ----------- SPLIT -----------
2026-01-06 15:44:40,908   INFO  cfg.Dataset.CVDN.SPLIT.train: train.json
2026-01-06 15:44:40,908   INFO  cfg.Dataset.CVDN.SPLIT.val_seen: val_seen.json
2026-01-06 15:44:40,908   INFO  cfg.Dataset.CVDN.SPLIT.val_unseen: val_unseen.json
2026-01-06 15:44:40,908   INFO  cfg.Dataset.CVDN.SPLIT.test: test_cleaned.json
2026-01-06 15:44:40,908   INFO  ----------- SOON -----------
2026-01-06 15:44:40,909   INFO  cfg.Dataset.SOON.DIR: SOON
2026-01-06 15:44:40,909   INFO  ----------- SPLIT -----------
2026-01-06 15:44:40,909   INFO  cfg.Dataset.SOON.SPLIT.train: train_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 15:44:40,909   INFO  cfg.Dataset.SOON.SPLIT.val_seen: val_unseen_instrs_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 15:44:40,909   INFO  cfg.Dataset.SOON.SPLIT.val_unseen: val_unseen_house_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 15:44:40,909   INFO  cfg.Dataset.SOON.SPLIT.test: test_v2_enc.jsonl
2026-01-06 15:44:40,909   INFO  ----------- ScanQA -----------
2026-01-06 15:44:40,909   INFO  cfg.Dataset.ScanQA.DIR: ScanQA
2026-01-06 15:44:40,909   INFO  ----------- SPLIT -----------
2026-01-06 15:44:40,909   INFO  cfg.Dataset.ScanQA.SPLIT.train: ScanQA_v1.0_train_reformat.json
2026-01-06 15:44:40,909   INFO  cfg.Dataset.ScanQA.SPLIT.val_unseen: ScanQA_v1.0_val_reformat.json
2026-01-06 15:44:40,909   INFO  cfg.Dataset.ScanQA.SPLIT.test_wo_obj: ScanQA_v1.0_test_wo_obj_reformat.json
2026-01-06 15:44:40,909   INFO  cfg.Dataset.ScanQA.SPLIT.test_w_obj: ScanQA_v1.0_test_w_obj_reformat.json
2026-01-06 15:44:40,909   INFO  ----------- RoomTour -----------
2026-01-06 15:44:40,909   INFO  cfg.Dataset.RoomTour.DIR: RoomTour
2026-01-06 15:44:40,909   INFO  ----------- SPLIT -----------
2026-01-06 15:44:40,909   INFO  cfg.Dataset.RoomTour.SPLIT.train: p1_train_reformat.json
2026-01-06 15:44:40,909   INFO  ----------- Tour3D -----------
2026-01-06 15:44:40,909   INFO  cfg.Dataset.Tour3D.DIR: RoomTour
2026-01-06 15:44:40,910   INFO  ----------- SPLIT -----------
2026-01-06 15:44:40,910   INFO  cfg.Dataset.Tour3D.SPLIT.train: p1_train_colmap_trajectory_tour3d.json
2026-01-06 15:44:40,910   INFO  ----------- EQA -----------
2026-01-06 15:44:40,910   INFO  cfg.Dataset.EQA.DIR: EQA_MP3D
2026-01-06 15:44:40,910   INFO  ----------- SPLIT -----------
2026-01-06 15:44:40,910   INFO  cfg.Dataset.EQA.SPLIT.val_unseen: eqa_val_enc.json
2026-01-06 15:44:40,910   INFO  cfg.Dataset.EQA.ANSWER_VOCAB: eqa_answer_vocab.json
2026-01-06 15:44:40,910   INFO  ----------- R2R_AUG -----------
2026-01-06 15:44:40,910   INFO  cfg.Dataset.R2R_AUG.DIR: R2R
2026-01-06 15:44:40,910   INFO  ----------- SPLIT -----------
2026-01-06 15:44:40,910   INFO  cfg.Dataset.R2R_AUG.SPLIT.train: R2R_prevalent_aug_train_enc.jsonl
2026-01-06 15:44:40,910   INFO  ----------- REVERIE_AUG -----------
2026-01-06 15:44:40,910   INFO  cfg.Dataset.REVERIE_AUG.DIR: REVERIE
2026-01-06 15:44:40,910   INFO  cfg.Dataset.REVERIE_AUG.bbox_file: BBoxes.json
2026-01-06 15:44:40,910   INFO  ----------- SPLIT -----------
2026-01-06 15:44:40,910   INFO  cfg.Dataset.REVERIE_AUG.SPLIT.train: REVERIE_speaker_aug_enc.jsonl
2026-01-06 15:44:40,910   INFO  ----------- LLaVA -----------
2026-01-06 15:44:40,910   INFO  cfg.Dataset.LLaVA.DIR: LLaVA
2026-01-06 15:44:40,910   INFO  ----------- SPLIT -----------
2026-01-06 15:44:40,911   INFO  cfg.Dataset.LLaVA.SPLIT.train: detail_23k.json
2026-01-06 15:44:40,911   INFO  ----------- Pretrain -----------
2026-01-06 15:44:40,911   INFO  cfg.Pretrain.SOURCE: ['Tour3D', 'RoomTour', 'ScanQA', 'LLaVA']
2026-01-06 15:44:40,911   INFO  cfg.Pretrain.Ratio: [10, 20, 5, 2]
2026-01-06 15:44:40,911   INFO  ----------- LOSS_COEF -----------
2026-01-06 15:44:40,911   INFO  cfg.Pretrain.LOSS_COEF.R2R_AUG: 1
2026-01-06 15:44:40,911   INFO  cfg.Pretrain.LOSS_COEF.REVERIE_AUG: 1
2026-01-06 15:44:40,911   INFO  ----------- Multi -----------
2026-01-06 15:44:40,911   INFO  cfg.Multi.SOURCE: ['Tour3D', 'R2R', 'REVERIE', 'CVDN', 'SOON', 'ScanQA', 'LLaVA']
2026-01-06 15:44:40,911   INFO  cfg.Multi.Ratio: [10, 20, 5, 1, 5, 5, 5]
2026-01-06 15:44:40,911   INFO  ----------- LOSS_COEF -----------
2026-01-06 15:44:40,911   INFO  ----------- Model -----------
2026-01-06 15:44:40,911   INFO  cfg.Model.num_l_layers: 9
2026-01-06 15:44:40,911   INFO  cfg.Model.num_pano_layers: 2
2026-01-06 15:44:40,911   INFO  cfg.Model.num_x_layers: 4
2026-01-06 15:44:40,911   INFO  cfg.Model.graph_sprels: True
2026-01-06 15:44:40,911   INFO  cfg.Model.fusion: dynamic
2026-01-06 15:44:40,911   INFO  cfg.Model.enc_full_graph: True
2026-01-06 15:44:40,911   INFO  cfg.Model.expert_policy: spl
2026-01-06 15:44:40,912   INFO  ----------- Optim -----------
2026-01-06 15:44:40,912   INFO  ----------- val_max_action_len -----------
2026-01-06 15:44:40,912   INFO  cfg.Optim.val_max_action_len.R2R: 15
2026-01-06 15:44:40,912   INFO  cfg.Optim.val_max_action_len.REVERIE: 15
2026-01-06 15:44:40,912   INFO  cfg.Optim.val_max_action_len.CVDN: 30
2026-01-06 15:44:40,912   INFO  cfg.Optim.val_max_action_len.SOON: 20
2026-01-06 15:44:40,912   INFO  cfg.Optim.val_max_action_len.EQA: 15
2026-01-06 15:44:40,912   INFO  ----------- train_max_action_len -----------
2026-01-06 15:44:40,912   INFO  cfg.Optim.train_max_action_len.R2R: 15
2026-01-06 15:44:40,912   INFO  cfg.Optim.train_max_action_len.Tour3D: 15
2026-01-06 15:44:40,912   INFO  cfg.Optim.train_max_action_len.REVERIE: 15
2026-01-06 15:44:40,912   INFO  cfg.Optim.train_max_action_len.CVDN: 15
2026-01-06 15:44:40,912   INFO  cfg.Optim.train_max_action_len.SOON: 15
2026-01-06 15:44:40,912   INFO  cfg.Optim.train_max_action_len.EQA: 15
2026-01-06 15:44:40,912   INFO  cfg.Optim.train_max_action_len.R2R_AUG: 15
2026-01-06 15:44:40,912   INFO  cfg.Optim.train_max_action_len.REVERIE_AUG: 15
2026-01-06 15:44:44,321   INFO  [INFO] R2RDataset loaded with 4173 instructions, using splits: test
2026-01-06 15:44:44,323   INFO  
- Dataset: load 4173 R2R samples
- Dataset: load test split: 4173 samples in total
- Dataset: load test split: 18 scans in total
2026-01-06 15:44:44,323   INFO  R2R: 4173 samples loaded
2026-01-06 15:44:44,440   INFO  Initialize the model from config.
2026-01-06 15:46:11,104   INFO  model type: torch.bfloat16
2026-01-06 15:46:11,107   INFO  Trainable params: lang_model.model.embed_tokens.weight,lang_model.model.layers.0.self_attn.q_proj.weight,lang_model.model.layers.0.self_attn.k_proj.weight,lang_model.model.layers.0.self_attn.v_proj.weight,lang_model.model.layers.0.self_attn.o_proj.weight,lang_model.model.layers.0.mlp.gate_proj.weight,lang_model.model.layers.0.mlp.down_proj.weight,lang_model.model.layers.0.mlp.up_proj.weight,lang_model.model.layers.0.input_layernorm.weight,lang_model.model.layers.0.post_attention_layernorm.weight,lang_model.model.layers.1.self_attn.q_proj.weight,lang_model.model.layers.1.self_attn.k_proj.weight,lang_model.model.layers.1.self_attn.v_proj.weight,lang_model.model.layers.1.self_attn.o_proj.weight,lang_model.model.layers.1.mlp.gate_proj.weight,lang_model.model.layers.1.mlp.down_proj.weight,lang_model.model.layers.1.mlp.up_proj.weight,lang_model.model.layers.1.input_layernorm.weight,lang_model.model.layers.1.post_attention_layernorm.weight,lang_model.model.layers.2.self_attn.q_proj.weight,lang_model.model.layers.2.self_attn.k_proj.weight,lang_model.model.layers.2.self_attn.v_proj.weight,lang_model.model.layers.2.self_attn.o_proj.weight,lang_model.model.layers.2.mlp.gate_proj.weight,lang_model.model.layers.2.mlp.down_proj.weight,lang_model.model.layers.2.mlp.up_proj.weight,lang_model.model.layers.2.input_layernorm.weight,lang_model.model.layers.2.post_attention_layernorm.weight,lang_model.model.layers.3.self_attn.q_proj.weight,lang_model.model.layers.3.self_attn.k_proj.weight,lang_model.model.layers.3.self_attn.v_proj.weight,lang_model.model.layers.3.self_attn.o_proj.weight,lang_model.model.layers.3.mlp.gate_proj.weight,lang_model.model.layers.3.mlp.down_proj.weight,lang_model.model.layers.3.mlp.up_proj.weight,lang_model.model.layers.3.input_layernorm.weight,lang_model.model.layers.3.post_attention_layernorm.weight,lang_model.model.layers.4.self_attn.q_proj.weight,lang_model.model.layers.4.self_attn.k_proj.weight,lang_model.model.layers.4.self_attn.v_proj.weight,lang_model.model.layers.4.self_attn.o_proj.weight,lang_model.model.layers.4.mlp.gate_proj.weight,lang_model.model.layers.4.mlp.down_proj.weight,lang_model.model.layers.4.mlp.up_proj.weight,lang_model.model.layers.4.input_layernorm.weight,lang_model.model.layers.4.post_attention_layernorm.weight,lang_model.model.layers.5.self_attn.q_proj.weight,lang_model.model.layers.5.self_attn.k_proj.weight,lang_model.model.layers.5.self_attn.v_proj.weight,lang_model.model.layers.5.self_attn.o_proj.weight,lang_model.model.layers.5.mlp.gate_proj.weight,lang_model.model.layers.5.mlp.down_proj.weight,lang_model.model.layers.5.mlp.up_proj.weight,lang_model.model.layers.5.input_layernorm.weight,lang_model.model.layers.5.post_attention_layernorm.weight,lang_model.model.layers.6.self_attn.q_proj.weight,lang_model.model.layers.6.self_attn.k_proj.weight,lang_model.model.layers.6.self_attn.v_proj.weight,lang_model.model.layers.6.self_attn.o_proj.weight,lang_model.model.layers.6.mlp.gate_proj.weight,lang_model.model.layers.6.mlp.down_proj.weight,lang_model.model.layers.6.mlp.up_proj.weight,lang_model.model.layers.6.input_layernorm.weight,lang_model.model.layers.6.post_attention_layernorm.weight,lang_model.model.layers.7.self_attn.q_proj.weight,lang_model.model.layers.7.self_attn.k_proj.weight,lang_model.model.layers.7.self_attn.v_proj.weight,lang_model.model.layers.7.self_attn.o_proj.weight,lang_model.model.layers.7.mlp.gate_proj.weight,lang_model.model.layers.7.mlp.down_proj.weight,lang_model.model.layers.7.mlp.up_proj.weight,lang_model.model.layers.7.input_layernorm.weight,lang_model.model.layers.7.post_attention_layernorm.weight,lang_model.model.layers.8.self_attn.q_proj.weight,lang_model.model.layers.8.self_attn.k_proj.weight,lang_model.model.layers.8.self_attn.v_proj.weight,lang_model.model.layers.8.self_attn.o_proj.weight,lang_model.model.layers.8.mlp.gate_proj.weight,lang_model.model.layers.8.mlp.down_proj.weight,lang_model.model.layers.8.mlp.up_proj.weight,lang_model.model.layers.8.input_layernorm.weight,lang_model.model.layers.8.post_attention_layernorm.weight,lang_model.model.layers.9.self_attn.q_proj.weight,lang_model.model.layers.9.self_attn.k_proj.weight,lang_model.model.layers.9.self_attn.v_proj.weight,lang_model.model.layers.9.self_attn.o_proj.weight,lang_model.model.layers.9.mlp.gate_proj.weight,lang_model.model.layers.9.mlp.down_proj.weight,lang_model.model.layers.9.mlp.up_proj.weight,lang_model.model.layers.9.input_layernorm.weight,lang_model.model.layers.9.post_attention_layernorm.weight,lang_model.model.layers.10.self_attn.q_proj.weight,lang_model.model.layers.10.self_attn.k_proj.weight,lang_model.model.layers.10.self_attn.v_proj.weight,lang_model.model.layers.10.self_attn.o_proj.weight,lang_model.model.layers.10.mlp.gate_proj.weight,lang_model.model.layers.10.mlp.down_proj.weight,lang_model.model.layers.10.mlp.up_proj.weight,lang_model.model.layers.10.input_layernorm.weight,lang_model.model.layers.10.post_attention_layernorm.weight,lang_model.model.layers.11.self_attn.q_proj.weight,lang_model.model.layers.11.self_attn.k_proj.weight,lang_model.model.layers.11.self_attn.v_proj.weight,lang_model.model.layers.11.self_attn.o_proj.weight,lang_model.model.layers.11.mlp.gate_proj.weight,lang_model.model.layers.11.mlp.down_proj.weight,lang_model.model.layers.11.mlp.up_proj.weight,lang_model.model.layers.11.input_layernorm.weight,lang_model.model.layers.11.post_attention_layernorm.weight,lang_model.model.layers.12.self_attn.q_proj.weight,lang_model.model.layers.12.self_attn.k_proj.weight,lang_model.model.layers.12.self_attn.v_proj.weight,lang_model.model.layers.12.self_attn.o_proj.weight,lang_model.model.layers.12.mlp.gate_proj.weight,lang_model.model.layers.12.mlp.down_proj.weight,lang_model.model.layers.12.mlp.up_proj.weight,lang_model.model.layers.12.input_layernorm.weight,lang_model.model.layers.12.post_attention_layernorm.weight,lang_model.model.layers.13.self_attn.q_proj.weight,lang_model.model.layers.13.self_attn.k_proj.weight,lang_model.model.layers.13.self_attn.v_proj.weight,lang_model.model.layers.13.self_attn.o_proj.weight,lang_model.model.layers.13.mlp.gate_proj.weight,lang_model.model.layers.13.mlp.down_proj.weight,lang_model.model.layers.13.mlp.up_proj.weight,lang_model.model.layers.13.input_layernorm.weight,lang_model.model.layers.13.post_attention_layernorm.weight,lang_model.model.layers.14.self_attn.q_proj.weight,lang_model.model.layers.14.self_attn.k_proj.weight,lang_model.model.layers.14.self_attn.v_proj.weight,lang_model.model.layers.14.self_attn.o_proj.weight,lang_model.model.layers.14.mlp.gate_proj.weight,lang_model.model.layers.14.mlp.down_proj.weight,lang_model.model.layers.14.mlp.up_proj.weight,lang_model.model.layers.14.input_layernorm.weight,lang_model.model.layers.14.post_attention_layernorm.weight,lang_model.model.layers.15.self_attn.q_proj.weight,lang_model.model.layers.15.self_attn.k_proj.weight,lang_model.model.layers.15.self_attn.v_proj.weight,lang_model.model.layers.15.self_attn.o_proj.weight,lang_model.model.layers.15.mlp.gate_proj.weight,lang_model.model.layers.15.mlp.down_proj.weight,lang_model.model.layers.15.mlp.up_proj.weight,lang_model.model.layers.15.input_layernorm.weight,lang_model.model.layers.15.post_attention_layernorm.weight,lang_model.model.layers.16.self_attn.q_proj.weight,lang_model.model.layers.16.self_attn.k_proj.weight,lang_model.model.layers.16.self_attn.v_proj.weight,lang_model.model.layers.16.self_attn.o_proj.weight,lang_model.model.layers.16.mlp.gate_proj.weight,lang_model.model.layers.16.mlp.down_proj.weight,lang_model.model.layers.16.mlp.up_proj.weight,lang_model.model.layers.16.input_layernorm.weight,lang_model.model.layers.16.post_attention_layernorm.weight,lang_model.model.layers.17.self_attn.q_proj.weight,lang_model.model.layers.17.self_attn.k_proj.weight,lang_model.model.layers.17.self_attn.v_proj.weight,lang_model.model.layers.17.self_attn.o_proj.weight,lang_model.model.layers.17.mlp.gate_proj.weight,lang_model.model.layers.17.mlp.down_proj.weight,lang_model.model.layers.17.mlp.up_proj.weight,lang_model.model.layers.17.input_layernorm.weight,lang_model.model.layers.17.post_attention_layernorm.weight,lang_model.model.layers.18.self_attn.q_proj.weight,lang_model.model.layers.18.self_attn.k_proj.weight,lang_model.model.layers.18.self_attn.v_proj.weight,lang_model.model.layers.18.self_attn.o_proj.weight,lang_model.model.layers.18.mlp.gate_proj.weight,lang_model.model.layers.18.mlp.down_proj.weight,lang_model.model.layers.18.mlp.up_proj.weight,lang_model.model.layers.18.input_layernorm.weight,lang_model.model.layers.18.post_attention_layernorm.weight,lang_model.model.layers.19.self_attn.q_proj.weight,lang_model.model.layers.19.self_attn.k_proj.weight,lang_model.model.layers.19.self_attn.v_proj.weight,lang_model.model.layers.19.self_attn.o_proj.weight,lang_model.model.layers.19.mlp.gate_proj.weight,lang_model.model.layers.19.mlp.down_proj.weight,lang_model.model.layers.19.mlp.up_proj.weight,lang_model.model.layers.19.input_layernorm.weight,lang_model.model.layers.19.post_attention_layernorm.weight,lang_model.model.layers.20.self_attn.q_proj.weight,lang_model.model.layers.20.self_attn.k_proj.weight,lang_model.model.layers.20.self_attn.v_proj.weight,lang_model.model.layers.20.self_attn.o_proj.weight,lang_model.model.layers.20.mlp.gate_proj.weight,lang_model.model.layers.20.mlp.down_proj.weight,lang_model.model.layers.20.mlp.up_proj.weight,lang_model.model.layers.20.input_layernorm.weight,lang_model.model.layers.20.post_attention_layernorm.weight,lang_model.model.layers.21.self_attn.q_proj.weight,lang_model.model.layers.21.self_attn.k_proj.weight,lang_model.model.layers.21.self_attn.v_proj.weight,lang_model.model.layers.21.self_attn.o_proj.weight,lang_model.model.layers.21.mlp.gate_proj.weight,lang_model.model.layers.21.mlp.down_proj.weight,lang_model.model.layers.21.mlp.up_proj.weight,lang_model.model.layers.21.input_layernorm.weight,lang_model.model.layers.21.post_attention_layernorm.weight,lang_model.model.layers.22.self_attn.q_proj.weight,lang_model.model.layers.22.self_attn.k_proj.weight,lang_model.model.layers.22.self_attn.v_proj.weight,lang_model.model.layers.22.self_attn.o_proj.weight,lang_model.model.layers.22.mlp.gate_proj.weight,lang_model.model.layers.22.mlp.down_proj.weight,lang_model.model.layers.22.mlp.up_proj.weight,lang_model.model.layers.22.input_layernorm.weight,lang_model.model.layers.22.post_attention_layernorm.weight,lang_model.model.layers.23.self_attn.q_proj.weight,lang_model.model.layers.23.self_attn.k_proj.weight,lang_model.model.layers.23.self_attn.v_proj.weight,lang_model.model.layers.23.self_attn.o_proj.weight,lang_model.model.layers.23.mlp.gate_proj.weight,lang_model.model.layers.23.mlp.down_proj.weight,lang_model.model.layers.23.mlp.up_proj.weight,lang_model.model.layers.23.input_layernorm.weight,lang_model.model.layers.23.post_attention_layernorm.weight,lang_model.model.layers.24.self_attn.q_proj.weight,lang_model.model.layers.24.self_attn.k_proj.weight,lang_model.model.layers.24.self_attn.v_proj.weight,lang_model.model.layers.24.self_attn.o_proj.weight,lang_model.model.layers.24.mlp.gate_proj.weight,lang_model.model.layers.24.mlp.down_proj.weight,lang_model.model.layers.24.mlp.up_proj.weight,lang_model.model.layers.24.input_layernorm.weight,lang_model.model.layers.24.post_attention_layernorm.weight,lang_model.model.layers.25.self_attn.q_proj.weight,lang_model.model.layers.25.self_attn.k_proj.weight,lang_model.model.layers.25.self_attn.v_proj.weight,lang_model.model.layers.25.self_attn.o_proj.weight,lang_model.model.layers.25.mlp.gate_proj.weight,lang_model.model.layers.25.mlp.down_proj.weight,lang_model.model.layers.25.mlp.up_proj.weight,lang_model.model.layers.25.input_layernorm.weight,lang_model.model.layers.25.post_attention_layernorm.weight,lang_model.model.layers.26.self_attn.q_proj.weight,lang_model.model.layers.26.self_attn.k_proj.weight,lang_model.model.layers.26.self_attn.v_proj.weight,lang_model.model.layers.26.self_attn.o_proj.weight,lang_model.model.layers.26.mlp.gate_proj.weight,lang_model.model.layers.26.mlp.down_proj.weight,lang_model.model.layers.26.mlp.up_proj.weight,lang_model.model.layers.26.input_layernorm.weight,lang_model.model.layers.26.post_attention_layernorm.weight,lang_model.model.layers.27.self_attn.q_proj.weight,lang_model.model.layers.27.self_attn.k_proj.weight,lang_model.model.layers.27.self_attn.v_proj.weight,lang_model.model.layers.27.self_attn.o_proj.weight,lang_model.model.layers.27.mlp.gate_proj.weight,lang_model.model.layers.27.mlp.down_proj.weight,lang_model.model.layers.27.mlp.up_proj.weight,lang_model.model.layers.27.input_layernorm.weight,lang_model.model.layers.27.post_attention_layernorm.weight,lang_model.model.layers.28.self_attn.q_proj.weight,lang_model.model.layers.28.self_attn.k_proj.weight,lang_model.model.layers.28.self_attn.v_proj.weight,lang_model.model.layers.28.self_attn.o_proj.weight,lang_model.model.layers.28.mlp.gate_proj.weight,lang_model.model.layers.28.mlp.down_proj.weight,lang_model.model.layers.28.mlp.up_proj.weight,lang_model.model.layers.28.input_layernorm.weight,lang_model.model.layers.28.post_attention_layernorm.weight,lang_model.model.layers.29.self_attn.q_proj.weight,lang_model.model.layers.29.self_attn.k_proj.weight,lang_model.model.layers.29.self_attn.v_proj.weight,lang_model.model.layers.29.self_attn.o_proj.weight,lang_model.model.layers.29.mlp.gate_proj.weight,lang_model.model.layers.29.mlp.down_proj.weight,lang_model.model.layers.29.mlp.up_proj.weight,lang_model.model.layers.29.input_layernorm.weight,lang_model.model.layers.29.post_attention_layernorm.weight,lang_model.model.layers.30.self_attn.q_proj.weight,lang_model.model.layers.30.self_attn.k_proj.weight,lang_model.model.layers.30.self_attn.v_proj.weight,lang_model.model.layers.30.self_attn.o_proj.weight,lang_model.model.layers.30.mlp.gate_proj.weight,lang_model.model.layers.30.mlp.down_proj.weight,lang_model.model.layers.30.mlp.up_proj.weight,lang_model.model.layers.30.input_layernorm.weight,lang_model.model.layers.30.post_attention_layernorm.weight,lang_model.model.layers.31.self_attn.q_proj.weight,lang_model.model.layers.31.self_attn.k_proj.weight,lang_model.model.layers.31.self_attn.v_proj.weight,lang_model.model.layers.31.self_attn.o_proj.weight,lang_model.model.layers.31.mlp.gate_proj.weight,lang_model.model.layers.31.mlp.down_proj.weight,lang_model.model.layers.31.mlp.up_proj.weight,lang_model.model.layers.31.input_layernorm.weight,lang_model.model.layers.31.post_attention_layernorm.weight,lang_model.model.norm.weight,lang_model.lm_head.weight,img_embeddings.img_linear.weight,img_embeddings.img_linear.bias,img_embeddings.img_layer_norm.weight,img_embeddings.img_layer_norm.bias,img_embeddings.loc_linear.weight,img_embeddings.loc_linear.bias,img_embeddings.loc_layer_norm.weight,img_embeddings.loc_layer_norm.bias,img_embeddings.nav_type_embedding.weight,img_embeddings.layer_norm.weight,img_embeddings.layer_norm.bias,img_embeddings.pano_encoder.layers.0.self_attn.in_proj_weight,img_embeddings.pano_encoder.layers.0.self_attn.in_proj_bias,img_embeddings.pano_encoder.layers.0.self_attn.out_proj.weight,img_embeddings.pano_encoder.layers.0.self_attn.out_proj.bias,img_embeddings.pano_encoder.layers.0.linear1.weight,img_embeddings.pano_encoder.layers.0.linear1.bias,img_embeddings.pano_encoder.layers.0.linear2.weight,img_embeddings.pano_encoder.layers.0.linear2.bias,img_embeddings.pano_encoder.layers.0.norm1.weight,img_embeddings.pano_encoder.layers.0.norm1.bias,img_embeddings.pano_encoder.layers.0.norm2.weight,img_embeddings.pano_encoder.layers.0.norm2.bias,img_embeddings.pano_encoder.layers.1.self_attn.in_proj_weight,img_embeddings.pano_encoder.layers.1.self_attn.in_proj_bias,img_embeddings.pano_encoder.layers.1.self_attn.out_proj.weight,img_embeddings.pano_encoder.layers.1.self_attn.out_proj.bias,img_embeddings.pano_encoder.layers.1.linear1.weight,img_embeddings.pano_encoder.layers.1.linear1.bias,img_embeddings.pano_encoder.layers.1.linear2.weight,img_embeddings.pano_encoder.layers.1.linear2.bias,img_embeddings.pano_encoder.layers.1.norm1.weight,img_embeddings.pano_encoder.layers.1.norm1.bias,img_embeddings.pano_encoder.layers.1.norm2.weight,img_embeddings.pano_encoder.layers.1.norm2.bias,img_embeddings.pano_encoder.norm.weight,img_embeddings.pano_encoder.norm.bias,img_embeddings.mapper.weight,img_embeddings.mapper.bias,token_type_embeddings.weight,gmap_pos_embeddings.0.weight,gmap_pos_embeddings.0.bias,gmap_pos_embeddings.1.weight,gmap_pos_embeddings.1.bias,gmap_step_embeddings.weight,vp_pos_embeddings.0.weight,vp_pos_embeddings.0.bias,vp_pos_embeddings.1.weight,vp_pos_embeddings.1.bias,obj_pos_embeddings.0.weight,obj_pos_embeddings.0.bias,obj_pos_embeddings.1.weight,obj_pos_embeddings.1.bias,og_head.0.weight,og_head.0.bias,out_head.0.weight,out_head.0.bias
2026-01-06 15:46:11,108   INFO  *************** init model *************** 
2026-01-06 15:46:13,680   INFO  Loading checkpoint from /data/wanghaoxuan/roomtour3d.pt
2026-01-06 15:46:18,055   INFO  Ignore weight img_embeddings.obj_projector.0.weight: torch.Size([4096, 768])
2026-01-06 15:46:18,056   INFO  Ignore weight img_embeddings.obj_projector.0.bias: torch.Size([4096])
2026-01-06 15:46:18,056   INFO  Ignore weight img_embeddings.obj_projector.1.weight: torch.Size([4096])
2026-01-06 15:46:18,057   INFO  Ignore weight img_embeddings.obj_projector.1.bias: torch.Size([4096])
2026-01-06 15:46:19,066   INFO  <All keys matched successfully>
2026-01-06 15:46:19,514   INFO  model initialized with 6770.32 M trainable parameters
2026-01-06 15:46:19,515   INFO  Training with a single process
2026-01-06 15:46:19,515   INFO  **************************** Test ****************************
2026-01-06 15:46:19,517   INFO  ***** validate test split on R2R task *****
2026-01-06 16:18:34,134   INFO  
[Eval] test epoch 0

2026-01-06 16:36:16,011   INFO  **********************Start logging**********************
2026-01-06 16:36:16,012   INFO  CUDA_VISIBLE_DEVICES=0
2026-01-06 16:36:16,012   INFO  data_dir         /data/wanghaoxuan/data
2026-01-06 16:36:16,012   INFO  cfg_file         configs/multi.yaml
2026-01-06 16:36:16,012   INFO  pretrained_model_name_or_path /data/wanghaoxuan/data/models/Vicuna-7B
2026-01-06 16:36:16,012   INFO  off_batch_task   False
2026-01-06 16:36:16,012   INFO  debug            False
2026-01-06 16:36:16,012   INFO  few_shot         None
2026-01-06 16:36:16,012   INFO  tour3d_nav_head  False
2026-01-06 16:36:16,012   INFO  seed             0
2026-01-06 16:36:16,012   INFO  num_epochs       30
2026-01-06 16:36:16,012   INFO  resume_from_checkpoint /data/wanghaoxuan/roomtour3d.pt
2026-01-06 16:36:16,012   INFO  from_scratch     False
2026-01-06 16:36:16,012   INFO  batch_size       4
2026-01-06 16:36:16,012   INFO  val_batch_size   2
2026-01-06 16:36:16,012   INFO  lr               1e-05
2026-01-06 16:36:16,012   INFO  feat_dropout     0.4
2026-01-06 16:36:16,012   INFO  num_warmup_steps 0
2026-01-06 16:36:16,012   INFO  num_steps_per_epoch -1
2026-01-06 16:36:16,012   INFO  gradient_accumulation_step 2
2026-01-06 16:36:16,013   INFO  precision        amp_bf16
2026-01-06 16:36:16,013   INFO  workers          0
2026-01-06 16:36:16,013   INFO  gpu              0
2026-01-06 16:36:16,013   INFO  world_size       1
2026-01-06 16:36:16,013   INFO  local_rank       0
2026-01-06 16:36:16,013   INFO  dist_url         env://
2026-01-06 16:36:16,013   INFO  dist_backend     nccl
2026-01-06 16:36:16,013   INFO  horovod          False
2026-01-06 16:36:16,013   INFO  no_set_device_rank False
2026-01-06 16:36:16,013   INFO  output_dir       build/eval
2026-01-06 16:36:16,013   INFO  max_saved_checkpoints 0
2026-01-06 16:36:16,013   INFO  save_ckpt_per_epochs 10
2026-01-06 16:36:16,013   INFO  save_latest_states False
2026-01-06 16:36:16,013   INFO  save_pred_results True
2026-01-06 16:36:16,013   INFO  save_detail_results False
2026-01-06 16:36:16,013   INFO  mode             test
2026-01-06 16:36:16,013   INFO  stage            multi
2026-01-06 16:36:16,013   INFO  ignoreid         -100
2026-01-06 16:36:16,013   INFO  enable_og        True
2026-01-06 16:36:16,014   INFO  enable_summarize False
2026-01-06 16:36:16,014   INFO  enable_fgr2r     False
2026-01-06 16:36:16,014   INFO  disable_nav      False
2026-01-06 16:36:16,014   INFO  gen_loss_coef    1.0
2026-01-06 16:36:16,014   INFO  obj_loss_coef    1.0
2026-01-06 16:36:16,014   INFO  teacher_forcing_coef 1.0
2026-01-06 16:36:16,014   INFO  fuse_obj         False
2026-01-06 16:36:16,014   INFO  use_lora         False
2026-01-06 16:36:16,014   INFO  lora_rank        8
2026-01-06 16:36:16,014   INFO  lora_alpha       16
2026-01-06 16:36:16,014   INFO  lora_dropout     0.05
2026-01-06 16:36:16,014   INFO  lora_target      None
2026-01-06 16:36:16,014   INFO  freeze_llama     False
2026-01-06 16:36:16,014   INFO  tune_token_emb   False
2026-01-06 16:36:16,014   INFO  no_loc_fts       False
2026-01-06 16:36:16,014   INFO  multi_endpoints  1
2026-01-06 16:36:16,014   INFO  path_type        trusted_path
2026-01-06 16:36:16,014   INFO  test_datasets    ['REVERIE']
2026-01-06 16:36:16,014   INFO  validation_split test
2026-01-06 16:36:16,014   INFO  do_sample        True
2026-01-06 16:36:16,014   INFO  temperature      0.01
2026-01-06 16:36:16,015   INFO  max_datapoints   None
2026-01-06 16:36:16,015   INFO  rank             0
2026-01-06 16:36:16,015   INFO  distributed      False
2026-01-06 16:36:16,015   INFO  device           cuda:0
2026-01-06 16:36:16,015   INFO  image_feat_size  1024
2026-01-06 16:36:16,015   INFO  obj_feat_size    768
2026-01-06 16:36:16,015   INFO  angle_feat_size  4
2026-01-06 16:36:16,015   INFO  enc_full_graph   True
2026-01-06 16:36:16,015   INFO  expert_policy    spl
2026-01-06 16:36:16,015   INFO  num_pano_layers  2
2026-01-06 16:36:16,015   INFO  ----------- Feature -----------
2026-01-06 16:36:16,015   INFO  cfg.Feature.object_feature_type: 
2026-01-06 16:36:16,015   INFO  cfg.Feature.angle_feat_size: 4
2026-01-06 16:36:16,015   INFO  cfg.Feature.max_objects: 70
2026-01-06 16:36:16,015   INFO  cfg.Feature.image_feat_size: 1024
2026-01-06 16:36:16,015   INFO  ----------- feature_database -----------
2026-01-06 16:36:16,015   INFO  cfg.Feature.feature_database.mp3d: eva_features/mp3d_EVA02-CLIP-L-14-336.hdf5
2026-01-06 16:36:16,015   INFO  cfg.Feature.feature_database.scan_qa: eva_features/scanqa_EVA02-CLIP-L-14-336.hdf5
2026-01-06 16:36:16,015   INFO  cfg.Feature.feature_database.room_tour: eva_features/web_obj_prog_p1_EVA02-CLIP-L-14-336.hdf5.bak
2026-01-06 16:36:16,015   INFO  cfg.Feature.feature_database.room3d_tour: eva_features/web_3d_obj_prog_crop_p1_EVA02-CLIP-L-14-336.hdf5
2026-01-06 16:36:16,016   INFO  cfg.Feature.feature_database.coco: eva_features/coco_EVA02-CLIP-L-14-336.hdf5
2026-01-06 16:36:16,016   INFO  cfg.Feature.obj_feat_size: 768
2026-01-06 16:36:16,016   INFO  ----------- object_database -----------
2026-01-06 16:36:16,016   INFO  cfg.Feature.object_database.reverie: obj_features/reverie_obj_feat
2026-01-06 16:36:16,016   INFO  cfg.Feature.object_database.soon: obj_features/soon_obj_feat
2026-01-06 16:36:16,016   INFO  ----------- Dataset -----------
2026-01-06 16:36:16,016   INFO  ----------- R2R -----------
2026-01-06 16:36:16,016   INFO  cfg.Dataset.R2R.DIR: R2R
2026-01-06 16:36:16,016   INFO  ----------- SPLIT -----------
2026-01-06 16:36:16,016   INFO  cfg.Dataset.R2R.SPLIT.train: FGR2R_train.json
2026-01-06 16:36:16,016   INFO  cfg.Dataset.R2R.SPLIT.val_seen: R2R_val_seen_enc.json
2026-01-06 16:36:16,016   INFO  cfg.Dataset.R2R.SPLIT.val_unseen: R2R_val_unseen_enc.json
2026-01-06 16:36:16,016   INFO  cfg.Dataset.R2R.SPLIT.test: R2R_test_enc.json
2026-01-06 16:36:16,016   INFO  ----------- REVERIE -----------
2026-01-06 16:36:16,016   INFO  cfg.Dataset.REVERIE.DIR: REVERIE
2026-01-06 16:36:16,016   INFO  cfg.Dataset.REVERIE.bbox_file: BBoxes.json
2026-01-06 16:36:16,016   INFO  ----------- SPLIT -----------
2026-01-06 16:36:16,016   INFO  cfg.Dataset.REVERIE.SPLIT.train: REVERIE_train_enc.json
2026-01-06 16:36:16,016   INFO  cfg.Dataset.REVERIE.SPLIT.val_seen: REVERIE_val_seen_enc.json
2026-01-06 16:36:16,016   INFO  cfg.Dataset.REVERIE.SPLIT.val_unseen: REVERIE_val_unseen_enc.json
2026-01-06 16:36:16,017   INFO  cfg.Dataset.REVERIE.SPLIT.test: REVERIE_test_enc.json
2026-01-06 16:36:16,017   INFO  ----------- CVDN -----------
2026-01-06 16:36:16,017   INFO  cfg.Dataset.CVDN.DIR: CVDN
2026-01-06 16:36:16,017   INFO  ----------- SPLIT -----------
2026-01-06 16:36:16,017   INFO  cfg.Dataset.CVDN.SPLIT.train: train.json
2026-01-06 16:36:16,017   INFO  cfg.Dataset.CVDN.SPLIT.val_seen: val_seen.json
2026-01-06 16:36:16,017   INFO  cfg.Dataset.CVDN.SPLIT.val_unseen: val_unseen.json
2026-01-06 16:36:16,017   INFO  cfg.Dataset.CVDN.SPLIT.test: test_cleaned.json
2026-01-06 16:36:16,017   INFO  ----------- SOON -----------
2026-01-06 16:36:16,017   INFO  cfg.Dataset.SOON.DIR: SOON
2026-01-06 16:36:16,017   INFO  ----------- SPLIT -----------
2026-01-06 16:36:16,017   INFO  cfg.Dataset.SOON.SPLIT.train: train_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 16:36:16,017   INFO  cfg.Dataset.SOON.SPLIT.val_seen: val_unseen_instrs_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 16:36:16,017   INFO  cfg.Dataset.SOON.SPLIT.val_unseen: val_unseen_house_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 16:36:16,017   INFO  cfg.Dataset.SOON.SPLIT.test: test_v2_enc.jsonl
2026-01-06 16:36:16,017   INFO  ----------- ScanQA -----------
2026-01-06 16:36:16,017   INFO  cfg.Dataset.ScanQA.DIR: ScanQA
2026-01-06 16:36:16,017   INFO  ----------- SPLIT -----------
2026-01-06 16:36:16,017   INFO  cfg.Dataset.ScanQA.SPLIT.train: ScanQA_v1.0_train_reformat.json
2026-01-06 16:36:16,018   INFO  cfg.Dataset.ScanQA.SPLIT.val_unseen: ScanQA_v1.0_val_reformat.json
2026-01-06 16:36:16,018   INFO  cfg.Dataset.ScanQA.SPLIT.test_wo_obj: ScanQA_v1.0_test_wo_obj_reformat.json
2026-01-06 16:36:16,018   INFO  cfg.Dataset.ScanQA.SPLIT.test_w_obj: ScanQA_v1.0_test_w_obj_reformat.json
2026-01-06 16:36:16,018   INFO  ----------- RoomTour -----------
2026-01-06 16:36:16,018   INFO  cfg.Dataset.RoomTour.DIR: RoomTour
2026-01-06 16:36:16,018   INFO  ----------- SPLIT -----------
2026-01-06 16:36:16,018   INFO  cfg.Dataset.RoomTour.SPLIT.train: p1_train_reformat.json
2026-01-06 16:36:16,018   INFO  ----------- Tour3D -----------
2026-01-06 16:36:16,018   INFO  cfg.Dataset.Tour3D.DIR: RoomTour
2026-01-06 16:36:16,018   INFO  ----------- SPLIT -----------
2026-01-06 16:36:16,018   INFO  cfg.Dataset.Tour3D.SPLIT.train: p1_train_colmap_trajectory_tour3d.json
2026-01-06 16:36:16,018   INFO  ----------- EQA -----------
2026-01-06 16:36:16,018   INFO  cfg.Dataset.EQA.DIR: EQA_MP3D
2026-01-06 16:36:16,018   INFO  ----------- SPLIT -----------
2026-01-06 16:36:16,018   INFO  cfg.Dataset.EQA.SPLIT.val_unseen: eqa_val_enc.json
2026-01-06 16:36:16,018   INFO  cfg.Dataset.EQA.ANSWER_VOCAB: eqa_answer_vocab.json
2026-01-06 16:36:16,018   INFO  ----------- R2R_AUG -----------
2026-01-06 16:36:16,018   INFO  cfg.Dataset.R2R_AUG.DIR: R2R
2026-01-06 16:36:16,018   INFO  ----------- SPLIT -----------
2026-01-06 16:36:16,018   INFO  cfg.Dataset.R2R_AUG.SPLIT.train: R2R_prevalent_aug_train_enc.jsonl
2026-01-06 16:36:16,019   INFO  ----------- REVERIE_AUG -----------
2026-01-06 16:36:16,019   INFO  cfg.Dataset.REVERIE_AUG.DIR: REVERIE
2026-01-06 16:36:16,019   INFO  cfg.Dataset.REVERIE_AUG.bbox_file: BBoxes.json
2026-01-06 16:36:16,019   INFO  ----------- SPLIT -----------
2026-01-06 16:36:16,019   INFO  cfg.Dataset.REVERIE_AUG.SPLIT.train: REVERIE_speaker_aug_enc.jsonl
2026-01-06 16:36:16,019   INFO  ----------- LLaVA -----------
2026-01-06 16:36:16,019   INFO  cfg.Dataset.LLaVA.DIR: LLaVA
2026-01-06 16:36:16,019   INFO  ----------- SPLIT -----------
2026-01-06 16:36:16,019   INFO  cfg.Dataset.LLaVA.SPLIT.train: detail_23k.json
2026-01-06 16:36:16,019   INFO  ----------- Pretrain -----------
2026-01-06 16:36:16,019   INFO  cfg.Pretrain.SOURCE: ['Tour3D', 'RoomTour', 'ScanQA', 'LLaVA']
2026-01-06 16:36:16,019   INFO  cfg.Pretrain.Ratio: [10, 20, 5, 2]
2026-01-06 16:36:16,019   INFO  ----------- LOSS_COEF -----------
2026-01-06 16:36:16,019   INFO  cfg.Pretrain.LOSS_COEF.R2R_AUG: 1
2026-01-06 16:36:16,019   INFO  cfg.Pretrain.LOSS_COEF.REVERIE_AUG: 1
2026-01-06 16:36:16,019   INFO  ----------- Multi -----------
2026-01-06 16:36:16,019   INFO  cfg.Multi.SOURCE: ['Tour3D', 'R2R', 'REVERIE', 'CVDN', 'SOON', 'ScanQA', 'LLaVA']
2026-01-06 16:36:16,019   INFO  cfg.Multi.Ratio: [10, 20, 5, 1, 5, 5, 5]
2026-01-06 16:36:16,019   INFO  ----------- LOSS_COEF -----------
2026-01-06 16:36:16,019   INFO  ----------- Model -----------
2026-01-06 16:36:16,020   INFO  cfg.Model.num_l_layers: 9
2026-01-06 16:36:16,020   INFO  cfg.Model.num_pano_layers: 2
2026-01-06 16:36:16,020   INFO  cfg.Model.num_x_layers: 4
2026-01-06 16:36:16,020   INFO  cfg.Model.graph_sprels: True
2026-01-06 16:36:16,020   INFO  cfg.Model.fusion: dynamic
2026-01-06 16:36:16,020   INFO  cfg.Model.enc_full_graph: True
2026-01-06 16:36:16,020   INFO  cfg.Model.expert_policy: spl
2026-01-06 16:36:16,020   INFO  ----------- Optim -----------
2026-01-06 16:36:16,020   INFO  ----------- val_max_action_len -----------
2026-01-06 16:36:16,020   INFO  cfg.Optim.val_max_action_len.R2R: 15
2026-01-06 16:36:16,020   INFO  cfg.Optim.val_max_action_len.REVERIE: 15
2026-01-06 16:36:16,020   INFO  cfg.Optim.val_max_action_len.CVDN: 30
2026-01-06 16:36:16,020   INFO  cfg.Optim.val_max_action_len.SOON: 20
2026-01-06 16:36:16,020   INFO  cfg.Optim.val_max_action_len.EQA: 15
2026-01-06 16:36:16,020   INFO  ----------- train_max_action_len -----------
2026-01-06 16:36:16,020   INFO  cfg.Optim.train_max_action_len.R2R: 15
2026-01-06 16:36:16,020   INFO  cfg.Optim.train_max_action_len.Tour3D: 15
2026-01-06 16:36:16,020   INFO  cfg.Optim.train_max_action_len.REVERIE: 15
2026-01-06 16:36:16,020   INFO  cfg.Optim.train_max_action_len.CVDN: 15
2026-01-06 16:36:16,021   INFO  cfg.Optim.train_max_action_len.SOON: 15
2026-01-06 16:36:16,021   INFO  cfg.Optim.train_max_action_len.EQA: 15
2026-01-06 16:36:16,021   INFO  cfg.Optim.train_max_action_len.R2R_AUG: 15
2026-01-06 16:36:16,021   INFO  cfg.Optim.train_max_action_len.REVERIE_AUG: 15
2026-01-06 16:36:19,330   INFO  [INFO] REVERIEDataset loaded with 6292 instructions, using splits: test
2026-01-06 16:36:19,331   INFO  
- Dataset: load 6292 REVERIE samples
- Dataset: load test split: 6292 samples in total
- Dataset: load test split: 16 scans in total
2026-01-06 16:36:19,331   INFO  REVERIE: 6292 samples loaded
2026-01-06 16:36:19,451   INFO  Initialize the model from config.
2026-01-06 16:37:45,460   INFO  model type: torch.bfloat16
2026-01-06 16:37:45,463   INFO  Trainable params: lang_model.model.embed_tokens.weight,lang_model.model.layers.0.self_attn.q_proj.weight,lang_model.model.layers.0.self_attn.k_proj.weight,lang_model.model.layers.0.self_attn.v_proj.weight,lang_model.model.layers.0.self_attn.o_proj.weight,lang_model.model.layers.0.mlp.gate_proj.weight,lang_model.model.layers.0.mlp.down_proj.weight,lang_model.model.layers.0.mlp.up_proj.weight,lang_model.model.layers.0.input_layernorm.weight,lang_model.model.layers.0.post_attention_layernorm.weight,lang_model.model.layers.1.self_attn.q_proj.weight,lang_model.model.layers.1.self_attn.k_proj.weight,lang_model.model.layers.1.self_attn.v_proj.weight,lang_model.model.layers.1.self_attn.o_proj.weight,lang_model.model.layers.1.mlp.gate_proj.weight,lang_model.model.layers.1.mlp.down_proj.weight,lang_model.model.layers.1.mlp.up_proj.weight,lang_model.model.layers.1.input_layernorm.weight,lang_model.model.layers.1.post_attention_layernorm.weight,lang_model.model.layers.2.self_attn.q_proj.weight,lang_model.model.layers.2.self_attn.k_proj.weight,lang_model.model.layers.2.self_attn.v_proj.weight,lang_model.model.layers.2.self_attn.o_proj.weight,lang_model.model.layers.2.mlp.gate_proj.weight,lang_model.model.layers.2.mlp.down_proj.weight,lang_model.model.layers.2.mlp.up_proj.weight,lang_model.model.layers.2.input_layernorm.weight,lang_model.model.layers.2.post_attention_layernorm.weight,lang_model.model.layers.3.self_attn.q_proj.weight,lang_model.model.layers.3.self_attn.k_proj.weight,lang_model.model.layers.3.self_attn.v_proj.weight,lang_model.model.layers.3.self_attn.o_proj.weight,lang_model.model.layers.3.mlp.gate_proj.weight,lang_model.model.layers.3.mlp.down_proj.weight,lang_model.model.layers.3.mlp.up_proj.weight,lang_model.model.layers.3.input_layernorm.weight,lang_model.model.layers.3.post_attention_layernorm.weight,lang_model.model.layers.4.self_attn.q_proj.weight,lang_model.model.layers.4.self_attn.k_proj.weight,lang_model.model.layers.4.self_attn.v_proj.weight,lang_model.model.layers.4.self_attn.o_proj.weight,lang_model.model.layers.4.mlp.gate_proj.weight,lang_model.model.layers.4.mlp.down_proj.weight,lang_model.model.layers.4.mlp.up_proj.weight,lang_model.model.layers.4.input_layernorm.weight,lang_model.model.layers.4.post_attention_layernorm.weight,lang_model.model.layers.5.self_attn.q_proj.weight,lang_model.model.layers.5.self_attn.k_proj.weight,lang_model.model.layers.5.self_attn.v_proj.weight,lang_model.model.layers.5.self_attn.o_proj.weight,lang_model.model.layers.5.mlp.gate_proj.weight,lang_model.model.layers.5.mlp.down_proj.weight,lang_model.model.layers.5.mlp.up_proj.weight,lang_model.model.layers.5.input_layernorm.weight,lang_model.model.layers.5.post_attention_layernorm.weight,lang_model.model.layers.6.self_attn.q_proj.weight,lang_model.model.layers.6.self_attn.k_proj.weight,lang_model.model.layers.6.self_attn.v_proj.weight,lang_model.model.layers.6.self_attn.o_proj.weight,lang_model.model.layers.6.mlp.gate_proj.weight,lang_model.model.layers.6.mlp.down_proj.weight,lang_model.model.layers.6.mlp.up_proj.weight,lang_model.model.layers.6.input_layernorm.weight,lang_model.model.layers.6.post_attention_layernorm.weight,lang_model.model.layers.7.self_attn.q_proj.weight,lang_model.model.layers.7.self_attn.k_proj.weight,lang_model.model.layers.7.self_attn.v_proj.weight,lang_model.model.layers.7.self_attn.o_proj.weight,lang_model.model.layers.7.mlp.gate_proj.weight,lang_model.model.layers.7.mlp.down_proj.weight,lang_model.model.layers.7.mlp.up_proj.weight,lang_model.model.layers.7.input_layernorm.weight,lang_model.model.layers.7.post_attention_layernorm.weight,lang_model.model.layers.8.self_attn.q_proj.weight,lang_model.model.layers.8.self_attn.k_proj.weight,lang_model.model.layers.8.self_attn.v_proj.weight,lang_model.model.layers.8.self_attn.o_proj.weight,lang_model.model.layers.8.mlp.gate_proj.weight,lang_model.model.layers.8.mlp.down_proj.weight,lang_model.model.layers.8.mlp.up_proj.weight,lang_model.model.layers.8.input_layernorm.weight,lang_model.model.layers.8.post_attention_layernorm.weight,lang_model.model.layers.9.self_attn.q_proj.weight,lang_model.model.layers.9.self_attn.k_proj.weight,lang_model.model.layers.9.self_attn.v_proj.weight,lang_model.model.layers.9.self_attn.o_proj.weight,lang_model.model.layers.9.mlp.gate_proj.weight,lang_model.model.layers.9.mlp.down_proj.weight,lang_model.model.layers.9.mlp.up_proj.weight,lang_model.model.layers.9.input_layernorm.weight,lang_model.model.layers.9.post_attention_layernorm.weight,lang_model.model.layers.10.self_attn.q_proj.weight,lang_model.model.layers.10.self_attn.k_proj.weight,lang_model.model.layers.10.self_attn.v_proj.weight,lang_model.model.layers.10.self_attn.o_proj.weight,lang_model.model.layers.10.mlp.gate_proj.weight,lang_model.model.layers.10.mlp.down_proj.weight,lang_model.model.layers.10.mlp.up_proj.weight,lang_model.model.layers.10.input_layernorm.weight,lang_model.model.layers.10.post_attention_layernorm.weight,lang_model.model.layers.11.self_attn.q_proj.weight,lang_model.model.layers.11.self_attn.k_proj.weight,lang_model.model.layers.11.self_attn.v_proj.weight,lang_model.model.layers.11.self_attn.o_proj.weight,lang_model.model.layers.11.mlp.gate_proj.weight,lang_model.model.layers.11.mlp.down_proj.weight,lang_model.model.layers.11.mlp.up_proj.weight,lang_model.model.layers.11.input_layernorm.weight,lang_model.model.layers.11.post_attention_layernorm.weight,lang_model.model.layers.12.self_attn.q_proj.weight,lang_model.model.layers.12.self_attn.k_proj.weight,lang_model.model.layers.12.self_attn.v_proj.weight,lang_model.model.layers.12.self_attn.o_proj.weight,lang_model.model.layers.12.mlp.gate_proj.weight,lang_model.model.layers.12.mlp.down_proj.weight,lang_model.model.layers.12.mlp.up_proj.weight,lang_model.model.layers.12.input_layernorm.weight,lang_model.model.layers.12.post_attention_layernorm.weight,lang_model.model.layers.13.self_attn.q_proj.weight,lang_model.model.layers.13.self_attn.k_proj.weight,lang_model.model.layers.13.self_attn.v_proj.weight,lang_model.model.layers.13.self_attn.o_proj.weight,lang_model.model.layers.13.mlp.gate_proj.weight,lang_model.model.layers.13.mlp.down_proj.weight,lang_model.model.layers.13.mlp.up_proj.weight,lang_model.model.layers.13.input_layernorm.weight,lang_model.model.layers.13.post_attention_layernorm.weight,lang_model.model.layers.14.self_attn.q_proj.weight,lang_model.model.layers.14.self_attn.k_proj.weight,lang_model.model.layers.14.self_attn.v_proj.weight,lang_model.model.layers.14.self_attn.o_proj.weight,lang_model.model.layers.14.mlp.gate_proj.weight,lang_model.model.layers.14.mlp.down_proj.weight,lang_model.model.layers.14.mlp.up_proj.weight,lang_model.model.layers.14.input_layernorm.weight,lang_model.model.layers.14.post_attention_layernorm.weight,lang_model.model.layers.15.self_attn.q_proj.weight,lang_model.model.layers.15.self_attn.k_proj.weight,lang_model.model.layers.15.self_attn.v_proj.weight,lang_model.model.layers.15.self_attn.o_proj.weight,lang_model.model.layers.15.mlp.gate_proj.weight,lang_model.model.layers.15.mlp.down_proj.weight,lang_model.model.layers.15.mlp.up_proj.weight,lang_model.model.layers.15.input_layernorm.weight,lang_model.model.layers.15.post_attention_layernorm.weight,lang_model.model.layers.16.self_attn.q_proj.weight,lang_model.model.layers.16.self_attn.k_proj.weight,lang_model.model.layers.16.self_attn.v_proj.weight,lang_model.model.layers.16.self_attn.o_proj.weight,lang_model.model.layers.16.mlp.gate_proj.weight,lang_model.model.layers.16.mlp.down_proj.weight,lang_model.model.layers.16.mlp.up_proj.weight,lang_model.model.layers.16.input_layernorm.weight,lang_model.model.layers.16.post_attention_layernorm.weight,lang_model.model.layers.17.self_attn.q_proj.weight,lang_model.model.layers.17.self_attn.k_proj.weight,lang_model.model.layers.17.self_attn.v_proj.weight,lang_model.model.layers.17.self_attn.o_proj.weight,lang_model.model.layers.17.mlp.gate_proj.weight,lang_model.model.layers.17.mlp.down_proj.weight,lang_model.model.layers.17.mlp.up_proj.weight,lang_model.model.layers.17.input_layernorm.weight,lang_model.model.layers.17.post_attention_layernorm.weight,lang_model.model.layers.18.self_attn.q_proj.weight,lang_model.model.layers.18.self_attn.k_proj.weight,lang_model.model.layers.18.self_attn.v_proj.weight,lang_model.model.layers.18.self_attn.o_proj.weight,lang_model.model.layers.18.mlp.gate_proj.weight,lang_model.model.layers.18.mlp.down_proj.weight,lang_model.model.layers.18.mlp.up_proj.weight,lang_model.model.layers.18.input_layernorm.weight,lang_model.model.layers.18.post_attention_layernorm.weight,lang_model.model.layers.19.self_attn.q_proj.weight,lang_model.model.layers.19.self_attn.k_proj.weight,lang_model.model.layers.19.self_attn.v_proj.weight,lang_model.model.layers.19.self_attn.o_proj.weight,lang_model.model.layers.19.mlp.gate_proj.weight,lang_model.model.layers.19.mlp.down_proj.weight,lang_model.model.layers.19.mlp.up_proj.weight,lang_model.model.layers.19.input_layernorm.weight,lang_model.model.layers.19.post_attention_layernorm.weight,lang_model.model.layers.20.self_attn.q_proj.weight,lang_model.model.layers.20.self_attn.k_proj.weight,lang_model.model.layers.20.self_attn.v_proj.weight,lang_model.model.layers.20.self_attn.o_proj.weight,lang_model.model.layers.20.mlp.gate_proj.weight,lang_model.model.layers.20.mlp.down_proj.weight,lang_model.model.layers.20.mlp.up_proj.weight,lang_model.model.layers.20.input_layernorm.weight,lang_model.model.layers.20.post_attention_layernorm.weight,lang_model.model.layers.21.self_attn.q_proj.weight,lang_model.model.layers.21.self_attn.k_proj.weight,lang_model.model.layers.21.self_attn.v_proj.weight,lang_model.model.layers.21.self_attn.o_proj.weight,lang_model.model.layers.21.mlp.gate_proj.weight,lang_model.model.layers.21.mlp.down_proj.weight,lang_model.model.layers.21.mlp.up_proj.weight,lang_model.model.layers.21.input_layernorm.weight,lang_model.model.layers.21.post_attention_layernorm.weight,lang_model.model.layers.22.self_attn.q_proj.weight,lang_model.model.layers.22.self_attn.k_proj.weight,lang_model.model.layers.22.self_attn.v_proj.weight,lang_model.model.layers.22.self_attn.o_proj.weight,lang_model.model.layers.22.mlp.gate_proj.weight,lang_model.model.layers.22.mlp.down_proj.weight,lang_model.model.layers.22.mlp.up_proj.weight,lang_model.model.layers.22.input_layernorm.weight,lang_model.model.layers.22.post_attention_layernorm.weight,lang_model.model.layers.23.self_attn.q_proj.weight,lang_model.model.layers.23.self_attn.k_proj.weight,lang_model.model.layers.23.self_attn.v_proj.weight,lang_model.model.layers.23.self_attn.o_proj.weight,lang_model.model.layers.23.mlp.gate_proj.weight,lang_model.model.layers.23.mlp.down_proj.weight,lang_model.model.layers.23.mlp.up_proj.weight,lang_model.model.layers.23.input_layernorm.weight,lang_model.model.layers.23.post_attention_layernorm.weight,lang_model.model.layers.24.self_attn.q_proj.weight,lang_model.model.layers.24.self_attn.k_proj.weight,lang_model.model.layers.24.self_attn.v_proj.weight,lang_model.model.layers.24.self_attn.o_proj.weight,lang_model.model.layers.24.mlp.gate_proj.weight,lang_model.model.layers.24.mlp.down_proj.weight,lang_model.model.layers.24.mlp.up_proj.weight,lang_model.model.layers.24.input_layernorm.weight,lang_model.model.layers.24.post_attention_layernorm.weight,lang_model.model.layers.25.self_attn.q_proj.weight,lang_model.model.layers.25.self_attn.k_proj.weight,lang_model.model.layers.25.self_attn.v_proj.weight,lang_model.model.layers.25.self_attn.o_proj.weight,lang_model.model.layers.25.mlp.gate_proj.weight,lang_model.model.layers.25.mlp.down_proj.weight,lang_model.model.layers.25.mlp.up_proj.weight,lang_model.model.layers.25.input_layernorm.weight,lang_model.model.layers.25.post_attention_layernorm.weight,lang_model.model.layers.26.self_attn.q_proj.weight,lang_model.model.layers.26.self_attn.k_proj.weight,lang_model.model.layers.26.self_attn.v_proj.weight,lang_model.model.layers.26.self_attn.o_proj.weight,lang_model.model.layers.26.mlp.gate_proj.weight,lang_model.model.layers.26.mlp.down_proj.weight,lang_model.model.layers.26.mlp.up_proj.weight,lang_model.model.layers.26.input_layernorm.weight,lang_model.model.layers.26.post_attention_layernorm.weight,lang_model.model.layers.27.self_attn.q_proj.weight,lang_model.model.layers.27.self_attn.k_proj.weight,lang_model.model.layers.27.self_attn.v_proj.weight,lang_model.model.layers.27.self_attn.o_proj.weight,lang_model.model.layers.27.mlp.gate_proj.weight,lang_model.model.layers.27.mlp.down_proj.weight,lang_model.model.layers.27.mlp.up_proj.weight,lang_model.model.layers.27.input_layernorm.weight,lang_model.model.layers.27.post_attention_layernorm.weight,lang_model.model.layers.28.self_attn.q_proj.weight,lang_model.model.layers.28.self_attn.k_proj.weight,lang_model.model.layers.28.self_attn.v_proj.weight,lang_model.model.layers.28.self_attn.o_proj.weight,lang_model.model.layers.28.mlp.gate_proj.weight,lang_model.model.layers.28.mlp.down_proj.weight,lang_model.model.layers.28.mlp.up_proj.weight,lang_model.model.layers.28.input_layernorm.weight,lang_model.model.layers.28.post_attention_layernorm.weight,lang_model.model.layers.29.self_attn.q_proj.weight,lang_model.model.layers.29.self_attn.k_proj.weight,lang_model.model.layers.29.self_attn.v_proj.weight,lang_model.model.layers.29.self_attn.o_proj.weight,lang_model.model.layers.29.mlp.gate_proj.weight,lang_model.model.layers.29.mlp.down_proj.weight,lang_model.model.layers.29.mlp.up_proj.weight,lang_model.model.layers.29.input_layernorm.weight,lang_model.model.layers.29.post_attention_layernorm.weight,lang_model.model.layers.30.self_attn.q_proj.weight,lang_model.model.layers.30.self_attn.k_proj.weight,lang_model.model.layers.30.self_attn.v_proj.weight,lang_model.model.layers.30.self_attn.o_proj.weight,lang_model.model.layers.30.mlp.gate_proj.weight,lang_model.model.layers.30.mlp.down_proj.weight,lang_model.model.layers.30.mlp.up_proj.weight,lang_model.model.layers.30.input_layernorm.weight,lang_model.model.layers.30.post_attention_layernorm.weight,lang_model.model.layers.31.self_attn.q_proj.weight,lang_model.model.layers.31.self_attn.k_proj.weight,lang_model.model.layers.31.self_attn.v_proj.weight,lang_model.model.layers.31.self_attn.o_proj.weight,lang_model.model.layers.31.mlp.gate_proj.weight,lang_model.model.layers.31.mlp.down_proj.weight,lang_model.model.layers.31.mlp.up_proj.weight,lang_model.model.layers.31.input_layernorm.weight,lang_model.model.layers.31.post_attention_layernorm.weight,lang_model.model.norm.weight,lang_model.lm_head.weight,img_embeddings.img_linear.weight,img_embeddings.img_linear.bias,img_embeddings.img_layer_norm.weight,img_embeddings.img_layer_norm.bias,img_embeddings.loc_linear.weight,img_embeddings.loc_linear.bias,img_embeddings.loc_layer_norm.weight,img_embeddings.loc_layer_norm.bias,img_embeddings.obj_projector.0.weight,img_embeddings.obj_projector.0.bias,img_embeddings.obj_projector.1.weight,img_embeddings.obj_projector.1.bias,img_embeddings.nav_type_embedding.weight,img_embeddings.layer_norm.weight,img_embeddings.layer_norm.bias,img_embeddings.pano_encoder.layers.0.self_attn.in_proj_weight,img_embeddings.pano_encoder.layers.0.self_attn.in_proj_bias,img_embeddings.pano_encoder.layers.0.self_attn.out_proj.weight,img_embeddings.pano_encoder.layers.0.self_attn.out_proj.bias,img_embeddings.pano_encoder.layers.0.linear1.weight,img_embeddings.pano_encoder.layers.0.linear1.bias,img_embeddings.pano_encoder.layers.0.linear2.weight,img_embeddings.pano_encoder.layers.0.linear2.bias,img_embeddings.pano_encoder.layers.0.norm1.weight,img_embeddings.pano_encoder.layers.0.norm1.bias,img_embeddings.pano_encoder.layers.0.norm2.weight,img_embeddings.pano_encoder.layers.0.norm2.bias,img_embeddings.pano_encoder.layers.1.self_attn.in_proj_weight,img_embeddings.pano_encoder.layers.1.self_attn.in_proj_bias,img_embeddings.pano_encoder.layers.1.self_attn.out_proj.weight,img_embeddings.pano_encoder.layers.1.self_attn.out_proj.bias,img_embeddings.pano_encoder.layers.1.linear1.weight,img_embeddings.pano_encoder.layers.1.linear1.bias,img_embeddings.pano_encoder.layers.1.linear2.weight,img_embeddings.pano_encoder.layers.1.linear2.bias,img_embeddings.pano_encoder.layers.1.norm1.weight,img_embeddings.pano_encoder.layers.1.norm1.bias,img_embeddings.pano_encoder.layers.1.norm2.weight,img_embeddings.pano_encoder.layers.1.norm2.bias,img_embeddings.pano_encoder.norm.weight,img_embeddings.pano_encoder.norm.bias,img_embeddings.mapper.weight,img_embeddings.mapper.bias,token_type_embeddings.weight,gmap_pos_embeddings.0.weight,gmap_pos_embeddings.0.bias,gmap_pos_embeddings.1.weight,gmap_pos_embeddings.1.bias,gmap_step_embeddings.weight,vp_pos_embeddings.0.weight,vp_pos_embeddings.0.bias,vp_pos_embeddings.1.weight,vp_pos_embeddings.1.bias,obj_pos_embeddings.0.weight,obj_pos_embeddings.0.bias,obj_pos_embeddings.1.weight,obj_pos_embeddings.1.bias,og_head.0.weight,og_head.0.bias,out_head.0.weight,out_head.0.bias
2026-01-06 16:37:45,465   INFO  *************** init model *************** 
2026-01-06 16:37:48,301   INFO  Loading checkpoint from /data/wanghaoxuan/roomtour3d.pt
2026-01-06 16:37:54,268   INFO  <All keys matched successfully>
2026-01-06 16:37:54,803   INFO  model initialized with 6773.48 M trainable parameters
2026-01-06 16:37:54,804   INFO  Training with a single process
2026-01-06 16:37:54,805   INFO  **************************** Test ****************************
2026-01-06 16:37:54,807   INFO  ***** validate test split on REVERIE task *****
2026-01-06 17:38:00,211   INFO  
[Eval] test epoch 0

2026-01-06 17:40:52,390   INFO  **********************Start logging**********************
2026-01-06 17:40:52,390   INFO  CUDA_VISIBLE_DEVICES=0
2026-01-06 17:40:52,390   INFO  data_dir         /data/wanghaoxuan/data
2026-01-06 17:40:52,391   INFO  cfg_file         configs/multi.yaml
2026-01-06 17:40:52,391   INFO  pretrained_model_name_or_path /data/wanghaoxuan/data/models/Vicuna-7B
2026-01-06 17:40:52,391   INFO  off_batch_task   False
2026-01-06 17:40:52,391   INFO  debug            False
2026-01-06 17:40:52,391   INFO  few_shot         None
2026-01-06 17:40:52,391   INFO  tour3d_nav_head  False
2026-01-06 17:40:52,391   INFO  seed             0
2026-01-06 17:40:52,391   INFO  num_epochs       30
2026-01-06 17:40:52,391   INFO  resume_from_checkpoint /data/wanghaoxuan/roomtour3d.pt
2026-01-06 17:40:52,391   INFO  from_scratch     False
2026-01-06 17:40:52,391   INFO  batch_size       4
2026-01-06 17:40:52,391   INFO  val_batch_size   2
2026-01-06 17:40:52,391   INFO  lr               1e-05
2026-01-06 17:40:52,391   INFO  feat_dropout     0.4
2026-01-06 17:40:52,391   INFO  num_warmup_steps 0
2026-01-06 17:40:52,391   INFO  num_steps_per_epoch -1
2026-01-06 17:40:52,391   INFO  gradient_accumulation_step 2
2026-01-06 17:40:52,391   INFO  precision        amp_bf16
2026-01-06 17:40:52,391   INFO  workers          0
2026-01-06 17:40:52,392   INFO  gpu              0
2026-01-06 17:40:52,392   INFO  world_size       1
2026-01-06 17:40:52,392   INFO  local_rank       0
2026-01-06 17:40:52,392   INFO  dist_url         env://
2026-01-06 17:40:52,392   INFO  dist_backend     nccl
2026-01-06 17:40:52,392   INFO  horovod          False
2026-01-06 17:40:52,392   INFO  no_set_device_rank False
2026-01-06 17:40:52,392   INFO  output_dir       build/eval
2026-01-06 17:40:52,392   INFO  max_saved_checkpoints 0
2026-01-06 17:40:52,392   INFO  save_ckpt_per_epochs 10
2026-01-06 17:40:52,392   INFO  save_latest_states False
2026-01-06 17:40:52,392   INFO  save_pred_results True
2026-01-06 17:40:52,392   INFO  save_detail_results False
2026-01-06 17:40:52,392   INFO  mode             test
2026-01-06 17:40:52,392   INFO  stage            multi
2026-01-06 17:40:52,392   INFO  ignoreid         -100
2026-01-06 17:40:52,392   INFO  enable_og        True
2026-01-06 17:40:52,392   INFO  enable_summarize False
2026-01-06 17:40:52,392   INFO  enable_fgr2r     False
2026-01-06 17:40:52,392   INFO  disable_nav      False
2026-01-06 17:40:52,393   INFO  gen_loss_coef    1.0
2026-01-06 17:40:52,393   INFO  obj_loss_coef    1.0
2026-01-06 17:40:52,393   INFO  teacher_forcing_coef 1.0
2026-01-06 17:40:52,393   INFO  fuse_obj         False
2026-01-06 17:40:52,393   INFO  use_lora         False
2026-01-06 17:40:52,393   INFO  lora_rank        8
2026-01-06 17:40:52,393   INFO  lora_alpha       16
2026-01-06 17:40:52,393   INFO  lora_dropout     0.05
2026-01-06 17:40:52,393   INFO  lora_target      None
2026-01-06 17:40:52,393   INFO  freeze_llama     False
2026-01-06 17:40:52,393   INFO  tune_token_emb   False
2026-01-06 17:40:52,393   INFO  no_loc_fts       False
2026-01-06 17:40:52,393   INFO  multi_endpoints  1
2026-01-06 17:40:52,393   INFO  path_type        trusted_path
2026-01-06 17:40:52,393   INFO  test_datasets    ['SOON']
2026-01-06 17:40:52,393   INFO  validation_split test
2026-01-06 17:40:52,393   INFO  do_sample        True
2026-01-06 17:40:52,393   INFO  temperature      0.01
2026-01-06 17:40:52,393   INFO  max_datapoints   None
2026-01-06 17:40:52,394   INFO  rank             0
2026-01-06 17:40:52,394   INFO  distributed      False
2026-01-06 17:40:52,394   INFO  device           cuda:0
2026-01-06 17:40:52,394   INFO  image_feat_size  1024
2026-01-06 17:40:52,394   INFO  obj_feat_size    768
2026-01-06 17:40:52,394   INFO  angle_feat_size  4
2026-01-06 17:40:52,394   INFO  enc_full_graph   True
2026-01-06 17:40:52,394   INFO  expert_policy    spl
2026-01-06 17:40:52,394   INFO  num_pano_layers  2
2026-01-06 17:40:52,394   INFO  ----------- Feature -----------
2026-01-06 17:40:52,394   INFO  cfg.Feature.object_feature_type: 
2026-01-06 17:40:52,394   INFO  cfg.Feature.angle_feat_size: 4
2026-01-06 17:40:52,394   INFO  cfg.Feature.max_objects: 70
2026-01-06 17:40:52,394   INFO  cfg.Feature.image_feat_size: 1024
2026-01-06 17:40:52,394   INFO  ----------- feature_database -----------
2026-01-06 17:40:52,394   INFO  cfg.Feature.feature_database.mp3d: eva_features/mp3d_EVA02-CLIP-L-14-336.hdf5
2026-01-06 17:40:52,394   INFO  cfg.Feature.feature_database.scan_qa: eva_features/scanqa_EVA02-CLIP-L-14-336.hdf5
2026-01-06 17:40:52,394   INFO  cfg.Feature.feature_database.room_tour: eva_features/web_obj_prog_p1_EVA02-CLIP-L-14-336.hdf5.bak
2026-01-06 17:40:52,394   INFO  cfg.Feature.feature_database.room3d_tour: eva_features/web_3d_obj_prog_crop_p1_EVA02-CLIP-L-14-336.hdf5
2026-01-06 17:40:52,394   INFO  cfg.Feature.feature_database.coco: eva_features/coco_EVA02-CLIP-L-14-336.hdf5
2026-01-06 17:40:52,395   INFO  cfg.Feature.obj_feat_size: 768
2026-01-06 17:40:52,395   INFO  ----------- object_database -----------
2026-01-06 17:40:52,395   INFO  cfg.Feature.object_database.reverie: obj_features/reverie_obj_feat
2026-01-06 17:40:52,395   INFO  cfg.Feature.object_database.soon: obj_features/soon_obj_feat
2026-01-06 17:40:52,395   INFO  ----------- Dataset -----------
2026-01-06 17:40:52,395   INFO  ----------- R2R -----------
2026-01-06 17:40:52,395   INFO  cfg.Dataset.R2R.DIR: R2R
2026-01-06 17:40:52,395   INFO  ----------- SPLIT -----------
2026-01-06 17:40:52,395   INFO  cfg.Dataset.R2R.SPLIT.train: FGR2R_train.json
2026-01-06 17:40:52,395   INFO  cfg.Dataset.R2R.SPLIT.val_seen: R2R_val_seen_enc.json
2026-01-06 17:40:52,395   INFO  cfg.Dataset.R2R.SPLIT.val_unseen: R2R_val_unseen_enc.json
2026-01-06 17:40:52,395   INFO  cfg.Dataset.R2R.SPLIT.test: R2R_test_enc.json
2026-01-06 17:40:52,395   INFO  ----------- REVERIE -----------
2026-01-06 17:40:52,395   INFO  cfg.Dataset.REVERIE.DIR: REVERIE
2026-01-06 17:40:52,395   INFO  cfg.Dataset.REVERIE.bbox_file: BBoxes.json
2026-01-06 17:40:52,395   INFO  ----------- SPLIT -----------
2026-01-06 17:40:52,395   INFO  cfg.Dataset.REVERIE.SPLIT.train: REVERIE_train_enc.json
2026-01-06 17:40:52,395   INFO  cfg.Dataset.REVERIE.SPLIT.val_seen: REVERIE_val_seen_enc.json
2026-01-06 17:40:52,395   INFO  cfg.Dataset.REVERIE.SPLIT.val_unseen: REVERIE_val_unseen_enc.json
2026-01-06 17:40:52,396   INFO  cfg.Dataset.REVERIE.SPLIT.test: REVERIE_test_enc.json
2026-01-06 17:40:52,396   INFO  ----------- CVDN -----------
2026-01-06 17:40:52,396   INFO  cfg.Dataset.CVDN.DIR: CVDN
2026-01-06 17:40:52,396   INFO  ----------- SPLIT -----------
2026-01-06 17:40:52,396   INFO  cfg.Dataset.CVDN.SPLIT.train: train.json
2026-01-06 17:40:52,396   INFO  cfg.Dataset.CVDN.SPLIT.val_seen: val_seen.json
2026-01-06 17:40:52,396   INFO  cfg.Dataset.CVDN.SPLIT.val_unseen: val_unseen.json
2026-01-06 17:40:52,396   INFO  cfg.Dataset.CVDN.SPLIT.test: test_cleaned.json
2026-01-06 17:40:52,396   INFO  ----------- SOON -----------
2026-01-06 17:40:52,396   INFO  cfg.Dataset.SOON.DIR: SOON
2026-01-06 17:40:52,396   INFO  ----------- SPLIT -----------
2026-01-06 17:40:52,396   INFO  cfg.Dataset.SOON.SPLIT.train: train_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 17:40:52,396   INFO  cfg.Dataset.SOON.SPLIT.val_seen: val_unseen_instrs_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 17:40:52,396   INFO  cfg.Dataset.SOON.SPLIT.val_unseen: val_unseen_house_enc_pseudo_obj_ade30k_label.jsonl
2026-01-06 17:40:52,396   INFO  cfg.Dataset.SOON.SPLIT.test: test_v2_enc.jsonl
2026-01-06 17:40:52,396   INFO  ----------- ScanQA -----------
2026-01-06 17:40:52,396   INFO  cfg.Dataset.ScanQA.DIR: ScanQA
2026-01-06 17:40:52,396   INFO  ----------- SPLIT -----------
2026-01-06 17:40:52,396   INFO  cfg.Dataset.ScanQA.SPLIT.train: ScanQA_v1.0_train_reformat.json
2026-01-06 17:40:52,396   INFO  cfg.Dataset.ScanQA.SPLIT.val_unseen: ScanQA_v1.0_val_reformat.json
2026-01-06 17:40:52,397   INFO  cfg.Dataset.ScanQA.SPLIT.test_wo_obj: ScanQA_v1.0_test_wo_obj_reformat.json
2026-01-06 17:40:52,397   INFO  cfg.Dataset.ScanQA.SPLIT.test_w_obj: ScanQA_v1.0_test_w_obj_reformat.json
2026-01-06 17:40:52,397   INFO  ----------- RoomTour -----------
2026-01-06 17:40:52,397   INFO  cfg.Dataset.RoomTour.DIR: RoomTour
2026-01-06 17:40:52,397   INFO  ----------- SPLIT -----------
2026-01-06 17:40:52,397   INFO  cfg.Dataset.RoomTour.SPLIT.train: p1_train_reformat.json
2026-01-06 17:40:52,397   INFO  ----------- Tour3D -----------
2026-01-06 17:40:52,397   INFO  cfg.Dataset.Tour3D.DIR: RoomTour
2026-01-06 17:40:52,397   INFO  ----------- SPLIT -----------
2026-01-06 17:40:52,397   INFO  cfg.Dataset.Tour3D.SPLIT.train: p1_train_colmap_trajectory_tour3d.json
2026-01-06 17:40:52,397   INFO  ----------- EQA -----------
2026-01-06 17:40:52,397   INFO  cfg.Dataset.EQA.DIR: EQA_MP3D
2026-01-06 17:40:52,397   INFO  ----------- SPLIT -----------
2026-01-06 17:40:52,397   INFO  cfg.Dataset.EQA.SPLIT.val_unseen: eqa_val_enc.json
2026-01-06 17:40:52,397   INFO  cfg.Dataset.EQA.ANSWER_VOCAB: eqa_answer_vocab.json
2026-01-06 17:40:52,397   INFO  ----------- R2R_AUG -----------
2026-01-06 17:40:52,397   INFO  cfg.Dataset.R2R_AUG.DIR: R2R
2026-01-06 17:40:52,397   INFO  ----------- SPLIT -----------
2026-01-06 17:40:52,397   INFO  cfg.Dataset.R2R_AUG.SPLIT.train: R2R_prevalent_aug_train_enc.jsonl
2026-01-06 17:40:52,397   INFO  ----------- REVERIE_AUG -----------
2026-01-06 17:40:52,398   INFO  cfg.Dataset.REVERIE_AUG.DIR: REVERIE
2026-01-06 17:40:52,398   INFO  cfg.Dataset.REVERIE_AUG.bbox_file: BBoxes.json
2026-01-06 17:40:52,398   INFO  ----------- SPLIT -----------
2026-01-06 17:40:52,398   INFO  cfg.Dataset.REVERIE_AUG.SPLIT.train: REVERIE_speaker_aug_enc.jsonl
2026-01-06 17:40:52,398   INFO  ----------- LLaVA -----------
2026-01-06 17:40:52,398   INFO  cfg.Dataset.LLaVA.DIR: LLaVA
2026-01-06 17:40:52,398   INFO  ----------- SPLIT -----------
2026-01-06 17:40:52,398   INFO  cfg.Dataset.LLaVA.SPLIT.train: detail_23k.json
2026-01-06 17:40:52,398   INFO  ----------- Pretrain -----------
2026-01-06 17:40:52,398   INFO  cfg.Pretrain.SOURCE: ['Tour3D', 'RoomTour', 'ScanQA', 'LLaVA']
2026-01-06 17:40:52,398   INFO  cfg.Pretrain.Ratio: [10, 20, 5, 2]
2026-01-06 17:40:52,398   INFO  ----------- LOSS_COEF -----------
2026-01-06 17:40:52,398   INFO  cfg.Pretrain.LOSS_COEF.R2R_AUG: 1
2026-01-06 17:40:52,398   INFO  cfg.Pretrain.LOSS_COEF.REVERIE_AUG: 1
2026-01-06 17:40:52,398   INFO  ----------- Multi -----------
2026-01-06 17:40:52,398   INFO  cfg.Multi.SOURCE: ['Tour3D', 'R2R', 'REVERIE', 'CVDN', 'SOON', 'ScanQA', 'LLaVA']
2026-01-06 17:40:52,398   INFO  cfg.Multi.Ratio: [10, 20, 5, 1, 5, 5, 5]
2026-01-06 17:40:52,398   INFO  ----------- LOSS_COEF -----------
2026-01-06 17:40:52,398   INFO  ----------- Model -----------
2026-01-06 17:40:52,398   INFO  cfg.Model.num_l_layers: 9
2026-01-06 17:40:52,399   INFO  cfg.Model.num_pano_layers: 2
2026-01-06 17:40:52,399   INFO  cfg.Model.num_x_layers: 4
2026-01-06 17:40:52,399   INFO  cfg.Model.graph_sprels: True
2026-01-06 17:40:52,399   INFO  cfg.Model.fusion: dynamic
2026-01-06 17:40:52,399   INFO  cfg.Model.enc_full_graph: True
2026-01-06 17:40:52,399   INFO  cfg.Model.expert_policy: spl
2026-01-06 17:40:52,399   INFO  ----------- Optim -----------
2026-01-06 17:40:52,399   INFO  ----------- val_max_action_len -----------
2026-01-06 17:40:52,399   INFO  cfg.Optim.val_max_action_len.R2R: 15
2026-01-06 17:40:52,399   INFO  cfg.Optim.val_max_action_len.REVERIE: 15
2026-01-06 17:40:52,399   INFO  cfg.Optim.val_max_action_len.CVDN: 30
2026-01-06 17:40:52,399   INFO  cfg.Optim.val_max_action_len.SOON: 20
2026-01-06 17:40:52,399   INFO  cfg.Optim.val_max_action_len.EQA: 15
2026-01-06 17:40:52,399   INFO  ----------- train_max_action_len -----------
2026-01-06 17:40:52,399   INFO  cfg.Optim.train_max_action_len.R2R: 15
2026-01-06 17:40:52,399   INFO  cfg.Optim.train_max_action_len.Tour3D: 15
2026-01-06 17:40:52,399   INFO  cfg.Optim.train_max_action_len.REVERIE: 15
2026-01-06 17:40:52,399   INFO  cfg.Optim.train_max_action_len.CVDN: 15
2026-01-06 17:40:52,399   INFO  cfg.Optim.train_max_action_len.SOON: 15
2026-01-06 17:40:52,399   INFO  cfg.Optim.train_max_action_len.EQA: 15
2026-01-06 17:40:52,399   INFO  cfg.Optim.train_max_action_len.R2R_AUG: 15
2026-01-06 17:40:52,400   INFO  cfg.Optim.train_max_action_len.REVERIE_AUG: 15
2026-01-06 17:40:57,351   INFO  [INFO] SOONDataset loaded with 14110 instructions, using splits: test
2026-01-06 17:40:57,352   INFO  
- Dataset: load 14110 SOON samples
- Dataset: load test split: 14110 samples in total
- Dataset: load test split: 14 scans in total
2026-01-06 17:40:57,352   INFO  SOON: 14110 samples loaded
2026-01-06 17:40:57,463   INFO  Initialize the model from config.
2026-01-06 17:42:25,589   INFO  model type: torch.bfloat16
2026-01-06 17:42:25,591   INFO  Trainable params: lang_model.model.embed_tokens.weight,lang_model.model.layers.0.self_attn.q_proj.weight,lang_model.model.layers.0.self_attn.k_proj.weight,lang_model.model.layers.0.self_attn.v_proj.weight,lang_model.model.layers.0.self_attn.o_proj.weight,lang_model.model.layers.0.mlp.gate_proj.weight,lang_model.model.layers.0.mlp.down_proj.weight,lang_model.model.layers.0.mlp.up_proj.weight,lang_model.model.layers.0.input_layernorm.weight,lang_model.model.layers.0.post_attention_layernorm.weight,lang_model.model.layers.1.self_attn.q_proj.weight,lang_model.model.layers.1.self_attn.k_proj.weight,lang_model.model.layers.1.self_attn.v_proj.weight,lang_model.model.layers.1.self_attn.o_proj.weight,lang_model.model.layers.1.mlp.gate_proj.weight,lang_model.model.layers.1.mlp.down_proj.weight,lang_model.model.layers.1.mlp.up_proj.weight,lang_model.model.layers.1.input_layernorm.weight,lang_model.model.layers.1.post_attention_layernorm.weight,lang_model.model.layers.2.self_attn.q_proj.weight,lang_model.model.layers.2.self_attn.k_proj.weight,lang_model.model.layers.2.self_attn.v_proj.weight,lang_model.model.layers.2.self_attn.o_proj.weight,lang_model.model.layers.2.mlp.gate_proj.weight,lang_model.model.layers.2.mlp.down_proj.weight,lang_model.model.layers.2.mlp.up_proj.weight,lang_model.model.layers.2.input_layernorm.weight,lang_model.model.layers.2.post_attention_layernorm.weight,lang_model.model.layers.3.self_attn.q_proj.weight,lang_model.model.layers.3.self_attn.k_proj.weight,lang_model.model.layers.3.self_attn.v_proj.weight,lang_model.model.layers.3.self_attn.o_proj.weight,lang_model.model.layers.3.mlp.gate_proj.weight,lang_model.model.layers.3.mlp.down_proj.weight,lang_model.model.layers.3.mlp.up_proj.weight,lang_model.model.layers.3.input_layernorm.weight,lang_model.model.layers.3.post_attention_layernorm.weight,lang_model.model.layers.4.self_attn.q_proj.weight,lang_model.model.layers.4.self_attn.k_proj.weight,lang_model.model.layers.4.self_attn.v_proj.weight,lang_model.model.layers.4.self_attn.o_proj.weight,lang_model.model.layers.4.mlp.gate_proj.weight,lang_model.model.layers.4.mlp.down_proj.weight,lang_model.model.layers.4.mlp.up_proj.weight,lang_model.model.layers.4.input_layernorm.weight,lang_model.model.layers.4.post_attention_layernorm.weight,lang_model.model.layers.5.self_attn.q_proj.weight,lang_model.model.layers.5.self_attn.k_proj.weight,lang_model.model.layers.5.self_attn.v_proj.weight,lang_model.model.layers.5.self_attn.o_proj.weight,lang_model.model.layers.5.mlp.gate_proj.weight,lang_model.model.layers.5.mlp.down_proj.weight,lang_model.model.layers.5.mlp.up_proj.weight,lang_model.model.layers.5.input_layernorm.weight,lang_model.model.layers.5.post_attention_layernorm.weight,lang_model.model.layers.6.self_attn.q_proj.weight,lang_model.model.layers.6.self_attn.k_proj.weight,lang_model.model.layers.6.self_attn.v_proj.weight,lang_model.model.layers.6.self_attn.o_proj.weight,lang_model.model.layers.6.mlp.gate_proj.weight,lang_model.model.layers.6.mlp.down_proj.weight,lang_model.model.layers.6.mlp.up_proj.weight,lang_model.model.layers.6.input_layernorm.weight,lang_model.model.layers.6.post_attention_layernorm.weight,lang_model.model.layers.7.self_attn.q_proj.weight,lang_model.model.layers.7.self_attn.k_proj.weight,lang_model.model.layers.7.self_attn.v_proj.weight,lang_model.model.layers.7.self_attn.o_proj.weight,lang_model.model.layers.7.mlp.gate_proj.weight,lang_model.model.layers.7.mlp.down_proj.weight,lang_model.model.layers.7.mlp.up_proj.weight,lang_model.model.layers.7.input_layernorm.weight,lang_model.model.layers.7.post_attention_layernorm.weight,lang_model.model.layers.8.self_attn.q_proj.weight,lang_model.model.layers.8.self_attn.k_proj.weight,lang_model.model.layers.8.self_attn.v_proj.weight,lang_model.model.layers.8.self_attn.o_proj.weight,lang_model.model.layers.8.mlp.gate_proj.weight,lang_model.model.layers.8.mlp.down_proj.weight,lang_model.model.layers.8.mlp.up_proj.weight,lang_model.model.layers.8.input_layernorm.weight,lang_model.model.layers.8.post_attention_layernorm.weight,lang_model.model.layers.9.self_attn.q_proj.weight,lang_model.model.layers.9.self_attn.k_proj.weight,lang_model.model.layers.9.self_attn.v_proj.weight,lang_model.model.layers.9.self_attn.o_proj.weight,lang_model.model.layers.9.mlp.gate_proj.weight,lang_model.model.layers.9.mlp.down_proj.weight,lang_model.model.layers.9.mlp.up_proj.weight,lang_model.model.layers.9.input_layernorm.weight,lang_model.model.layers.9.post_attention_layernorm.weight,lang_model.model.layers.10.self_attn.q_proj.weight,lang_model.model.layers.10.self_attn.k_proj.weight,lang_model.model.layers.10.self_attn.v_proj.weight,lang_model.model.layers.10.self_attn.o_proj.weight,lang_model.model.layers.10.mlp.gate_proj.weight,lang_model.model.layers.10.mlp.down_proj.weight,lang_model.model.layers.10.mlp.up_proj.weight,lang_model.model.layers.10.input_layernorm.weight,lang_model.model.layers.10.post_attention_layernorm.weight,lang_model.model.layers.11.self_attn.q_proj.weight,lang_model.model.layers.11.self_attn.k_proj.weight,lang_model.model.layers.11.self_attn.v_proj.weight,lang_model.model.layers.11.self_attn.o_proj.weight,lang_model.model.layers.11.mlp.gate_proj.weight,lang_model.model.layers.11.mlp.down_proj.weight,lang_model.model.layers.11.mlp.up_proj.weight,lang_model.model.layers.11.input_layernorm.weight,lang_model.model.layers.11.post_attention_layernorm.weight,lang_model.model.layers.12.self_attn.q_proj.weight,lang_model.model.layers.12.self_attn.k_proj.weight,lang_model.model.layers.12.self_attn.v_proj.weight,lang_model.model.layers.12.self_attn.o_proj.weight,lang_model.model.layers.12.mlp.gate_proj.weight,lang_model.model.layers.12.mlp.down_proj.weight,lang_model.model.layers.12.mlp.up_proj.weight,lang_model.model.layers.12.input_layernorm.weight,lang_model.model.layers.12.post_attention_layernorm.weight,lang_model.model.layers.13.self_attn.q_proj.weight,lang_model.model.layers.13.self_attn.k_proj.weight,lang_model.model.layers.13.self_attn.v_proj.weight,lang_model.model.layers.13.self_attn.o_proj.weight,lang_model.model.layers.13.mlp.gate_proj.weight,lang_model.model.layers.13.mlp.down_proj.weight,lang_model.model.layers.13.mlp.up_proj.weight,lang_model.model.layers.13.input_layernorm.weight,lang_model.model.layers.13.post_attention_layernorm.weight,lang_model.model.layers.14.self_attn.q_proj.weight,lang_model.model.layers.14.self_attn.k_proj.weight,lang_model.model.layers.14.self_attn.v_proj.weight,lang_model.model.layers.14.self_attn.o_proj.weight,lang_model.model.layers.14.mlp.gate_proj.weight,lang_model.model.layers.14.mlp.down_proj.weight,lang_model.model.layers.14.mlp.up_proj.weight,lang_model.model.layers.14.input_layernorm.weight,lang_model.model.layers.14.post_attention_layernorm.weight,lang_model.model.layers.15.self_attn.q_proj.weight,lang_model.model.layers.15.self_attn.k_proj.weight,lang_model.model.layers.15.self_attn.v_proj.weight,lang_model.model.layers.15.self_attn.o_proj.weight,lang_model.model.layers.15.mlp.gate_proj.weight,lang_model.model.layers.15.mlp.down_proj.weight,lang_model.model.layers.15.mlp.up_proj.weight,lang_model.model.layers.15.input_layernorm.weight,lang_model.model.layers.15.post_attention_layernorm.weight,lang_model.model.layers.16.self_attn.q_proj.weight,lang_model.model.layers.16.self_attn.k_proj.weight,lang_model.model.layers.16.self_attn.v_proj.weight,lang_model.model.layers.16.self_attn.o_proj.weight,lang_model.model.layers.16.mlp.gate_proj.weight,lang_model.model.layers.16.mlp.down_proj.weight,lang_model.model.layers.16.mlp.up_proj.weight,lang_model.model.layers.16.input_layernorm.weight,lang_model.model.layers.16.post_attention_layernorm.weight,lang_model.model.layers.17.self_attn.q_proj.weight,lang_model.model.layers.17.self_attn.k_proj.weight,lang_model.model.layers.17.self_attn.v_proj.weight,lang_model.model.layers.17.self_attn.o_proj.weight,lang_model.model.layers.17.mlp.gate_proj.weight,lang_model.model.layers.17.mlp.down_proj.weight,lang_model.model.layers.17.mlp.up_proj.weight,lang_model.model.layers.17.input_layernorm.weight,lang_model.model.layers.17.post_attention_layernorm.weight,lang_model.model.layers.18.self_attn.q_proj.weight,lang_model.model.layers.18.self_attn.k_proj.weight,lang_model.model.layers.18.self_attn.v_proj.weight,lang_model.model.layers.18.self_attn.o_proj.weight,lang_model.model.layers.18.mlp.gate_proj.weight,lang_model.model.layers.18.mlp.down_proj.weight,lang_model.model.layers.18.mlp.up_proj.weight,lang_model.model.layers.18.input_layernorm.weight,lang_model.model.layers.18.post_attention_layernorm.weight,lang_model.model.layers.19.self_attn.q_proj.weight,lang_model.model.layers.19.self_attn.k_proj.weight,lang_model.model.layers.19.self_attn.v_proj.weight,lang_model.model.layers.19.self_attn.o_proj.weight,lang_model.model.layers.19.mlp.gate_proj.weight,lang_model.model.layers.19.mlp.down_proj.weight,lang_model.model.layers.19.mlp.up_proj.weight,lang_model.model.layers.19.input_layernorm.weight,lang_model.model.layers.19.post_attention_layernorm.weight,lang_model.model.layers.20.self_attn.q_proj.weight,lang_model.model.layers.20.self_attn.k_proj.weight,lang_model.model.layers.20.self_attn.v_proj.weight,lang_model.model.layers.20.self_attn.o_proj.weight,lang_model.model.layers.20.mlp.gate_proj.weight,lang_model.model.layers.20.mlp.down_proj.weight,lang_model.model.layers.20.mlp.up_proj.weight,lang_model.model.layers.20.input_layernorm.weight,lang_model.model.layers.20.post_attention_layernorm.weight,lang_model.model.layers.21.self_attn.q_proj.weight,lang_model.model.layers.21.self_attn.k_proj.weight,lang_model.model.layers.21.self_attn.v_proj.weight,lang_model.model.layers.21.self_attn.o_proj.weight,lang_model.model.layers.21.mlp.gate_proj.weight,lang_model.model.layers.21.mlp.down_proj.weight,lang_model.model.layers.21.mlp.up_proj.weight,lang_model.model.layers.21.input_layernorm.weight,lang_model.model.layers.21.post_attention_layernorm.weight,lang_model.model.layers.22.self_attn.q_proj.weight,lang_model.model.layers.22.self_attn.k_proj.weight,lang_model.model.layers.22.self_attn.v_proj.weight,lang_model.model.layers.22.self_attn.o_proj.weight,lang_model.model.layers.22.mlp.gate_proj.weight,lang_model.model.layers.22.mlp.down_proj.weight,lang_model.model.layers.22.mlp.up_proj.weight,lang_model.model.layers.22.input_layernorm.weight,lang_model.model.layers.22.post_attention_layernorm.weight,lang_model.model.layers.23.self_attn.q_proj.weight,lang_model.model.layers.23.self_attn.k_proj.weight,lang_model.model.layers.23.self_attn.v_proj.weight,lang_model.model.layers.23.self_attn.o_proj.weight,lang_model.model.layers.23.mlp.gate_proj.weight,lang_model.model.layers.23.mlp.down_proj.weight,lang_model.model.layers.23.mlp.up_proj.weight,lang_model.model.layers.23.input_layernorm.weight,lang_model.model.layers.23.post_attention_layernorm.weight,lang_model.model.layers.24.self_attn.q_proj.weight,lang_model.model.layers.24.self_attn.k_proj.weight,lang_model.model.layers.24.self_attn.v_proj.weight,lang_model.model.layers.24.self_attn.o_proj.weight,lang_model.model.layers.24.mlp.gate_proj.weight,lang_model.model.layers.24.mlp.down_proj.weight,lang_model.model.layers.24.mlp.up_proj.weight,lang_model.model.layers.24.input_layernorm.weight,lang_model.model.layers.24.post_attention_layernorm.weight,lang_model.model.layers.25.self_attn.q_proj.weight,lang_model.model.layers.25.self_attn.k_proj.weight,lang_model.model.layers.25.self_attn.v_proj.weight,lang_model.model.layers.25.self_attn.o_proj.weight,lang_model.model.layers.25.mlp.gate_proj.weight,lang_model.model.layers.25.mlp.down_proj.weight,lang_model.model.layers.25.mlp.up_proj.weight,lang_model.model.layers.25.input_layernorm.weight,lang_model.model.layers.25.post_attention_layernorm.weight,lang_model.model.layers.26.self_attn.q_proj.weight,lang_model.model.layers.26.self_attn.k_proj.weight,lang_model.model.layers.26.self_attn.v_proj.weight,lang_model.model.layers.26.self_attn.o_proj.weight,lang_model.model.layers.26.mlp.gate_proj.weight,lang_model.model.layers.26.mlp.down_proj.weight,lang_model.model.layers.26.mlp.up_proj.weight,lang_model.model.layers.26.input_layernorm.weight,lang_model.model.layers.26.post_attention_layernorm.weight,lang_model.model.layers.27.self_attn.q_proj.weight,lang_model.model.layers.27.self_attn.k_proj.weight,lang_model.model.layers.27.self_attn.v_proj.weight,lang_model.model.layers.27.self_attn.o_proj.weight,lang_model.model.layers.27.mlp.gate_proj.weight,lang_model.model.layers.27.mlp.down_proj.weight,lang_model.model.layers.27.mlp.up_proj.weight,lang_model.model.layers.27.input_layernorm.weight,lang_model.model.layers.27.post_attention_layernorm.weight,lang_model.model.layers.28.self_attn.q_proj.weight,lang_model.model.layers.28.self_attn.k_proj.weight,lang_model.model.layers.28.self_attn.v_proj.weight,lang_model.model.layers.28.self_attn.o_proj.weight,lang_model.model.layers.28.mlp.gate_proj.weight,lang_model.model.layers.28.mlp.down_proj.weight,lang_model.model.layers.28.mlp.up_proj.weight,lang_model.model.layers.28.input_layernorm.weight,lang_model.model.layers.28.post_attention_layernorm.weight,lang_model.model.layers.29.self_attn.q_proj.weight,lang_model.model.layers.29.self_attn.k_proj.weight,lang_model.model.layers.29.self_attn.v_proj.weight,lang_model.model.layers.29.self_attn.o_proj.weight,lang_model.model.layers.29.mlp.gate_proj.weight,lang_model.model.layers.29.mlp.down_proj.weight,lang_model.model.layers.29.mlp.up_proj.weight,lang_model.model.layers.29.input_layernorm.weight,lang_model.model.layers.29.post_attention_layernorm.weight,lang_model.model.layers.30.self_attn.q_proj.weight,lang_model.model.layers.30.self_attn.k_proj.weight,lang_model.model.layers.30.self_attn.v_proj.weight,lang_model.model.layers.30.self_attn.o_proj.weight,lang_model.model.layers.30.mlp.gate_proj.weight,lang_model.model.layers.30.mlp.down_proj.weight,lang_model.model.layers.30.mlp.up_proj.weight,lang_model.model.layers.30.input_layernorm.weight,lang_model.model.layers.30.post_attention_layernorm.weight,lang_model.model.layers.31.self_attn.q_proj.weight,lang_model.model.layers.31.self_attn.k_proj.weight,lang_model.model.layers.31.self_attn.v_proj.weight,lang_model.model.layers.31.self_attn.o_proj.weight,lang_model.model.layers.31.mlp.gate_proj.weight,lang_model.model.layers.31.mlp.down_proj.weight,lang_model.model.layers.31.mlp.up_proj.weight,lang_model.model.layers.31.input_layernorm.weight,lang_model.model.layers.31.post_attention_layernorm.weight,lang_model.model.norm.weight,lang_model.lm_head.weight,img_embeddings.img_linear.weight,img_embeddings.img_linear.bias,img_embeddings.img_layer_norm.weight,img_embeddings.img_layer_norm.bias,img_embeddings.loc_linear.weight,img_embeddings.loc_linear.bias,img_embeddings.loc_layer_norm.weight,img_embeddings.loc_layer_norm.bias,img_embeddings.obj_projector.0.weight,img_embeddings.obj_projector.0.bias,img_embeddings.obj_projector.1.weight,img_embeddings.obj_projector.1.bias,img_embeddings.nav_type_embedding.weight,img_embeddings.layer_norm.weight,img_embeddings.layer_norm.bias,img_embeddings.pano_encoder.layers.0.self_attn.in_proj_weight,img_embeddings.pano_encoder.layers.0.self_attn.in_proj_bias,img_embeddings.pano_encoder.layers.0.self_attn.out_proj.weight,img_embeddings.pano_encoder.layers.0.self_attn.out_proj.bias,img_embeddings.pano_encoder.layers.0.linear1.weight,img_embeddings.pano_encoder.layers.0.linear1.bias,img_embeddings.pano_encoder.layers.0.linear2.weight,img_embeddings.pano_encoder.layers.0.linear2.bias,img_embeddings.pano_encoder.layers.0.norm1.weight,img_embeddings.pano_encoder.layers.0.norm1.bias,img_embeddings.pano_encoder.layers.0.norm2.weight,img_embeddings.pano_encoder.layers.0.norm2.bias,img_embeddings.pano_encoder.layers.1.self_attn.in_proj_weight,img_embeddings.pano_encoder.layers.1.self_attn.in_proj_bias,img_embeddings.pano_encoder.layers.1.self_attn.out_proj.weight,img_embeddings.pano_encoder.layers.1.self_attn.out_proj.bias,img_embeddings.pano_encoder.layers.1.linear1.weight,img_embeddings.pano_encoder.layers.1.linear1.bias,img_embeddings.pano_encoder.layers.1.linear2.weight,img_embeddings.pano_encoder.layers.1.linear2.bias,img_embeddings.pano_encoder.layers.1.norm1.weight,img_embeddings.pano_encoder.layers.1.norm1.bias,img_embeddings.pano_encoder.layers.1.norm2.weight,img_embeddings.pano_encoder.layers.1.norm2.bias,img_embeddings.pano_encoder.norm.weight,img_embeddings.pano_encoder.norm.bias,img_embeddings.mapper.weight,img_embeddings.mapper.bias,token_type_embeddings.weight,gmap_pos_embeddings.0.weight,gmap_pos_embeddings.0.bias,gmap_pos_embeddings.1.weight,gmap_pos_embeddings.1.bias,gmap_step_embeddings.weight,vp_pos_embeddings.0.weight,vp_pos_embeddings.0.bias,vp_pos_embeddings.1.weight,vp_pos_embeddings.1.bias,obj_pos_embeddings.0.weight,obj_pos_embeddings.0.bias,obj_pos_embeddings.1.weight,obj_pos_embeddings.1.bias,og_head.0.weight,og_head.0.bias,out_head.0.weight,out_head.0.bias
2026-01-06 17:42:25,591   INFO  *************** init model *************** 
2026-01-06 17:42:28,632   INFO  Loading checkpoint from /data/wanghaoxuan/roomtour3d.pt
2026-01-06 17:42:34,659   INFO  <All keys matched successfully>
2026-01-06 17:42:35,202   INFO  model initialized with 6773.48 M trainable parameters
2026-01-06 17:42:35,203   INFO  Training with a single process
2026-01-06 17:42:35,203   INFO  **************************** Test ****************************
2026-01-06 17:42:35,205   INFO  ***** validate test split on SOON task *****
2026-01-06 21:50:09,359   INFO  
[Eval] test epoch 0

